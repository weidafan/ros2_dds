## $Id$
##
## (c) Copyright, Real-Time Innovations, Inc. 2001.  All rights reserved.
## No duplications, whole or partial, manual or electronic, may be made
## without prior written permission.  Any such copies, or
## revisions thereof, must display this notice unaltered.
## This code contains trade secrets of Real-Time Innovations, Inc.
##
## modification history:
## ---------------------
## 2.3,13may15,gpc Added setting of NDDSHOME if undefined in environment
## 2.2,9jun14,vmg created
##========================================================================
#[[######################################################################]]#
#[[#]]# makefile_${global.idlFileName}_${global.architectureName}
#[[#]]#
#[[#]]# (c) Copyright, Real-Time Innovations, 2012.  All rights reserved.
#[[#]]# No duplications, whole or partial, manual or electronic, may be made
#[[#]]# without express written permission.  Any such copies, or
#[[#]]# revisions thereof, must display this notice unaltered.
#[[#]]# This code contains trade secrets of Real-Time Innovations, Inc.
#[[#]]#
#[[#]]#
#[[#]]# This makefile was automatically generated by rtiddsgen.
#[[#]]#
#[[#]]# To compile, type:
#[[#]]# 	gmake -f makefile_${global.idlFileName}_${global.architectureName}
#[[#]]#
#[[#]]# Note: This makefile is only meant to build our example applications and
#[[#]]#       may require alterations to build on your system.
#[[#]]#
#[[#]]# Make sure that javac and java are in your path.
#[[######################################################################]]#

TARGET_ARCH=${global.architectureName}

#[[#]]# If undefined in the environment default NDDSHOME to install dir
ifndef NDDSHOME
NDDSHOME := ${global.nddsHome}
endif

JAVA_PATH = $javaPath
JAVAC_PATH = $javacPath

JAVA_SOURCES =#foreach($source in ${sourceFileList}) $source#end

CLASS_FILES  = #[[$]]#(JAVA_SOURCES:%.java=%.class)

RTI_CLASSPATH :=#foreach($classpath in ${javaClasspath}) $classpath#end

%.class : %.java
	#[[$]]#(JAVAC_PATH) ${compilerDebugFlag} -classpath ".${separator}#[[$]]#(RTI_CLASSPATH)" #[[$]]#<
 
#if (${archMap.COPY_DYNAMIC_LIBS})
all: #[[$]]#(CLASS_FILES) copylibs

copylibs:
	@cp #[[$]]#(NDDSHOME)/lib/#[[$]]#(TARGET_ARCH)/libnddsjava.dylib .
	@cp #[[$]]#(NDDSHOME)/lib/#[[$]]#(TARGET_ARCH)/libnddsc.dylib .
	@cp #[[$]]#(NDDSHOME)/lib/#[[$]]#(TARGET_ARCH)/libnddscore.dylib .
#else
all: #[[$]]#(CLASS_FILES)
#end

#[[#]]#
#[[#]]# Convenient way to run the java programs
#[[#]]#

export $pathVariable := #foreach($libsDir in ${libsDirs})$libsDir$separator#end#[[$]]#($pathVariable)

${exampleType}Publisher: ${exampleTypeClassPath}Publisher.class
	#[[$]]#(JAVA_PATH) ${additionalArgs} -classpath ".${separator}#[[$]]#(RTI_CLASSPATH)" ${exampleTypeClassPackage}Publisher #[[$]]#(ARGS)
 
${exampleType}Subscriber: ${exampleTypeClassPath}Subscriber.class
	#[[$]]#(JAVA_PATH) ${additionalArgs} -classpath ".${separator}#[[$]]#(RTI_CLASSPATH)" ${exampleTypeClassPackage}Subscriber #[[$]]#(ARGS)
