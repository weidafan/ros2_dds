<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>RTI Connext Traditional C++ API: Filter Use Cases</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">RTI Connext Traditional C++ API
   &#160;<span id="projectnumber">Version 5.2.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2-20120808 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__NDDSFilterExampleModule.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Filter Use Cases</div>  </div>
<div class="ingroups"><a class="el" href="group__DDSHowToModule.html">Programming How-To's</a></div></div><!--header-->
<div class="contents">

<p>Working with data filters.  
<a href="#details">More...</a></p>
<p>Working with data filters. </p>
<h1><a class="anchor" id="NDDSFilterExampleModule_intro"></a>
Introduction</h1>
<p>RTI Connext supports filtering data either during the exchange from <a class="el" href="classDDSDataWriter.html" title="&lt;&lt;interface&gt;&gt; Allows an application to set the value of the data to be published under a given DDSTop...">DDSDataWriter</a> to <a class="el" href="classDDSDataReader.html" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDSDataReader</a>, or after the data has been stored at the <a class="el" href="classDDSDataReader.html" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDSDataReader</a>.</p>
<p>Filtering during the exchange process is performed by a <a class="el" href="classDDSContentFilteredTopic.html" title="&lt;&lt;interface&gt;&gt; Specialization of DDSTopicDescription that allows for content-based subscriptions...">DDSContentFilteredTopic</a>, which is created by the <a class="el" href="classDDSDataReader.html" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDSDataReader</a> as a way of specifying a subset of the data samples that it wishes to receive.</p>
<p>Filtering samples that have already been received by the <a class="el" href="classDDSDataReader.html" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDSDataReader</a> is performed by creating a <a class="el" href="classDDSQueryCondition.html" title="&lt;&lt;interface&gt;&gt; These are specialised DDSReadCondition objects that allow the application to also speci...">DDSQueryCondition</a>, which can then used to check for matching samples, be alerted when matching samples arrive, or retrieve matching samples through use of the <a class="el" href="structFooDataReader.html#af5f7d5af52bbf7031395fb6725cebde9" title="Accesses via FooDataReader::read the samples that match the criteria specified in the DDSReadConditio...">FooDataReader::read_w_condition</a> or <a class="el" href="structFooDataReader.html#ad039152c4bc032476f5364335490d586" title="Analogous to FooDataReader::read_w_condition except it accesses samples via the FooDataReader::take o...">FooDataReader::take_w_condition</a> functions. (Conditions may also be used with the APIs <a class="el" href="structFooDataReader.html#a087aaec59491e9ab4f1f1affd4b78b2c" title="Accesses via FooDataReader::read_next_instance the samples that match the criteria specified in the D...">FooDataReader::read_next_instance_w_condition</a> and <a class="el" href="structFooDataReader.html#aac651b332f63c8561959d486bb9a36e8" title="Accesses via FooDataReader::take_next_instance the samples that match the criteria specified in the D...">FooDataReader::take_next_instance_w_condition</a>.)</p>
<p>Filtering may be performed on any topic, either keyed or un-keyed, except the <a class="el" href="group__DDSBuiltInTopicModule.html">Built-in Topics</a>. Filtering may be perfomed on any field, subset of fields, or combination of fields, subject only to the limitations of the filter syntax, and some restrictions against filtering some <em>sparse value types</em> of the <a class="el" href="group__DDSDynamicDataModule.html">Dynamic Data</a> API.</p>
<p>RTI Connext contains built in support for filtering using SQL syntax, described in the <a class="el" href="group__DDSQueryAndFilterSyntaxModule.html">Queries and Filters Syntax</a> module.</p>
<h2><a class="anchor" id="NDDSFilterExampleModule_CFT_overview"></a>
Overview of ContentFilteredTopic</h2>
<p>Each <a class="el" href="classDDSContentFilteredTopic.html" title="&lt;&lt;interface&gt;&gt; Specialization of DDSTopicDescription that allows for content-based subscriptions...">DDSContentFilteredTopic</a> is created based on an existing <a class="el" href="classDDSTopic.html" title="&lt;&lt;interface&gt;&gt; The most basic description of the data to be published and subscribed.">DDSTopic</a>. The <a class="el" href="classDDSTopic.html" title="&lt;&lt;interface&gt;&gt; The most basic description of the data to be published and subscribed.">DDSTopic</a> specifies the <b>field_names</b> and <b>field_types</b> of the data contained within the topic. The <a class="el" href="classDDSContentFilteredTopic.html" title="&lt;&lt;interface&gt;&gt; Specialization of DDSTopicDescription that allows for content-based subscriptions...">DDSContentFilteredTopic</a>, by means of its <code>filter_expression</code> and <code>expression_parameters</code>, futher specifies the <em>values</em> of the data which the <a class="el" href="classDDSDataReader.html" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDSDataReader</a> wishes to receive.</p>
<p>Custom filters may also be constructed and utilized as described in the <a class="el" href="group__NDDSCustomFilterExampleModule.html">Creating Custom Content Filters</a> module.</p>
<p>Once the <a class="el" href="classDDSContentFilteredTopic.html" title="&lt;&lt;interface&gt;&gt; Specialization of DDSTopicDescription that allows for content-based subscriptions...">DDSContentFilteredTopic</a> has been created, a <a class="el" href="classDDSDataReader.html" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDSDataReader</a> can be created using the filtered topic. The filter's characteristics are exchanged between the <a class="el" href="classDDSDataReader.html" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDSDataReader</a> and any matching <a class="el" href="classDDSDataWriter.html" title="&lt;&lt;interface&gt;&gt; Allows an application to set the value of the data to be published under a given DDSTop...">DDSDataWriter</a> during the discovery processs.</p>
<p>If the <a class="el" href="classDDSDataWriter.html" title="&lt;&lt;interface&gt;&gt; Allows an application to set the value of the data to be published under a given DDSTop...">DDSDataWriter</a> allows (by <a class="el" href="structDDS__DataWriterResourceLimitsQosPolicy.html#aa7a681cc4e445f5554947fd8fe7ea8d1" title="The maximum number of remote DataReaders for which the DDSDataWriter will perform content-based filte...">DDS_DataWriterResourceLimitsQosPolicy::max_remote_reader_filters</a>) and the number of filtered <a class="el" href="classDDSDataReader.html" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDSDataReader</a> is less than or equal to 32, and the <a class="el" href="classDDSDataReader.html" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDSDataReader</a> 's <a class="el" href="structDDS__TransportMulticastQosPolicy.html" title="Specifies the multicast address on which a DDSDataReader wants to receive its data. It can also specify a port number as well as a subset of the available (at the DDSDomainParticipant level) transports with which to receive the multicast data.">DDS_TransportMulticastQosPolicy</a> is empty, then the <a class="el" href="classDDSDataWriter.html" title="&lt;&lt;interface&gt;&gt; Allows an application to set the value of the data to be published under a given DDSTop...">DDSDataWriter</a> will performing filtering and send to the <a class="el" href="classDDSDataReader.html" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDSDataReader</a> only those samples that meet the filtering criteria.</p>
<p>If disallowed by the <a class="el" href="classDDSDataWriter.html" title="&lt;&lt;interface&gt;&gt; Allows an application to set the value of the data to be published under a given DDSTop...">DDSDataWriter</a>, or if more than 32 <a class="el" href="classDDSDataReader.html" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDSDataReader</a> require filtering, or the <a class="el" href="classDDSDataReader.html" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDSDataReader</a> has set the <a class="el" href="structDDS__TransportMulticastQosPolicy.html" title="Specifies the multicast address on which a DDSDataReader wants to receive its data. It can also specify a port number as well as a subset of the available (at the DDSDomainParticipant level) transports with which to receive the multicast data.">DDS_TransportMulticastQosPolicy</a>, then the <a class="el" href="classDDSDataWriter.html" title="&lt;&lt;interface&gt;&gt; Allows an application to set the value of the data to be published under a given DDSTop...">DDSDataWriter</a> sends all samples to the <a class="el" href="classDDSDataReader.html" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDSDataReader</a>, and the <a class="el" href="classDDSDataReader.html" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDSDataReader</a> discards any samples that do not meet the filtering criteria.</p>
<p>Although the <code>filter_expression</code> cannot be changed once the <a class="el" href="classDDSContentFilteredTopic.html" title="&lt;&lt;interface&gt;&gt; Specialization of DDSTopicDescription that allows for content-based subscriptions...">DDSContentFilteredTopic</a> has been created, the <code>expression_parameters</code> can be modified using <a class="el" href="classDDSContentFilteredTopic.html#acebb54815c4b449acd3dc5f7f6bef02b" title="Set the expression_parameters.">DDSContentFilteredTopic::set_expression_parameters</a>. Any changes made to the filtering criteria by means of <a class="el" href="classDDSContentFilteredTopic.html#acebb54815c4b449acd3dc5f7f6bef02b" title="Set the expression_parameters.">DDSContentFilteredTopic::set_expression_parameters</a>, will be conveyed to any connected <a class="el" href="classDDSDataWriter.html" title="&lt;&lt;interface&gt;&gt; Allows an application to set the value of the data to be published under a given DDSTop...">DDSDataWriter</a>. New samples will be subject to the modified filtering criteria, but samples that have already been accepted or rejected are unaffected. However, if the <a class="el" href="classDDSDataReader.html" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDSDataReader</a> connects to a <a class="el" href="classDDSDataWriter.html" title="&lt;&lt;interface&gt;&gt; Allows an application to set the value of the data to be published under a given DDSTop...">DDSDataWriter</a> that <em>re-sends</em> its data, the re-sent samples will be subjected to the new filtering criteria.</p>
<h2><a class="anchor" id="NDDSFilterExampleModule_QC_overview"></a>
Overview of QueryCondition</h2>
<p><a class="el" href="classDDSQueryCondition.html" title="&lt;&lt;interface&gt;&gt; These are specialised DDSReadCondition objects that allow the application to also speci...">DDSQueryCondition</a> combine aspects of the content filtering capabilities of <a class="el" href="classDDSContentFilteredTopic.html" title="&lt;&lt;interface&gt;&gt; Specialization of DDSTopicDescription that allows for content-based subscriptions...">DDSContentFilteredTopic</a> with state filtering capabilities of <a class="el" href="classDDSReadCondition.html" title="&lt;&lt;interface&gt;&gt; Conditions specifically dedicated to read operations and attached to one DDSDataReader...">DDSReadCondition</a> to create a reconfigurable means of filtering or searching data in the <a class="el" href="classDDSDataReader.html" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDSDataReader</a> queue.</p>
<p><a class="el" href="classDDSQueryCondition.html" title="&lt;&lt;interface&gt;&gt; These are specialised DDSReadCondition objects that allow the application to also speci...">DDSQueryCondition</a> may be created on a disabled <a class="el" href="classDDSDataReader.html" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDSDataReader</a>, or after the <a class="el" href="classDDSDataReader.html" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDSDataReader</a> has been enabled. If the <a class="el" href="classDDSDataReader.html" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDSDataReader</a> is enabled, and has already recevied and stored samples in its queue, then all data samples in the are filtered against the <a class="el" href="classDDSQueryCondition.html" title="&lt;&lt;interface&gt;&gt; These are specialised DDSReadCondition objects that allow the application to also speci...">DDSQueryCondition</a> filter criteria at the time that the <a class="el" href="classDDSQueryCondition.html" title="&lt;&lt;interface&gt;&gt; These are specialised DDSReadCondition objects that allow the application to also speci...">DDSQueryCondition</a> is created. (Note that an exclusive lock is held on the <a class="el" href="classDDSDataReader.html" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDSDataReader</a> sample queue for the duration of the <a class="el" href="classDDSQueryCondition.html" title="&lt;&lt;interface&gt;&gt; These are specialised DDSReadCondition objects that allow the application to also speci...">DDSQueryCondition</a> creation).</p>
<p>Once created, incoming samples are filtered against all <a class="el" href="classDDSQueryCondition.html" title="&lt;&lt;interface&gt;&gt; These are specialised DDSReadCondition objects that allow the application to also speci...">DDSQueryCondition</a> filter criteria at the time of their arrival and storage into the <a class="el" href="classDDSDataReader.html" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDSDataReader</a> queue.</p>
<p>The number of <a class="el" href="classDDSQueryCondition.html" title="&lt;&lt;interface&gt;&gt; These are specialised DDSReadCondition objects that allow the application to also speci...">DDSQueryCondition</a> filters that an individual <a class="el" href="classDDSDataReader.html" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDSDataReader</a> may create is set by <a class="el" href="structDDS__DataReaderResourceLimitsQosPolicy.html#abd0bbad5b44d11f09cd7c4d2a738765b" title="The maximum number of query condition filters a reader is allowed.">DDS_DataReaderResourceLimitsQosPolicy::max_query_condition_filters</a>, to an upper maximum of 32.</p>
<h1><a class="anchor" id="NDDSFilterExampleModule_content_filtered_topic"></a>
Filtering with ContentFilteredTopic</h1>
<ul>
<li><a class="el" href="group__DDSSubscriberExampleModule.html#DDSSubscriberExampleModule_subscriber_setup">Set up subscriber</a></li>
</ul>
<ul>
<li><a class="el" href="group__DDSTopicExampleModule.html#DDSTopicExampleModule_setup">Set up a topic</a></li>
</ul>
<ul>
<li>Create a ContentFilteredTopic, of user data type <code><a class="el" href="structFoo.html" title="A representative user-defined data type.">Foo</a>:</code> <div class="fragment"><div class="line"><a class="code" href="classDDSContentFilteredTopic.html" title="&lt;&lt;interface&gt;&gt; Specialization of DDSTopicDescription that allows for content-based subscriptions...">DDSContentFilteredTopic</a> *cft = NULL;</div>
<div class="line"><a class="code" href="structDDS__StringSeq.html" title="Instantiates FooSeq &lt; ::char* &gt; with value type semantics.">DDS_StringSeq</a> cft_parameters(2);</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span>* cft_param_list[] = {<span class="stringliteral">&quot;1&quot;</span>, <span class="stringliteral">&quot;100&quot;</span>};</div>
<div class="line"></div>
<div class="line">cft_parameters.from_array(cft_param_list, 2);</div>
<div class="line">cft = participant-&gt;<a class="code" href="classDDSDomainParticipant.html#a5fd57875fde174c8edc953c32fbd2073" title="Creates a DDSContentFilteredTopic, that can be used to do content-based subscriptions.">create_contentfilteredtopic</a>(<span class="stringliteral">&quot;ContentFilteredTopic&quot;</span>,</div>
<div class="line">                                               Foo_topic,</div>
<div class="line">                                               <span class="stringliteral">&quot;value &gt; %0 AND value &lt; %1&quot;</span>,</div>
<div class="line">                                               cft_parameters);</div>
<div class="line"><span class="keywordflow">if</span> (cft == NULL) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;create_contentfilteredtopic error\n&quot;</span>);</div>
<div class="line">    subscriber_shutdown(participant);</div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
</div><!-- fragment --></li>
</ul>
<ul>
<li>Create a FooReader using the ContentFilteredTopic: <div class="fragment"><div class="line"><a class="code" href="classDDSDataReader.html" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDSDataReader</a> *reader = NULL;</div>
<div class="line"></div>
<div class="line">reader = subscriber-&gt;<a class="code" href="classDDSSubscriber.html#ab31ddab06242f40d17c0aa256d18844d" title="Creates a DDSDataReader that will be attached and belong to the DDSSubscriber.">create_datareader</a>(cft,</div>
<div class="line">                                       datareader_qos, <span class="comment">// or DDS_DATAREADER_QOS_DEFAULT</span></div>
<div class="line">                                       reader_listener, <span class="comment">// or NULL</span></div>
<div class="line">                                       <a class="code" href="group__DDSStatusTypesModule.html#gaa755e98b5e8484e8be881287b4b0165c" title="All bits are set.">DDS_STATUS_MASK_ALL</a>);</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">if</span> (reader == NULL) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;create_datareader error\n&quot;</span>);</div>
<div class="line">    subscriber_shutdown(participant);</div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="structFooDataReader.html" title="&lt;&lt;interface&gt;&gt; &lt;&lt;generic&gt;&gt; User data type-specific data reader.">FooDataReader</a> *Foo_reader = <a class="code" href="structFooDataReader.html#ad3ed7d5fb2c1cfb83c49b351b5aa7ae8" title="Narrow the given DDSDataReader pointer to a FooDataReader pointer.">FooDataReader::narrow</a>(reader);</div>
<div class="line"><span class="keywordflow">if</span> (Foo_reader == NULL) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;DataReader narrow error\n&quot;</span>);</div>
<div class="line">    subscriber_shutdown(participant);</div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
</div><!-- fragment --> Once setup, reading samples with a <a class="el" href="classDDSContentFilteredTopic.html" title="&lt;&lt;interface&gt;&gt; Specialization of DDSTopicDescription that allows for content-based subscriptions...">DDSContentFilteredTopic</a> is exactly the same as normal reads or takes, as decribed in <a class="el" href="group__DDSReaderExampleModule.html">DataReader Use Cases</a>.</li>
</ul>
<ul>
<li>Changing filter crieria using set_expression_parameters: <div class="fragment"><div class="line">cft-&gt;<a class="code" href="classDDSContentFilteredTopic.html#a2544a0e845e8252641f15c5534e822bf" title="Get the expression_parameters.">get_expression_parameters</a>(cft_parameters);</div>
<div class="line"><a class="code" href="group__DDSStringClass.html#ga13074f0132f743923a4a36ee533997fe" title="Delete a string.">DDS_String_free</a>(cft_parameters[0]);</div>
<div class="line"><a class="code" href="group__DDSStringClass.html#ga13074f0132f743923a4a36ee533997fe" title="Delete a string.">DDS_String_free</a>(cft_parameters[1]);</div>
<div class="line">cft_parameters[0] = <a class="code" href="group__DDSStringClass.html#gaaadc788c3850b5625c6d78794943db7d" title="Clone a string. Creates a new string that duplicates the value of string.">DDS_String_dup</a>(<span class="stringliteral">&quot;5&quot;</span>);</div>
<div class="line">cft_arameters[1] = <a class="code" href="group__DDSStringClass.html#gaaadc788c3850b5625c6d78794943db7d" title="Clone a string. Creates a new string that duplicates the value of string.">DDS_String_dup</a>(<span class="stringliteral">&quot;9&quot;</span>);</div>
<div class="line">retcode = cft-&gt;<a class="code" href="classDDSContentFilteredTopic.html#acebb54815c4b449acd3dc5f7f6bef02b" title="Set the expression_parameters.">set_expression_parameters</a>(cft_arameters);</div>
<div class="line"><span class="keywordflow">if</span> (retcode != <a class="code" href="group__DDSReturnTypesModule.html#gga73f148aaf96b5f6f9fc630b7cfeb0c91a4f3bc70d86031a38bba356c4b534979f" title="Successful return.">DDS_RETCODE_OK</a>) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;set_expression_parameters error\n&quot;</span>);</div>
<div class="line">    subscriber_shutdown(participant);</div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
</div><!-- fragment --></li>
</ul>
<h1><a class="anchor" id="NDDSFilterExampleModule_query_conditions"></a>
Filtering with Query Conditions</h1>
<ul>
<li>Given a data reader of type <a class="el" href="structFoo.html" title="A representative user-defined data type.">Foo</a> <div class="fragment"><div class="line"><a class="code" href="classDDSDataReader.html" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDSDataReader</a> *reader = ...;</div>
<div class="line"><a class="code" href="structFooDataReader.html" title="&lt;&lt;interface&gt;&gt; &lt;&lt;generic&gt;&gt; User data type-specific data reader.">FooDataReader</a> *Foo_reader = <a class="code" href="structFooDataReader.html#ad3ed7d5fb2c1cfb83c49b351b5aa7ae8" title="Narrow the given DDSDataReader pointer to a FooDataReader pointer.">FooDataReader::narrow</a>(reader);</div>
</div><!-- fragment --></li>
</ul>
<ul>
<li>Creating a QueryCondition <div class="fragment"><div class="line"><a class="code" href="classDDSQueryCondition.html" title="&lt;&lt;interface&gt;&gt; These are specialised DDSReadCondition objects that allow the application to also speci...">DDSQueryCondition</a> *queryCondition = NULL;</div>
<div class="line"><a class="code" href="structDDS__StringSeq.html" title="Instantiates FooSeq &lt; ::char* &gt; with value type semantics.">DDS_StringSeq</a> qc_parameters(2);</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> *qc_param_list[] = {<span class="stringliteral">&quot;0&quot;</span>,<span class="stringliteral">&quot;100&quot;</span>};</div>
<div class="line"></div>
<div class="line">qc_parameters.from_array(qc_param_list,2);</div>
<div class="line">queryCondition = reader-&gt;<a class="code" href="classDDSDataReader.html#a1e612e4d2705e18fb412eeb66ec52a5a" title="Creates a DDSQueryCondition.">create_querycondition</a>(<a class="code" href="group__DDSSampleStateModule.html#ggadb6d36e7c796da27519b6bf7f8f187e5a2a3ec923ec261c0c5e50141223f20ee0" title="Sample has not been read.">DDS_NOT_READ_SAMPLE_STATE</a>,</div>
<div class="line">                                               <a class="code" href="group__DDSViewStateModule.html#ga5b8ea06fe00397fcbd7b7e1e48631bfb" title="Any view state DDS_NEW_VIEW_STATE | DDS_NOT_NEW_VIEW_STATE.">DDS_ANY_VIEW_STATE</a>,</div>
<div class="line">                                               <a class="code" href="group__DDSInstanceStateModule.html#ggaf2264cae1aa8cd66490debfdc5e0c360a093477a56893c9f6e94fb620a52e06c3" title="Instance is currently in existence.">DDS_ALIVE_INSTANCE_STATE</a>,</div>
<div class="line">                                               <span class="stringliteral">&quot;value &gt; %0 AND value &lt; %1&quot;</span>,</div>
<div class="line">                                               qc_parameters);</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">if</span> (queryCondition == NULL) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;create_query_condition error\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> error_exit;</div>
<div class="line">}</div>
</div><!-- fragment --></li>
</ul>
<ul>
<li>Reading matching samples with a <a class="el" href="classDDSQueryCondition.html" title="&lt;&lt;interface&gt;&gt; These are specialised DDSReadCondition objects that allow the application to also speci...">DDSQueryCondition</a> <div class="fragment"><div class="line"><a class="code" href="structFooSeq.html" title="&lt;&lt;interface&gt;&gt; &lt;&lt;generic&gt;&gt; A type-safe, ordered collection of elements. The type of these elements is ...">FooSeq</a> data_seq;</div>
<div class="line"><a class="code" href="structDDS__SampleInfoSeq.html" title="Declares IDL sequence &lt; DDS_SampleInfo &gt; .">DDS_SampleInfoSeq</a> info_seq;</div>
<div class="line">retcode = Foo_reader-&gt;<a class="code" href="structFooDataReader.html#af5f7d5af52bbf7031395fb6725cebde9" title="Accesses via FooDataReader::read the samples that match the criteria specified in the DDSReadConditio...">read_w_condition</a>(data_seq, info_seq,</div>
<div class="line">                                       <a class="code" href="group__DDSResourceLimitsQosModule.html#ga58912505c0b73a5f1d3677eaf9ce9e6d" title="A special value indicating an unlimited quantity.">DDS_LENGTH_UNLIMITED</a>,</div>
<div class="line">                                       queryCondition);</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">if</span> (retcode == <a class="code" href="group__DDSReturnTypesModule.html#gga73f148aaf96b5f6f9fc630b7cfeb0c91aa8e69444ae8a8efa65bde05556818669" title="Indicates a transient situation where the operation did not return any data but there is no inherent ...">DDS_RETCODE_NO_DATA</a>) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;no matching data\n&quot;</span>);</div>
<div class="line">} <span class="keywordflow">else</span> <span class="keywordflow">if</span> (retcode != <a class="code" href="group__DDSReturnTypesModule.html#gga73f148aaf96b5f6f9fc630b7cfeb0c91a4f3bc70d86031a38bba356c4b534979f" title="Successful return.">DDS_RETCODE_OK</a>) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;read_w_condition error %d\n&quot;</span>, retcode);</div>
<div class="line">    subscriber_shutdown(participant);</div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">} <span class="keywordflow">else</span> {</div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; data_seq.<a class="code" href="structFooSeq.html#a2a38c15cdd9eceab96555fc2375952a5" title="Get the logical length of this sequence.">length</a>(); ++i) {</div>
<div class="line">        <span class="keywordflow">if</span> (info_seq[i].valid_data) {</div>
<div class="line">            <span class="comment">/* process your data here */</span></div>
<div class="line">        }</div>
<div class="line">    retcode = Foo_reader-&gt;<a class="code" href="structFooDataReader.html#a9f142a4ee87d08e14a4c07325e1b13ea" title="Indicates to the DDSDataReader that the application is done accessing the collection of received_data...">return_loan</a>(data_seq, info_seq);</div>
<div class="line">    <span class="keywordflow">if</span> (retcode != <a class="code" href="group__DDSReturnTypesModule.html#gga73f148aaf96b5f6f9fc630b7cfeb0c91a4f3bc70d86031a38bba356c4b534979f" title="Successful return.">DDS_RETCODE_OK</a>) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;return loan error %d\n&quot;</span>, retcode);</div>
<div class="line">        subscriber_shutdown(participant);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --></li>
</ul>
<ul>
<li><a class="el" href="classDDSQueryCondition.html#ab95622aaeade115ed29de26960987c7e" title="Sets the query parameters.">DDSQueryCondition::set_query_parameters</a> is used similarly to <a class="el" href="classDDSContentFilteredTopic.html#acebb54815c4b449acd3dc5f7f6bef02b" title="Set the expression_parameters.">DDSContentFilteredTopic::set_expression_parameters</a>, and the same coding techniques can be used.</li>
</ul>
<ul>
<li>Any <a class="el" href="classDDSQueryCondition.html" title="&lt;&lt;interface&gt;&gt; These are specialised DDSReadCondition objects that allow the application to also speci...">DDSQueryCondition</a> that have been created must be deleted before the <a class="el" href="classDDSDataReader.html" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDSDataReader</a> can be deleted. This can be done using <a class="el" href="classDDSDataReader.html#ae075efea2fe45158e2e1e77d43547942" title="Deletes all the entities that were created by means of the &quot;create&quot; operations on the DDSDataReader...">DDSDataReader::delete_contained_entities</a> or manually as in: <div class="fragment"><div class="line">retcode = reader-&gt;<a class="code" href="classDDSDataReader.html#a1e808d4152eacac03d428aea78eb168d" title="Deletes a DDSReadCondition or DDSQueryCondition attached to the DDSDataReader.">delete_readcondition</a>(queryCondition);</div>
</div><!-- fragment --></li>
</ul>
<h1><a class="anchor" id="NDDSFilterExampleModule_performance"></a>
Filtering Performance</h1>
<p>Although RTI Connext supports filtering on any field or combination of fields using the SQL syntax of the built-in filter, filters for keyed topics that filter solely on the contents of key fields have the potential for much higher performance. This is because for key field only filters, the <a class="el" href="classDDSDataReader.html" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDSDataReader</a> caches the results of the filter (pass or not pass) for each instance. When another sample of the same instance is seen at the <a class="el" href="classDDSDataReader.html" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDSDataReader</a>, the filter results are retrieved from cache, dispensing with the need to call the filter function.</p>
<p>This optimization applies to all filtering using the built-in SQL filter, performed by the <a class="el" href="classDDSDataReader.html" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDSDataReader</a>, for either <a class="el" href="classDDSContentFilteredTopic.html" title="&lt;&lt;interface&gt;&gt; Specialization of DDSTopicDescription that allows for content-based subscriptions...">DDSContentFilteredTopic</a> or <a class="el" href="classDDSQueryCondition.html" title="&lt;&lt;interface&gt;&gt; These are specialised DDSReadCondition objects that allow the application to also speci...">DDSQueryCondition</a>. This does <em>not</em> apply to filtering perfomed for <a class="el" href="classDDSContentFilteredTopic.html" title="&lt;&lt;interface&gt;&gt; Specialization of DDSTopicDescription that allows for content-based subscriptions...">DDSContentFilteredTopic</a> by the <a class="el" href="classDDSDataWriter.html" title="&lt;&lt;interface&gt;&gt; Allows an application to set the value of the data to be published under a given DDSTop...">DDSDataWriter</a>. </p>
</div><!-- contents -->
</div><!-- doc-content -->
<HR>
<IMG SRC="rti_logo.gif" height="16">
<A HREF="main.html">RTI Connext Traditional C++ API Version 5.2.3</A>
Copyright &copy; Wed Apr 27 2016 
<A HREF="http://www.rti.com">Real-Time Innovations, Inc</A>
</BODY>
</HTML>
