<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>RTI Connext Traditional C++ API: Waitset Use Cases</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">RTI Connext Traditional C++ API
   &#160;<span id="projectnumber">Version 5.2.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2-20120808 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__DDSWaitsetExampleModule.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Waitset Use Cases</div>  </div>
<div class="ingroups"><a class="el" href="group__DDSHowToModule.html">Programming How-To's</a></div></div><!--header-->
<div class="contents">

<p>Using wait-sets and conditions.  
<a href="#details">More...</a></p>
<p>Using wait-sets and conditions. </p>
<h1><a class="anchor" id="DDSWaitsetExampleModule_setup"></a>
Setting up a wait-set</h1>
<ul>
<li>Create a wait-set <div class="fragment"><div class="line"><a class="code" href="classDDSWaitSet.html" title="&lt;&lt;interface&gt;&gt; Allows an application to wait until one or more of the attached DDSCondition objects ha...">DDSWaitSet</a>* waitset = <span class="keyword">new</span> <a class="code" href="classDDSWaitSet.html" title="&lt;&lt;interface&gt;&gt; Allows an application to wait until one or more of the attached DDSCondition objects ha...">DDSWaitSet</a>();</div>
</div><!-- fragment --></li>
</ul>
<ul>
<li>Attach conditions <div class="fragment"><div class="line"><a class="code" href="classDDSCondition.html" title="&lt;&lt;interface&gt;&gt; Root class for all the conditions that may be attached to a DDSWaitSet.">DDSCondition</a>* cond1 = ...;</div>
<div class="line"><a class="code" href="classDDSCondition.html" title="&lt;&lt;interface&gt;&gt; Root class for all the conditions that may be attached to a DDSWaitSet.">DDSCondition</a>* cond2 = entity-&gt;get_statuscondition();</div>
<div class="line"><a class="code" href="classDDSCondition.html" title="&lt;&lt;interface&gt;&gt; Root class for all the conditions that may be attached to a DDSWaitSet.">DDSCondition</a>* cond3 = reader-&gt;<a class="code" href="classDDSDataReader.html#a3932df2aec41a46f7b5ab6eccd021864" title="Creates a DDSReadCondition.">create_readcondition</a>(<a class="code" href="group__DDSSampleStateModule.html#ggadb6d36e7c796da27519b6bf7f8f187e5a2a3ec923ec261c0c5e50141223f20ee0" title="Sample has not been read.">DDS_NOT_READ_SAMPLE_STATE</a>,</div>
<div class="line">                                             <a class="code" href="group__DDSViewStateModule.html#ga5b8ea06fe00397fcbd7b7e1e48631bfb" title="Any view state DDS_NEW_VIEW_STATE | DDS_NOT_NEW_VIEW_STATE.">DDS_ANY_VIEW_STATE</a>,</div>
<div class="line">                                             <a class="code" href="group__DDSInstanceStateModule.html#gac3192dece9f811c8660bc108cb392642" title="Any instance state ALIVE_INSTANCE_STATE | NOT_ALIVE_DISPOSED_INSTANCE_STATE | NOT_ALIVE_NO_WRITERS_IN...">DDS_ANY_INSTANCE_STATE</a>);</div>
<div class="line"><a class="code" href="classDDSCondition.html" title="&lt;&lt;interface&gt;&gt; Root class for all the conditions that may be attached to a DDSWaitSet.">DDSCondition</a>* cond4 = <span class="keyword">new</span> <a class="code" href="classDDSGuardCondition.html" title="&lt;&lt;interface&gt;&gt; A specific DDSCondition whose trigger_value is completely under the control of the appl...">DDSGuardCondition</a>();</div>
<div class="line"><a class="code" href="classDDSCondition.html" title="&lt;&lt;interface&gt;&gt; Root class for all the conditions that may be attached to a DDSWaitSet.">DDSCondition</a>* cond5 = ...;</div>
<div class="line"><a class="code" href="group__DDSReturnTypesModule.html#ga73f148aaf96b5f6f9fc630b7cfeb0c91" title="Type for return codes.">DDS_ReturnCode_t</a> retcode;</div>
<div class="line"></div>
<div class="line">retcode = waitset-&gt;<a class="code" href="classDDSWaitSet.html#a781eb572176daae45a7bdca2d26f07d4" title="Attaches a DDSCondition to the DDSWaitSet.">attach_condition</a>(cond1);</div>
<div class="line"><span class="keywordflow">if</span> (retcode != <a class="code" href="group__DDSReturnTypesModule.html#gga73f148aaf96b5f6f9fc630b7cfeb0c91a4f3bc70d86031a38bba356c4b534979f" title="Successful return.">DDS_RETCODE_OK</a>) {</div>
<div class="line">    <span class="comment">// ... error</span></div>
<div class="line">}</div>
<div class="line">retcode = waitset-&gt;<a class="code" href="classDDSWaitSet.html#a781eb572176daae45a7bdca2d26f07d4" title="Attaches a DDSCondition to the DDSWaitSet.">attach_condition</a>(cond2);</div>
<div class="line"><span class="keywordflow">if</span> (retcode != <a class="code" href="group__DDSReturnTypesModule.html#gga73f148aaf96b5f6f9fc630b7cfeb0c91a4f3bc70d86031a38bba356c4b534979f" title="Successful return.">DDS_RETCODE_OK</a>) {</div>
<div class="line">    <span class="comment">// ... error</span></div>
<div class="line">}</div>
<div class="line">retcode = waitset-&gt;<a class="code" href="classDDSWaitSet.html#a781eb572176daae45a7bdca2d26f07d4" title="Attaches a DDSCondition to the DDSWaitSet.">attach_condition</a>(cond3);</div>
<div class="line"><span class="keywordflow">if</span> (retcode != <a class="code" href="group__DDSReturnTypesModule.html#gga73f148aaf96b5f6f9fc630b7cfeb0c91a4f3bc70d86031a38bba356c4b534979f" title="Successful return.">DDS_RETCODE_OK</a>) {</div>
<div class="line">    <span class="comment">// ... error</span></div>
<div class="line">}</div>
<div class="line">retcode = waitset-&gt;<a class="code" href="classDDSWaitSet.html#a781eb572176daae45a7bdca2d26f07d4" title="Attaches a DDSCondition to the DDSWaitSet.">attach_condition</a>(cond4);</div>
<div class="line"><span class="keywordflow">if</span> (retcode != <a class="code" href="group__DDSReturnTypesModule.html#gga73f148aaf96b5f6f9fc630b7cfeb0c91a4f3bc70d86031a38bba356c4b534979f" title="Successful return.">DDS_RETCODE_OK</a>) {</div>
<div class="line">    <span class="comment">// ... error</span></div>
<div class="line">}</div>
<div class="line">retcode = waitset-&gt;<a class="code" href="classDDSWaitSet.html#a781eb572176daae45a7bdca2d26f07d4" title="Attaches a DDSCondition to the DDSWaitSet.">attach_condition</a>(cond5);</div>
<div class="line"><span class="keywordflow">if</span> (retcode != <a class="code" href="group__DDSReturnTypesModule.html#gga73f148aaf96b5f6f9fc630b7cfeb0c91a4f3bc70d86031a38bba356c4b534979f" title="Successful return.">DDS_RETCODE_OK</a>) {</div>
<div class="line">    <span class="comment">// ... error</span></div>
<div class="line">}</div>
</div><!-- fragment --></li>
</ul>
<h1><a class="anchor" id="DDSWaitsetExampleModule_trigger"></a>
Waiting for condition(s) to trigger</h1>
<ul>
<li><a class="el" href="group__DDSWaitsetExampleModule.html#DDSWaitsetExampleModule_setup">Set up a wait-set</a></li>
</ul>
<ul>
<li>Wait for a condition to trigger or <code>timeout</code>, whichever occurs first <div class="fragment"><div class="line"><a class="code" href="structDDS__Duration__t.html" title="Type for duration representation.">DDS_Duration_t</a> timeout = { 0, 1000000 }; <span class="comment">// 1ms</span></div>
<div class="line"></div>
<div class="line"><a class="code" href="structDDSConditionSeq.html" title="Instantiates FooSeq &lt; DDSCondition &gt;">DDSConditionSeq</a> active_conditions; <span class="comment">// holder for active conditions</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> is_cond1_triggered = <span class="keyword">false</span>;</div>
<div class="line"><span class="keywordtype">bool</span> is_cond2_triggered = <span class="keyword">false</span>;</div>
<div class="line"></div>
<div class="line"><a class="code" href="group__DDSReturnTypesModule.html#ga73f148aaf96b5f6f9fc630b7cfeb0c91" title="Type for return codes.">DDS_ReturnCode_t</a> retcode;</div>
<div class="line"></div>
<div class="line">retcode = waitset-&gt;<a class="code" href="classDDSWaitSet.html#acf4f30344c6341439d8f498c00313d97" title="Allows an application thread to wait for the occurrence of certain conditions.">wait</a>(active_conditions, timeout);</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">if</span> (retcode != <a class="code" href="group__DDSReturnTypesModule.html#gga73f148aaf96b5f6f9fc630b7cfeb0c91a4f3bc70d86031a38bba356c4b534979f" title="Successful return.">DDS_RETCODE_OK</a>) {</div>
<div class="line">    <span class="keywordflow">if</span> (retcode == <a class="code" href="group__DDSReturnTypesModule.html#gga73f148aaf96b5f6f9fc630b7cfeb0c91a9e9b16cc5337664c6c6bbd4a9ed01bcb" title="The operation timed out.">DDS_RETCODE_TIMEOUT</a>) {</div>
<div class="line">        <span class="comment">// Timeout</span></div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="comment">// Failure</span></div>
<div class="line">} <span class="keywordflow">else</span> {</div>
<div class="line">    <span class="comment">// success, check if &quot;cond1&quot; or &quot;cond2&quot; are triggered:</span></div>
<div class="line">        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; active_conditions.length(); ++i) {</div>
<div class="line"></div>
<div class="line">           <span class="keywordflow">if</span> (active_conditions[i] == cond1) {</div>
<div class="line">              printf(<span class="stringliteral">&quot;Cond1 was triggered!&quot;</span>);</div>
<div class="line">              is_cond1_triggered = <span class="keyword">true</span>;              </div>
<div class="line">           }</div>
<div class="line"></div>
<div class="line">           <span class="keywordflow">if</span> (active_conditions[i] == cond2) {</div>
<div class="line">              printf(<span class="stringliteral">&quot;Cond2 was triggered!&quot;</span>);</div>
<div class="line">              is_cond2_triggered = <span class="keyword">true</span>;              </div>
<div class="line">           }</div>
<div class="line"></div>
<div class="line">           <span class="keywordflow">if</span> (is_cond1_triggered &amp;&amp; is_cond2_triggered) {</div>
<div class="line">              <span class="keywordflow">break</span>;</div>
<div class="line">           }   </div>
<div class="line">       }   </div>
<div class="line">}  </div>
<div class="line"></div>
<div class="line"><span class="keywordflow">if</span> (is_cond1_triggered) {</div>
<div class="line">    <span class="comment">// ... do something because &quot;cond1&quot; was triggered ...</span></div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">if</span> (is_cond2_triggered) {</div>
<div class="line">    <span class="comment">// ... do something because &quot;cond2&quot; was triggered ...</span></div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">return</span> retcode;</div>
</div><!-- fragment --></li>
</ul>
<h1><a class="anchor" id="DDSWaitsetExampleModule_teardown"></a>
Tearing down a wait-set</h1>
<ul>
<li>Delete the wait-set <div class="fragment"><div class="line"><span class="keyword">delete</span> waitset;</div>
<div class="line">waitset = NULL;</div>
</div><!-- fragment --> </li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<HR>
<IMG SRC="rti_logo.gif" height="16">
<A HREF="main.html">RTI Connext Traditional C++ API Version 5.2.3</A>
Copyright &copy; Wed Apr 27 2016 
<A HREF="http://www.rti.com">Real-Time Innovations, Inc</A>
</BODY>
</HTML>
