<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>RTI Connext C API: Waitset Use Cases</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">RTI Connext C API
   &#160;<span id="projectnumber">Version 5.2.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2-20120808 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__DDSWaitsetExampleModule.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Waitset Use Cases</div>  </div>
<div class="ingroups"><a class="el" href="group__DDSHowToModule.html">Programming How-To's</a></div></div><!--header-->
<div class="contents">

<p>Using wait-sets and conditions.  
<a href="#details">More...</a></p>
<p>Using wait-sets and conditions. </p>
<h1><a class="anchor" id="DDSWaitsetExampleModule_setup"></a>
Setting up a wait-set</h1>
<ul>
<li>Create a wait-set <div class="fragment"><div class="line"><a class="code" href="group__DDSConditionsModule.html#gaffdc85b9ca97eb432a2c17c52bc00f82" title="&lt;&lt;interface&gt;&gt; Allows an application to wait until one or more of the attached DDS_Condition objects h...">DDS_WaitSet</a>* waitset = <a class="code" href="group__DDSConditionsModule.html#gad2beb9390be39c5360b94ac106f20efd" title="Default no-argument constructor.">DDS_WaitSet_new</a>();</div>
</div><!-- fragment --></li>
</ul>
<ul>
<li>Attach conditions <div class="fragment"><div class="line"><a class="code" href="group__DDSConditionsModule.html#ga1c45ab3d5584bb3332e98266dc3f7d3d" title="&lt;&lt;interface&gt;&gt; Root class for all the conditions that may be attached to a DDS_WaitSet.">DDS_Condition</a>* cond1 = ...;</div>
<div class="line"><a class="code" href="group__DDSConditionsModule.html#ga1c45ab3d5584bb3332e98266dc3f7d3d" title="&lt;&lt;interface&gt;&gt; Root class for all the conditions that may be attached to a DDS_WaitSet.">DDS_Condition</a>* cond2 = <a class="code" href="group__DDSConditionsModule.html#ga719d9f240ff21dc8abb2626b8495beba" title="Access a DDS_StatusCondition&#39;s supertype instance.">DDS_StatusCondition_as_condition</a>(</div>
<div class="line">                        <a class="code" href="group__DDSEntityModule.html#ga6b87d4852f75de23efabe17207d42bfd" title="Allows access to the DDS_StatusCondition associated with the DDS_Entity.">DDS_Entity_get_statuscondition</a>(entity));</div>
<div class="line"><a class="code" href="group__DDSConditionsModule.html#ga1c45ab3d5584bb3332e98266dc3f7d3d" title="&lt;&lt;interface&gt;&gt; Root class for all the conditions that may be attached to a DDS_WaitSet.">DDS_Condition</a>* cond3 = <a class="code" href="group__DDSReadConditionModule.html#gaea2e4461bc6d20134b429a8f18d8fa54" title="Accesses a DDS_ReadCondition&#39;s supertype instance.">DDS_ReadCondition_as_condition</a>(</div>
<div class="line">                        <a class="code" href="group__DDSReaderModule.html#gab6e48531c43261208a355211da9395e0" title="Creates a DDS_ReadCondition.">DDS_DataReader_create_readcondition</a>(</div>
<div class="line">                                reader, </div>
<div class="line">                                                 <a class="code" href="group__DDSSampleStateModule.html#ggadb6d36e7c796da27519b6bf7f8f187e5a2a3ec923ec261c0c5e50141223f20ee0" title="Sample has not been read.">DDS_NOT_READ_SAMPLE_STATE</a>,</div>
<div class="line">                                <a class="code" href="group__DDSViewStateModule.html#ga5b8ea06fe00397fcbd7b7e1e48631bfb" title="Any view state DDS_NEW_VIEW_STATE | DDS_NOT_NEW_VIEW_STATE.">DDS_ANY_VIEW_STATE</a>,</div>
<div class="line">                                <a class="code" href="group__DDSInstanceStateModule.html#gac3192dece9f811c8660bc108cb392642" title="Any instance state ALIVE_INSTANCE_STATE | NOT_ALIVE_DISPOSED_INSTANCE_STATE | NOT_ALIVE_NO_WRITERS_IN...">DDS_ANY_INSTANCE_STATE</a>));</div>
<div class="line"><a class="code" href="group__DDSConditionsModule.html#ga1c45ab3d5584bb3332e98266dc3f7d3d" title="&lt;&lt;interface&gt;&gt; Root class for all the conditions that may be attached to a DDS_WaitSet.">DDS_Condition</a>* cond4 = <a class="code" href="group__DDSConditionsModule.html#ga7fb0711ce2966803e0e162021a59fb77" title="Access a DDS_GuardCondition&#39;s supertype instance.">DDS_GuardCondition_as_condition</a>(</div>
<div class="line">                        <a class="code" href="group__DDSConditionsModule.html#ga67cc59d61074a591aa6396c67999fa87" title="No argument constructor.">DDS_GuardCondition_new</a>());</div>
<div class="line"><a class="code" href="group__DDSConditionsModule.html#ga1c45ab3d5584bb3332e98266dc3f7d3d" title="&lt;&lt;interface&gt;&gt; Root class for all the conditions that may be attached to a DDS_WaitSet.">DDS_Condition</a>* cond5 = ...;                                                </div>
<div class="line"><a class="code" href="group__DDSReturnTypesModule.html#ga73f148aaf96b5f6f9fc630b7cfeb0c91" title="Type for return codes.">DDS_ReturnCode_t</a> retcode;</div>
<div class="line"></div>
<div class="line">retcode = <a class="code" href="group__DDSConditionsModule.html#ga8b0227e23a0d795cbaf0aee9d20ce0d0" title="Attaches a DDS_Condition to the DDS_WaitSet.">DDS_WaitSet_attach_condition</a>(waitset, cond1);</div>
<div class="line"><span class="keywordflow">if</span> (retcode != <a class="code" href="group__DDSReturnTypesModule.html#gga73f148aaf96b5f6f9fc630b7cfeb0c91a4f3bc70d86031a38bba356c4b534979f" title="Successful return.">DDS_RETCODE_OK</a>) {</div>
<div class="line">    <span class="comment">/* ... error */</span></div>
<div class="line">}</div>
<div class="line">retcode = <a class="code" href="group__DDSConditionsModule.html#ga8b0227e23a0d795cbaf0aee9d20ce0d0" title="Attaches a DDS_Condition to the DDS_WaitSet.">DDS_WaitSet_attach_condition</a>(waitset, cond2);</div>
<div class="line"><span class="keywordflow">if</span> (retcode != <a class="code" href="group__DDSReturnTypesModule.html#gga73f148aaf96b5f6f9fc630b7cfeb0c91a4f3bc70d86031a38bba356c4b534979f" title="Successful return.">DDS_RETCODE_OK</a>) {</div>
<div class="line">    <span class="comment">/* ... error */</span></div>
<div class="line">}</div>
<div class="line">retcode = <a class="code" href="group__DDSConditionsModule.html#ga8b0227e23a0d795cbaf0aee9d20ce0d0" title="Attaches a DDS_Condition to the DDS_WaitSet.">DDS_WaitSet_attach_condition</a>(waitset, cond3);</div>
<div class="line"><span class="keywordflow">if</span> (retcode != <a class="code" href="group__DDSReturnTypesModule.html#gga73f148aaf96b5f6f9fc630b7cfeb0c91a4f3bc70d86031a38bba356c4b534979f" title="Successful return.">DDS_RETCODE_OK</a>) {</div>
<div class="line">    <span class="comment">/* ... error */</span></div>
<div class="line">}</div>
<div class="line">retcode = <a class="code" href="group__DDSConditionsModule.html#ga8b0227e23a0d795cbaf0aee9d20ce0d0" title="Attaches a DDS_Condition to the DDS_WaitSet.">DDS_WaitSet_attach_condition</a>(waitset, cond4);</div>
<div class="line"><span class="keywordflow">if</span> (retcode != <a class="code" href="group__DDSReturnTypesModule.html#gga73f148aaf96b5f6f9fc630b7cfeb0c91a4f3bc70d86031a38bba356c4b534979f" title="Successful return.">DDS_RETCODE_OK</a>) {</div>
<div class="line">    <span class="comment">/* ... error */</span></div>
<div class="line">}</div>
<div class="line">retcode = <a class="code" href="group__DDSConditionsModule.html#ga8b0227e23a0d795cbaf0aee9d20ce0d0" title="Attaches a DDS_Condition to the DDS_WaitSet.">DDS_WaitSet_attach_condition</a>(waitset, cond5);</div>
<div class="line"><span class="keywordflow">if</span> (retcode != <a class="code" href="group__DDSReturnTypesModule.html#gga73f148aaf96b5f6f9fc630b7cfeb0c91a4f3bc70d86031a38bba356c4b534979f" title="Successful return.">DDS_RETCODE_OK</a>) {</div>
<div class="line">    <span class="comment">/* ... error */</span></div>
<div class="line">}</div>
</div><!-- fragment --></li>
</ul>
<h1><a class="anchor" id="DDSWaitsetExampleModule_trigger"></a>
Waiting for condition(s) to trigger</h1>
<ul>
<li><a class="el" href="group__DDSWaitsetExampleModule.html#DDSWaitsetExampleModule_setup">Set up a wait-set</a></li>
</ul>
<ul>
<li>Wait for a condition to trigger or <code>timeout</code>, whichever occurs first <div class="fragment"><div class="line"><span class="preprocessor">#define TRUE 1</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define FALSE 0</span></div>
<div class="line"><span class="preprocessor"></span><span class="keyword">struct </span><a class="code" href="structDDS__Duration__t.html" title="Type for duration representation.">DDS_Duration_t</a> timeout = { 0, 1000000 }; <span class="comment">/* 1ms */</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">struct </span><a class="code" href="structDDS__ConditionSeq.html" title="Instantiates FooSeq &lt; DDS_Condition &gt;">DDS_ConditionSeq</a> active_conditions = <a class="code" href="group__DDSSequenceModule.html#ga521eb819a3b85277debce55d61b08f82" title="An initializer for new sequence instances.">DDS_SEQUENCE_INITIALIZER</a>; <span class="comment">/* holder for active conditions */</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> is_cond1_triggered = FALSE;</div>
<div class="line"><span class="keywordtype">int</span> is_cond2_triggered = FALSE;</div>
<div class="line"><span class="keywordtype">int</span> i;</div>
<div class="line"></div>
<div class="line"><a class="code" href="group__DDSReturnTypesModule.html#ga73f148aaf96b5f6f9fc630b7cfeb0c91" title="Type for return codes.">DDS_ReturnCode_t</a> retcode;</div>
<div class="line"></div>
<div class="line">retcode = <a class="code" href="group__DDSConditionsModule.html#ga42860967e1dc1c5c7ee3ffd03d7eb54e" title="Allows an application thread to wait for the occurrence of certain conditions.">DDS_WaitSet_wait</a>(waitset, &amp;active_conditions, &amp;timeout);</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">if</span> (retcode != <a class="code" href="group__DDSReturnTypesModule.html#gga73f148aaf96b5f6f9fc630b7cfeb0c91a4f3bc70d86031a38bba356c4b534979f" title="Successful return.">DDS_RETCODE_OK</a>) {</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* ... check for cause of failure */</span></div>
<div class="line"></div>
<div class="line">} <span class="keywordflow">else</span> {</div>
<div class="line">   <span class="comment">/* success */</span></div>
<div class="line"></div>
<div class="line">   <span class="keywordflow">if</span> (DDS_ConditionSeq_get_length(&amp;active_conditions) == 0) {</div>
<div class="line">      <span class="comment">/* timeout! */</span></div>
<div class="line">      printf(<span class="stringliteral">&quot;Wait timed out!! None of the conditions was triggered.\n&quot;</span>);</div>
<div class="line"></div>
<div class="line">   } <span class="keywordflow">else</span> {</div>
<div class="line">      <span class="comment">/* check if &quot;cond1&quot; or &quot;cond2&quot; are triggered: */</span></div>
<div class="line">      <span class="keywordflow">for</span>(i = 0; i &lt; DDS_ConditionSeq_get_length(&amp;active_conditions); ++i) {</div>
<div class="line"></div>
<div class="line">         <span class="keywordflow">if</span> (DDS_ConditionSeq_get(&amp;active_conditions, i) == cond1) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;Cond1 was triggered!&quot;</span>);</div>
<div class="line">            is_cond1_triggered = TRUE;        </div>
<div class="line">         }</div>
<div class="line"></div>
<div class="line">         <span class="keywordflow">if</span> (DDS_ConditionSeq_get(&amp;active_conditions, i) == cond2) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;Cond2 was triggered!&quot;</span>);</div>
<div class="line">            is_cond2_triggered = TRUE;        </div>
<div class="line">         }</div>
<div class="line"></div>
<div class="line">         <span class="keywordflow">if</span> (is_cond1_triggered &amp;&amp; is_cond2_triggered) {</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">         }   </div>
<div class="line">      }   </div>
<div class="line">   }</div>
<div class="line">}  </div>
<div class="line"></div>
<div class="line"><span class="keywordflow">if</span> (is_cond1_triggered) {</div>
<div class="line">   <span class="comment">/* ... do something because &quot;cond1&quot; was triggered ... */</span></div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">if</span> (is_cond2_triggered) {</div>
<div class="line">   <span class="comment">/* ... do something because &quot;cond2&quot; was triggered ... */</span></div>
<div class="line">}</div>
</div><!-- fragment --></li>
</ul>
<h1><a class="anchor" id="DDSWaitsetExampleModule_teradown"></a>
Tearing down a wait-set</h1>
<ul>
<li>Delete the wait-set <div class="fragment"><div class="line"><a class="code" href="group__DDSConditionsModule.html#ga3e6d5bcfc06936eecb589749391383f3" title="Destructor.">DDS_WaitSet_delete</a>(waitset);</div>
<div class="line">waitset = NULL;</div>
</div><!-- fragment --> </li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<HR>
<IMG SRC="rti_logo.gif" height="16">
<A HREF="main.html">RTI Connext C API Version 5.2.3</A>
Copyright &copy; Wed Apr 27 2016 
<A HREF="http://www.rti.com">Real-Time Innovations, Inc</A>
</BODY>
</HTML>
