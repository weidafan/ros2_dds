<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>RTI Connext C API: Filter Use Cases</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">RTI Connext C API
   &#160;<span id="projectnumber">Version 5.2.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2-20120808 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__NDDSFilterExampleModule.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Filter Use Cases</div>  </div>
<div class="ingroups"><a class="el" href="group__DDSHowToModule.html">Programming How-To's</a></div></div><!--header-->
<div class="contents">

<p>Working with data filters.  
<a href="#details">More...</a></p>
<p>Working with data filters. </p>
<h1><a class="anchor" id="NDDSFilterExampleModule_intro"></a>
Introduction</h1>
<p>RTI Connext supports filtering data either during the exchange from <a class="el" href="group__DDSWriterModule.html#gafb74fa54675abe1bfb2090265bf4d116" title="&lt;&lt;interface&gt;&gt; Allows an application to set the value of the data to be published under a given DDS_To...">DDS_DataWriter</a> to <a class="el" href="group__DDSReaderModule.html#ga49ce0cab2c1b60ddee4784a1432577a4" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDS_DataReader</a>, or after the data has been stored at the <a class="el" href="group__DDSReaderModule.html#ga49ce0cab2c1b60ddee4784a1432577a4" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDS_DataReader</a>.</p>
<p>Filtering during the exchange process is performed by a <a class="el" href="group__DDSTopicEntityModule.html#ga84a9ecf9064ecc6b3fb4d8dcc5bda0a6" title="&lt;&lt;interface&gt;&gt; Specialization of DDS_TopicDescription that allows for content-based subscriptions...">DDS_ContentFilteredTopic</a>, which is created by the <a class="el" href="group__DDSReaderModule.html#ga49ce0cab2c1b60ddee4784a1432577a4" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDS_DataReader</a> as a way of specifying a subset of the data samples that it wishes to receive.</p>
<p>Filtering samples that have already been received by the <a class="el" href="group__DDSReaderModule.html#ga49ce0cab2c1b60ddee4784a1432577a4" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDS_DataReader</a> is performed by creating a <a class="el" href="group__DDSQueryConditionModule.html#ga51ec811e0c2d583015ac7d5a4cd4d843" title="&lt;&lt;interface&gt;&gt; These are specialised DDS_ReadCondition objects that allow the application to also spec...">DDS_QueryCondition</a>, which can then used to check for matching samples, be alerted when matching samples arrive, or retrieve matching samples through use of the <a class="el" href="group__DDSReaderModule.html#gab3aa397b246f0c8e5b62940597dfa280" title="Accesses via FooDataReader_read the samples that match the criteria specified in the DDS_ReadConditio...">FooDataReader_read_w_condition</a> or <a class="el" href="group__DDSReaderModule.html#ga5340c4c0e6b32c31d36688636c064657" title="Analogous to FooDataReader_read_w_condition except it accesses samples via the FooDataReader_take ope...">FooDataReader_take_w_condition</a> functions. (Conditions may also be used with the APIs <a class="el" href="group__DDSReaderModule.html#ga55910a020e513e170ec432db8eda4899" title="Accesses via FooDataReader_read_next_instance the samples that match the criteria specified in the DD...">FooDataReader_read_next_instance_w_condition</a> and <a class="el" href="group__DDSReaderModule.html#gab7d499fba202bd3613c705d53c034a1c" title="Accesses via FooDataReader_take_next_instance the samples that match the criteria specified in the DD...">FooDataReader_take_next_instance_w_condition</a>.)</p>
<p>Filtering may be performed on any topic, either keyed or un-keyed, except the <a class="el" href="group__DDSBuiltInTopicModule.html">Built-in Topics</a>. Filtering may be perfomed on any field, subset of fields, or combination of fields, subject only to the limitations of the filter syntax, and some restrictions against filtering some <em>sparse value types</em> of the <a class="el" href="group__DDSDynamicDataModule.html">Dynamic Data</a> API.</p>
<p>RTI Connext contains built in support for filtering using SQL syntax, described in the <a class="el" href="group__DDSQueryAndFilterSyntaxModule.html">Queries and Filters Syntax</a> module.</p>
<h2><a class="anchor" id="NDDSFilterExampleModule_CFT_overview"></a>
Overview of ContentFilteredTopic</h2>
<p>Each <a class="el" href="group__DDSTopicEntityModule.html#ga84a9ecf9064ecc6b3fb4d8dcc5bda0a6" title="&lt;&lt;interface&gt;&gt; Specialization of DDS_TopicDescription that allows for content-based subscriptions...">DDS_ContentFilteredTopic</a> is created based on an existing <a class="el" href="group__DDSTopicEntityModule.html#ga7f615cc63381c78f535904e370cf1356" title="&lt;&lt;interface&gt;&gt; The most basic description of the data to be published and subscribed.">DDS_Topic</a>. The <a class="el" href="group__DDSTopicEntityModule.html#ga7f615cc63381c78f535904e370cf1356" title="&lt;&lt;interface&gt;&gt; The most basic description of the data to be published and subscribed.">DDS_Topic</a> specifies the <b>field_names</b> and <b>field_types</b> of the data contained within the topic. The <a class="el" href="group__DDSTopicEntityModule.html#ga84a9ecf9064ecc6b3fb4d8dcc5bda0a6" title="&lt;&lt;interface&gt;&gt; Specialization of DDS_TopicDescription that allows for content-based subscriptions...">DDS_ContentFilteredTopic</a>, by means of its <code>filter_expression</code> and <code>expression_parameters</code>, futher specifies the <em>values</em> of the data which the <a class="el" href="group__DDSReaderModule.html#ga49ce0cab2c1b60ddee4784a1432577a4" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDS_DataReader</a> wishes to receive.</p>
<p>Custom filters may also be constructed and utilized as described in the <a class="el" href="group__NDDSCustomFilterExampleModule.html">Creating Custom Content Filters</a> module.</p>
<p>Once the <a class="el" href="group__DDSTopicEntityModule.html#ga84a9ecf9064ecc6b3fb4d8dcc5bda0a6" title="&lt;&lt;interface&gt;&gt; Specialization of DDS_TopicDescription that allows for content-based subscriptions...">DDS_ContentFilteredTopic</a> has been created, a <a class="el" href="group__DDSReaderModule.html#ga49ce0cab2c1b60ddee4784a1432577a4" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDS_DataReader</a> can be created using the filtered topic. The filter's characteristics are exchanged between the <a class="el" href="group__DDSReaderModule.html#ga49ce0cab2c1b60ddee4784a1432577a4" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDS_DataReader</a> and any matching <a class="el" href="group__DDSWriterModule.html#gafb74fa54675abe1bfb2090265bf4d116" title="&lt;&lt;interface&gt;&gt; Allows an application to set the value of the data to be published under a given DDS_To...">DDS_DataWriter</a> during the discovery processs.</p>
<p>If the <a class="el" href="group__DDSWriterModule.html#gafb74fa54675abe1bfb2090265bf4d116" title="&lt;&lt;interface&gt;&gt; Allows an application to set the value of the data to be published under a given DDS_To...">DDS_DataWriter</a> allows (by <a class="el" href="structDDS__DataWriterResourceLimitsQosPolicy.html#aa7a681cc4e445f5554947fd8fe7ea8d1" title="The maximum number of remote DataReaders for which the DDS_DataWriter will perform content-based filt...">DDS_DataWriterResourceLimitsQosPolicy::max_remote_reader_filters</a>) and the number of filtered <a class="el" href="group__DDSReaderModule.html#ga49ce0cab2c1b60ddee4784a1432577a4" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDS_DataReader</a> is less than or equal to 32, and the <a class="el" href="group__DDSReaderModule.html#ga49ce0cab2c1b60ddee4784a1432577a4" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDS_DataReader</a> 's <a class="el" href="structDDS__TransportMulticastQosPolicy.html" title="Specifies the multicast address on which a DDS_DataReader wants to receive its data. It can also specify a port number as well as a subset of the available (at the DDS_DomainParticipant level) transports with which to receive the multicast data.">DDS_TransportMulticastQosPolicy</a> is empty, then the <a class="el" href="group__DDSWriterModule.html#gafb74fa54675abe1bfb2090265bf4d116" title="&lt;&lt;interface&gt;&gt; Allows an application to set the value of the data to be published under a given DDS_To...">DDS_DataWriter</a> will performing filtering and send to the <a class="el" href="group__DDSReaderModule.html#ga49ce0cab2c1b60ddee4784a1432577a4" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDS_DataReader</a> only those samples that meet the filtering criteria.</p>
<p>If disallowed by the <a class="el" href="group__DDSWriterModule.html#gafb74fa54675abe1bfb2090265bf4d116" title="&lt;&lt;interface&gt;&gt; Allows an application to set the value of the data to be published under a given DDS_To...">DDS_DataWriter</a>, or if more than 32 <a class="el" href="group__DDSReaderModule.html#ga49ce0cab2c1b60ddee4784a1432577a4" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDS_DataReader</a> require filtering, or the <a class="el" href="group__DDSReaderModule.html#ga49ce0cab2c1b60ddee4784a1432577a4" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDS_DataReader</a> has set the <a class="el" href="structDDS__TransportMulticastQosPolicy.html" title="Specifies the multicast address on which a DDS_DataReader wants to receive its data. It can also specify a port number as well as a subset of the available (at the DDS_DomainParticipant level) transports with which to receive the multicast data.">DDS_TransportMulticastQosPolicy</a>, then the <a class="el" href="group__DDSWriterModule.html#gafb74fa54675abe1bfb2090265bf4d116" title="&lt;&lt;interface&gt;&gt; Allows an application to set the value of the data to be published under a given DDS_To...">DDS_DataWriter</a> sends all samples to the <a class="el" href="group__DDSReaderModule.html#ga49ce0cab2c1b60ddee4784a1432577a4" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDS_DataReader</a>, and the <a class="el" href="group__DDSReaderModule.html#ga49ce0cab2c1b60ddee4784a1432577a4" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDS_DataReader</a> discards any samples that do not meet the filtering criteria.</p>
<p>Although the <code>filter_expression</code> cannot be changed once the <a class="el" href="group__DDSTopicEntityModule.html#ga84a9ecf9064ecc6b3fb4d8dcc5bda0a6" title="&lt;&lt;interface&gt;&gt; Specialization of DDS_TopicDescription that allows for content-based subscriptions...">DDS_ContentFilteredTopic</a> has been created, the <code>expression_parameters</code> can be modified using <a class="el" href="group__DDSTopicEntityModule.html#ga5b784263451a8b22520f7ead80687169" title="Set the expression_parameters.">DDS_ContentFilteredTopic_set_expression_parameters</a>. Any changes made to the filtering criteria by means of <a class="el" href="group__DDSTopicEntityModule.html#ga5b784263451a8b22520f7ead80687169" title="Set the expression_parameters.">DDS_ContentFilteredTopic_set_expression_parameters</a>, will be conveyed to any connected <a class="el" href="group__DDSWriterModule.html#gafb74fa54675abe1bfb2090265bf4d116" title="&lt;&lt;interface&gt;&gt; Allows an application to set the value of the data to be published under a given DDS_To...">DDS_DataWriter</a>. New samples will be subject to the modified filtering criteria, but samples that have already been accepted or rejected are unaffected. However, if the <a class="el" href="group__DDSReaderModule.html#ga49ce0cab2c1b60ddee4784a1432577a4" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDS_DataReader</a> connects to a <a class="el" href="group__DDSWriterModule.html#gafb74fa54675abe1bfb2090265bf4d116" title="&lt;&lt;interface&gt;&gt; Allows an application to set the value of the data to be published under a given DDS_To...">DDS_DataWriter</a> that <em>re-sends</em> its data, the re-sent samples will be subjected to the new filtering criteria.</p>
<h2><a class="anchor" id="NDDSFilterExampleModule_QC_overview"></a>
Overview of QueryCondition</h2>
<p><a class="el" href="group__DDSQueryConditionModule.html#ga51ec811e0c2d583015ac7d5a4cd4d843" title="&lt;&lt;interface&gt;&gt; These are specialised DDS_ReadCondition objects that allow the application to also spec...">DDS_QueryCondition</a> combine aspects of the content filtering capabilities of <a class="el" href="group__DDSTopicEntityModule.html#ga84a9ecf9064ecc6b3fb4d8dcc5bda0a6" title="&lt;&lt;interface&gt;&gt; Specialization of DDS_TopicDescription that allows for content-based subscriptions...">DDS_ContentFilteredTopic</a> with state filtering capabilities of <a class="el" href="group__DDSReadConditionModule.html#ga5386f18823c58c65c1293b0ac89dd9ba" title="&lt;&lt;interface&gt;&gt; Conditions specifically dedicated to read operations and attached to one DDS_DataReader...">DDS_ReadCondition</a> to create a reconfigurable means of filtering or searching data in the <a class="el" href="group__DDSReaderModule.html#ga49ce0cab2c1b60ddee4784a1432577a4" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDS_DataReader</a> queue.</p>
<p><a class="el" href="group__DDSQueryConditionModule.html#ga51ec811e0c2d583015ac7d5a4cd4d843" title="&lt;&lt;interface&gt;&gt; These are specialised DDS_ReadCondition objects that allow the application to also spec...">DDS_QueryCondition</a> may be created on a disabled <a class="el" href="group__DDSReaderModule.html#ga49ce0cab2c1b60ddee4784a1432577a4" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDS_DataReader</a>, or after the <a class="el" href="group__DDSReaderModule.html#ga49ce0cab2c1b60ddee4784a1432577a4" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDS_DataReader</a> has been enabled. If the <a class="el" href="group__DDSReaderModule.html#ga49ce0cab2c1b60ddee4784a1432577a4" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDS_DataReader</a> is enabled, and has already recevied and stored samples in its queue, then all data samples in the are filtered against the <a class="el" href="group__DDSQueryConditionModule.html#ga51ec811e0c2d583015ac7d5a4cd4d843" title="&lt;&lt;interface&gt;&gt; These are specialised DDS_ReadCondition objects that allow the application to also spec...">DDS_QueryCondition</a> filter criteria at the time that the <a class="el" href="group__DDSQueryConditionModule.html#ga51ec811e0c2d583015ac7d5a4cd4d843" title="&lt;&lt;interface&gt;&gt; These are specialised DDS_ReadCondition objects that allow the application to also spec...">DDS_QueryCondition</a> is created. (Note that an exclusive lock is held on the <a class="el" href="group__DDSReaderModule.html#ga49ce0cab2c1b60ddee4784a1432577a4" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDS_DataReader</a> sample queue for the duration of the <a class="el" href="group__DDSQueryConditionModule.html#ga51ec811e0c2d583015ac7d5a4cd4d843" title="&lt;&lt;interface&gt;&gt; These are specialised DDS_ReadCondition objects that allow the application to also spec...">DDS_QueryCondition</a> creation).</p>
<p>Once created, incoming samples are filtered against all <a class="el" href="group__DDSQueryConditionModule.html#ga51ec811e0c2d583015ac7d5a4cd4d843" title="&lt;&lt;interface&gt;&gt; These are specialised DDS_ReadCondition objects that allow the application to also spec...">DDS_QueryCondition</a> filter criteria at the time of their arrival and storage into the <a class="el" href="group__DDSReaderModule.html#ga49ce0cab2c1b60ddee4784a1432577a4" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDS_DataReader</a> queue.</p>
<p>The number of <a class="el" href="group__DDSQueryConditionModule.html#ga51ec811e0c2d583015ac7d5a4cd4d843" title="&lt;&lt;interface&gt;&gt; These are specialised DDS_ReadCondition objects that allow the application to also spec...">DDS_QueryCondition</a> filters that an individual <a class="el" href="group__DDSReaderModule.html#ga49ce0cab2c1b60ddee4784a1432577a4" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDS_DataReader</a> may create is set by <a class="el" href="structDDS__DataReaderResourceLimitsQosPolicy.html#abd0bbad5b44d11f09cd7c4d2a738765b" title="The maximum number of query condition filters a reader is allowed.">DDS_DataReaderResourceLimitsQosPolicy::max_query_condition_filters</a>, to an upper maximum of 32.</p>
<h1><a class="anchor" id="NDDSFilterExampleModule_content_filtered_topic"></a>
Filtering with ContentFilteredTopic</h1>
<ul>
<li><a class="el" href="group__DDSSubscriberExampleModule.html#DDSSubscriberExampleModule_subscriber_setup">Set up subscriber</a></li>
</ul>
<ul>
<li><a class="el" href="group__DDSTopicExampleModule.html#DDSTopicExampleModule_setup">Set up a topic</a></li>
</ul>
<ul>
<li>Create a ContentFilteredTopic, of user data type <code><a class="el" href="structFoo.html" title="A representative user-defined data type.">Foo</a>:</code> <div class="fragment"><div class="line"><a class="code" href="group__DDSTopicEntityModule.html#ga84a9ecf9064ecc6b3fb4d8dcc5bda0a6" title="&lt;&lt;interface&gt;&gt; Specialization of DDS_TopicDescription that allows for content-based subscriptions...">DDS_ContentFilteredTopic</a> *cft = NULL;</div>
<div class="line"><span class="keyword">struct </span><a class="code" href="structDDS__StringSeq.html" title="Instantiates FooSeq &lt; ::char* &gt; with value type semantics.">DDS_StringSeq</a> cft_parameters;</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span>* cft_param_list[] = {<span class="stringliteral">&quot;1&quot;</span>, <span class="stringliteral">&quot;100&quot;</span>};</div>
<div class="line"></div>
<div class="line">DDS_StringSeq_initialize(&amp;cft_parameters);</div>
<div class="line">DDS_StringSeq_set_maximum(&amp;cft_parameters, 2);</div>
<div class="line">DDS_StringSeq_from_array(&amp;cft_parameters, param_list, 2);</div>
<div class="line"></div>
<div class="line">cft = <a class="code" href="group__DDSDomainParticipantModule.html#gac46e0a01c706f02b5f8b929e9ea397ad" title="Creates a DDS_ContentFilteredTopic, that can be used to do content-based subscriptions.">DDS_DomainParticipant_create_contentfilteredtopic</a>(participant,</div>
<div class="line">                                                        <span class="stringliteral">&quot;ContentFilteredTopic&quot;</span>,</div>
<div class="line">                                                        Foo_topic,</div>
<div class="line">                                                        <span class="stringliteral">&quot;value &gt; %0 AND value &lt; %1&quot;</span>,</div>
<div class="line">                                                        &amp;cft_parameters);</div>
<div class="line"><span class="keywordflow">if</span> (cft == NULL) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;create_contentfilteredtopic error\n&quot;</span>);</div>
<div class="line">    subscriber_shutdown(participant);</div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
</div><!-- fragment --></li>
</ul>
<ul>
<li>Create a FooReader using the ContentFilteredTopic: <div class="fragment"><div class="line"><a class="code" href="group__DDSReaderModule.html#ga49ce0cab2c1b60ddee4784a1432577a4" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDS_DataReader</a>* reader;</div>
<div class="line"><a class="code" href="structFooDataReader.html" title="&lt;&lt;interface&gt;&gt; &lt;&lt;generic&gt;&gt; User data type-specific data reader.">FooDataReader</a>* Foo_reader;</div>
<div class="line">reader = <a class="code" href="group__DDSSubscriberModule.html#gac02a61ced642fe9d9f7466f7ba67010e" title="Creates a DDS_DataReader that will be attached and belong to the DDS_Subscriber.">DDS_Subscriber_create_datareader</a>(subscriber,</div>
<div class="line">                                          <a class="code" href="group__DDSTopicEntityModule.html#ga773dc630b6efac7682b99ac5878e6db5" title="Access a DDS_ContentFilteredTopic&#39;s supertype instance.">DDS_ContentFilteredTopic_as_topicdescription</a>(cft),</div>
<div class="line">                                          &amp;reader_qos, <span class="comment">/* or DDS_DATAREADER_QOS_DEFAULT */</span></div>
<div class="line">                                          &amp;reader_listener, <span class="comment">/* or NULL */</span></div>
<div class="line">                                          <a class="code" href="group__DDSStatusTypesModule.html#gaa755e98b5e8484e8be881287b4b0165c" title="All bits are set.">DDS_STATUS_MASK_ALL</a>);</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">if</span> (reader == NULL) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;create_datareader error\n&quot;</span>);</div>
<div class="line">    subscriber_shutdown(participant);</div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">Foo_reader = <a class="code" href="group__DDSReaderModule.html#ga0436d021ed263221d64cc4d072cf3b70" title="Narrow the given DDS_DataReader pointer to a FooDataReader pointer.">FooDataReader_narrow</a>(reader);</div>
<div class="line"><span class="keywordflow">if</span> (Foo_reader == NULL) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;DataReader narrow error\n&quot;</span>);</div>
<div class="line">    subscriber_shutdown(participant);</div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
</div><!-- fragment --> Once setup, reading samples with a <a class="el" href="group__DDSTopicEntityModule.html#ga84a9ecf9064ecc6b3fb4d8dcc5bda0a6" title="&lt;&lt;interface&gt;&gt; Specialization of DDS_TopicDescription that allows for content-based subscriptions...">DDS_ContentFilteredTopic</a> is exactly the same as normal reads or takes, as decribed in <a class="el" href="group__DDSReaderExampleModule.html">DataReader Use Cases</a>.</li>
</ul>
<ul>
<li>Changing filter crieria using set_expression_parameters: <div class="fragment"><div class="line"><a class="code" href="group__DDSStringClass.html#ga13074f0132f743923a4a36ee533997fe" title="Delete a string.">DDS_String_free</a>(DDS_StringSeq_get(&amp;parameters, 0));</div>
<div class="line"><a class="code" href="group__DDSStringClass.html#ga13074f0132f743923a4a36ee533997fe" title="Delete a string.">DDS_String_free</a>(DDS_StringSeq_get(&amp;parameters, 1));</div>
<div class="line">*DDS_StringSeq_get_reference(&amp;parameters, 0) = <a class="code" href="group__DDSStringClass.html#gaaadc788c3850b5625c6d78794943db7d" title="Clone a string. Creates a new string that duplicates the value of string.">DDS_String_dup</a>(<span class="stringliteral">&quot;5&quot;</span>);</div>
<div class="line">*DDS_StringSeq_get_reference(&amp;parameters, 1) = <a class="code" href="group__DDSStringClass.html#gaaadc788c3850b5625c6d78794943db7d" title="Clone a string. Creates a new string that duplicates the value of string.">DDS_String_dup</a>(<span class="stringliteral">&quot;9&quot;</span>);</div>
<div class="line"></div>
<div class="line">retcode = <a class="code" href="group__DDSTopicEntityModule.html#ga5b784263451a8b22520f7ead80687169" title="Set the expression_parameters.">DDS_ContentFilteredTopic_set_expression_parameters</a>(cft,</div>
<div class="line">                                                             &amp;parameters);</div>
<div class="line"><span class="keywordflow">if</span> (retcode != <a class="code" href="group__DDSReturnTypesModule.html#gga73f148aaf96b5f6f9fc630b7cfeb0c91a4f3bc70d86031a38bba356c4b534979f" title="Successful return.">DDS_RETCODE_OK</a>) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;set_expression_parameters error\n&quot;</span>);</div>
<div class="line">    subscriber_shutdown(participant);</div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
</div><!-- fragment --></li>
</ul>
<h1><a class="anchor" id="NDDSFilterExampleModule_query_conditions"></a>
Filtering with Query Conditions</h1>
<ul>
<li>Given a data reader of type <a class="el" href="structFoo.html" title="A representative user-defined data type.">Foo</a> <div class="fragment"><div class="line"><a class="code" href="group__DDSReaderModule.html#ga49ce0cab2c1b60ddee4784a1432577a4" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDS_DataReader</a>* reader = ...;</div>
<div class="line"><a class="code" href="structFooDataReader.html" title="&lt;&lt;interface&gt;&gt; &lt;&lt;generic&gt;&gt; User data type-specific data reader.">FooDataReader</a>* Foo_reader = <a class="code" href="group__DDSReaderModule.html#ga0436d021ed263221d64cc4d072cf3b70" title="Narrow the given DDS_DataReader pointer to a FooDataReader pointer.">FooDataReader_narrow</a>(reader);</div>
</div><!-- fragment --></li>
</ul>
<ul>
<li>Creating a QueryCondition <div class="fragment"><div class="line"><a class="code" href="group__DDSQueryConditionModule.html#ga51ec811e0c2d583015ac7d5a4cd4d843" title="&lt;&lt;interface&gt;&gt; These are specialised DDS_ReadCondition objects that allow the application to also spec...">DDS_QueryCondition</a> *queryCondition = NULL;</div>
<div class="line"><span class="keyword">struct </span><a class="code" href="structDDS__StringSeq.html" title="Instantiates FooSeq &lt; ::char* &gt; with value type semantics.">DDS_StringSeq</a> qc_parameters;</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> *qc_param_list[] = {<span class="stringliteral">&quot;1&quot;</span>,<span class="stringliteral">&quot;100&quot;</span>};</div>
<div class="line"></div>
<div class="line">DDS_StringSeq_initialize(&amp;qc_parameters);</div>
<div class="line">DDS_StringSeq_set_maximum(&amp;qc_parameters, 2);</div>
<div class="line">DDS_StringSeq_from_array(&amp;qc_parameters, qc_param_list, 2);</div>
<div class="line">queryCondition = <a class="code" href="group__DDSReaderModule.html#gadc22d119a497a8e2359f6cb2ebcfd0fd" title="Creates a DDS_QueryCondition.">DDS_DataReader_create_querycondition</a>(reader,</div>
<div class="line">                                                      <a class="code" href="group__DDSSampleStateModule.html#ggadb6d36e7c796da27519b6bf7f8f187e5a2a3ec923ec261c0c5e50141223f20ee0" title="Sample has not been read.">DDS_NOT_READ_SAMPLE_STATE</a>,</div>
<div class="line">                                                      <a class="code" href="group__DDSViewStateModule.html#ga5b8ea06fe00397fcbd7b7e1e48631bfb" title="Any view state DDS_NEW_VIEW_STATE | DDS_NOT_NEW_VIEW_STATE.">DDS_ANY_VIEW_STATE</a>,</div>
<div class="line">                                                      <a class="code" href="group__DDSInstanceStateModule.html#ggaf2264cae1aa8cd66490debfdc5e0c360a093477a56893c9f6e94fb620a52e06c3" title="Instance is currently in existence.">DDS_ALIVE_INSTANCE_STATE</a>,</div>
<div class="line">                                                      <span class="stringliteral">&quot;value &gt; %0 AND value &lt; %1&quot;</span>,</div>
<div class="line">                                                      &amp;qc_parameters);</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">if</span> (queryCondition == NULL) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;create_query_condition error\n&quot;</span>);</div>
<div class="line">    subscriber_shutdown(participant);</div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
</div><!-- fragment --></li>
</ul>
<ul>
<li>Reading matching samples with a <a class="el" href="group__DDSQueryConditionModule.html#ga51ec811e0c2d583015ac7d5a4cd4d843" title="&lt;&lt;interface&gt;&gt; These are specialised DDS_ReadCondition objects that allow the application to also spec...">DDS_QueryCondition</a> <div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code" href="structFooSeq.html" title="&lt;&lt;interface&gt;&gt; &lt;&lt;generic&gt;&gt; A type-safe, ordered collection of elements. The type of these elements is ...">FooSeq</a> data_seq = <a class="code" href="group__DDSSequenceModule.html#ga521eb819a3b85277debce55d61b08f82" title="An initializer for new sequence instances.">DDS_SEQUENCE_INITIALIZER</a>;</div>
<div class="line"><span class="keyword">struct </span><a class="code" href="structDDS__SampleInfoSeq.html" title="Declares IDL sequence &lt; DDS_SampleInfo &gt; .">DDS_SampleInfoSeq</a> info_seq = <a class="code" href="group__DDSSequenceModule.html#ga521eb819a3b85277debce55d61b08f82" title="An initializer for new sequence instances.">DDS_SEQUENCE_INITIALIZER</a>;</div>
<div class="line"></div>
<div class="line">retcode = <a class="code" href="group__DDSReaderModule.html#gab3aa397b246f0c8e5b62940597dfa280" title="Accesses via FooDataReader_read the samples that match the criteria specified in the DDS_ReadConditio...">FooDataReader_read_w_condition</a>(Foo_reader,</div>
<div class="line">                                         &amp;data_seq, &amp;info_seq,</div>
<div class="line">                                         <a class="code" href="group__DDSResourceLimitsQosModule.html#ga58912505c0b73a5f1d3677eaf9ce9e6d" title="A special value indicating an unlimited quantity.">DDS_LENGTH_UNLIMITED</a>,</div>
<div class="line">                                         queryCondition);</div>
<div class="line"><span class="keywordflow">if</span> (retcode == <a class="code" href="group__DDSReturnTypesModule.html#gga73f148aaf96b5f6f9fc630b7cfeb0c91aa8e69444ae8a8efa65bde05556818669" title="Indicates a transient situation where the operation did not return any data but there is no inherent ...">DDS_RETCODE_NO_DATA</a>) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;no matching data\n&quot;</span>);</div>
<div class="line">} <span class="keywordflow">else</span> <span class="keywordflow">if</span> (retcode != <a class="code" href="group__DDSReturnTypesModule.html#gga73f148aaf96b5f6f9fc630b7cfeb0c91a4f3bc70d86031a38bba356c4b534979f" title="Successful return.">DDS_RETCODE_OK</a>) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;read_w_condition error %d\n&quot;</span>, retcode);</div>
<div class="line">    subscriber_shutdown(participant);</div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">} <span class="keywordflow">else</span> {</div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="group__DDSSequenceModule.html#gaf7a45e00319eeb1ddf5c84ac68657adb" title="Get the logical length of this sequence.">FooSeq_get_length</a>(&amp;data_seq); ++i) {</div>
<div class="line">        <span class="keywordflow">if</span> (DDS_SampleInfoSeq_get_reference(&amp;info_seq, i)-&gt;valid_data) {</div>
<div class="line">            <span class="comment">/* process your data here */</span></div>
<div class="line">        }</div>
<div class="line">    retcode = <a class="code" href="group__DDSReaderModule.html#gadf2188ce7cd1b7bed39451833b91f1f6" title="Indicates to the DDS_DataReader that the application is done accessing the collection of received_dat...">FooDataReader_return_loan</a>(Foo_reader,</div>
<div class="line">                                        &amp;data_seq, &amp;info_seq);</div>
<div class="line">    <span class="keywordflow">if</span> (retcode != <a class="code" href="group__DDSReturnTypesModule.html#gga73f148aaf96b5f6f9fc630b7cfeb0c91a4f3bc70d86031a38bba356c4b534979f" title="Successful return.">DDS_RETCODE_OK</a>) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;return loan error %d\n&quot;</span>, retcode);</div>
<div class="line">        subscriber_shutdown(participant);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --></li>
</ul>
<ul>
<li><a class="el" href="group__DDSQueryConditionModule.html#ga68063df18ddf6c89968f01c195cd763c" title="Sets the query parameters.">DDS_QueryCondition_set_query_parameters</a> is used similarly to <a class="el" href="group__DDSTopicEntityModule.html#ga5b784263451a8b22520f7ead80687169" title="Set the expression_parameters.">DDS_ContentFilteredTopic_set_expression_parameters</a>, and the same coding techniques can be used.</li>
</ul>
<ul>
<li>Any <a class="el" href="group__DDSQueryConditionModule.html#ga51ec811e0c2d583015ac7d5a4cd4d843" title="&lt;&lt;interface&gt;&gt; These are specialised DDS_ReadCondition objects that allow the application to also spec...">DDS_QueryCondition</a> that have been created must be deleted before the <a class="el" href="group__DDSReaderModule.html#ga49ce0cab2c1b60ddee4784a1432577a4" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDS_DataReader</a> can be deleted. This can be done using <a class="el" href="group__DDSReaderModule.html#ga605cd53958cf2919c345c76259123650" title="Deletes all the entities that were created by means of the &quot;create&quot; operations on the DDS_DataReader...">DDS_DataReader_delete_contained_entities</a> or manually as in: <div class="fragment"><div class="line">retcode = <a class="code" href="group__DDSReaderModule.html#ga47b1ae37d4e2eb9070f8df5b5aa1446b" title="Deletes a DDS_ReadCondition or DDS_QueryCondition attached to the DDS_DataReader.">DDS_DataReader_delete_readcondition</a>(reader,</div>
<div class="line">                                              queryCondition);</div>
</div><!-- fragment --></li>
</ul>
<h1><a class="anchor" id="NDDSFilterExampleModule_performance"></a>
Filtering Performance</h1>
<p>Although RTI Connext supports filtering on any field or combination of fields using the SQL syntax of the built-in filter, filters for keyed topics that filter solely on the contents of key fields have the potential for much higher performance. This is because for key field only filters, the <a class="el" href="group__DDSReaderModule.html#ga49ce0cab2c1b60ddee4784a1432577a4" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDS_DataReader</a> caches the results of the filter (pass or not pass) for each instance. When another sample of the same instance is seen at the <a class="el" href="group__DDSReaderModule.html#ga49ce0cab2c1b60ddee4784a1432577a4" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDS_DataReader</a>, the filter results are retrieved from cache, dispensing with the need to call the filter function.</p>
<p>This optimization applies to all filtering using the built-in SQL filter, performed by the <a class="el" href="group__DDSReaderModule.html#ga49ce0cab2c1b60ddee4784a1432577a4" title="&lt;&lt;interface&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">DDS_DataReader</a>, for either <a class="el" href="group__DDSTopicEntityModule.html#ga84a9ecf9064ecc6b3fb4d8dcc5bda0a6" title="&lt;&lt;interface&gt;&gt; Specialization of DDS_TopicDescription that allows for content-based subscriptions...">DDS_ContentFilteredTopic</a> or <a class="el" href="group__DDSQueryConditionModule.html#ga51ec811e0c2d583015ac7d5a4cd4d843" title="&lt;&lt;interface&gt;&gt; These are specialised DDS_ReadCondition objects that allow the application to also spec...">DDS_QueryCondition</a>. This does <em>not</em> apply to filtering perfomed for <a class="el" href="group__DDSTopicEntityModule.html#ga84a9ecf9064ecc6b3fb4d8dcc5bda0a6" title="&lt;&lt;interface&gt;&gt; Specialization of DDS_TopicDescription that allows for content-based subscriptions...">DDS_ContentFilteredTopic</a> by the <a class="el" href="group__DDSWriterModule.html#gafb74fa54675abe1bfb2090265bf4d116" title="&lt;&lt;interface&gt;&gt; Allows an application to set the value of the data to be published under a given DDS_To...">DDS_DataWriter</a>. </p>
</div><!-- contents -->
</div><!-- doc-content -->
<HR>
<IMG SRC="rti_logo.gif" height="16">
<A HREF="main.html">RTI Connext C API Version 5.2.3</A>
Copyright &copy; Wed Apr 27 2016 
<A HREF="http://www.rti.com">Real-Time Innovations, Inc</A>
</BODY>
</HTML>
