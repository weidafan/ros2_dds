<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>RTI Connext Modern C++ API: DataReader Use Cases</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">RTI Connext Modern C++ API
   &#160;<span id="projectnumber">Version 5.2.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2-20120808 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__DDSReaderExampleModule.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">DataReader Use Cases</div>  </div>
<div class="ingroups"><a class="el" href="group__DDSHowToModule.html">Programming How-To's</a></div></div><!--header-->
<div class="contents">
<p>The following #includes are needed for the examples on this page </p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;dds/sub/ddssub.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;dds/domain/ddsdomain.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;dds/core/ddscore.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;dds/topic/ddstopic.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;dds/pub/ddspub.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;rti/core/ListenerBinder.hpp&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &quot;Foo.hpp&quot;</span></div>
</div><!-- fragment --> <h1><a class="anchor" id="DDSReaderExampleModule_reader_setup"></a>
Setting up a DataReader</h1>
<ul>
<li><a class="el" href="group__DDSSubscriberExampleModule.html#DDSSubscriberExampleModule_subscriber_setup">Set up a Subscriber</a></li>
</ul>
<ul>
<li><a class="el" href="group__DDSTopicExampleModule.html#DDSTopicExampleModule_setup">Set up a Topic</a></li>
</ul>
<ul>
<li>Create a DataReader of user-defined type <a class="el" href="classFoo.html" title="A hypothetical topic-type.">Foo</a> with each of the available constructors <div class="fragment"><div class="line">    <span class="comment">// Create the Participant</span></div>
<div class="line">    <a class="code" href="classdds_1_1domain_1_1DomainParticipant.html" title="&lt;&lt;reference-type&gt;&gt; Container for all dds::core::Entity objects.">dds::domain::DomainParticipant</a> participant(0);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Create a Topic</span></div>
<div class="line">    <a class="code" href="classdds_1_1topic_1_1Topic.html" title="&lt;&lt;reference-type&gt;&gt; Topic is the most basic description of the data to be published and subscribed...">dds::topic::Topic&lt;Foo&gt;</a> topic(participant, <span class="stringliteral">&quot;MyTopicName&quot;</span>);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// When not explicitly provided to the constructor, the </span></div>
<div class="line">    <span class="comment">// created DataReader&#39;s QoS is default, has a NULL listener, and a status mask</span></div>
<div class="line">    <span class="comment">// dds::core::status::StatusMask::all()</span></div>
<div class="line"></div>
<div class="line">    <span class="comment">// In all of the following constructors &#39;topic&#39; could also be an instance </span></div>
<div class="line">    <span class="comment">// of dds::topic::ContentFilteredTopic </span></div>
<div class="line">     </div>
<div class="line">    <span class="comment">// Creating a DataReader, creating the subscriber inline</span></div>
<div class="line">    <a class="code" href="classdds_1_1sub_1_1DataReader.html" title="&lt;&lt;reference-type&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">dds::sub::DataReader&lt;Foo&gt;</a> </div>
<div class="line">        reader1(<a class="code" href="classdds_1_1sub_1_1Subscriber.html" title="&lt;&lt;reference-type&gt;&gt; A subscriber is the object responsible for actually receiving data from a subscrip...">dds::sub::Subscriber</a>(participant), topic);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Create a Subscriber</span></div>
<div class="line">    <a class="code" href="classdds_1_1sub_1_1Subscriber.html" title="&lt;&lt;reference-type&gt;&gt; A subscriber is the object responsible for actually receiving data from a subscrip...">dds::sub::Subscriber</a> subscriber(participant);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Creating a DataReader with modified QoS</span></div>
<div class="line">    <a class="code" href="classdds_1_1sub_1_1qos_1_1DataReaderQos.html" title="&lt;&lt;value-type&gt;&gt; Container of the QoS policies that a dds::sub::DataReader supports">dds::sub::qos::DataReaderQos</a> qos;</div>
<div class="line">    qos &lt;&lt; <a class="code" href="classdds_1_1core_1_1policy_1_1History.html#abbb117f178a30e6753ba7e36998a471a" title="Creates a History with HistoryKind::KEEP_ALL.">dds::core::policy::History::KeepAll</a>();</div>
<div class="line">    <a class="code" href="classdds_1_1sub_1_1DataReader.html" title="&lt;&lt;reference-type&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">dds::sub::DataReader&lt;Foo&gt;</a> reader2(subscriber, topic, qos);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Creating a DataReader with modified QoS and a listener</span></div>
<div class="line">    ExampleDataReaderListener *listener = <span class="keyword">new</span> ExampleDataReaderListener;</div>
<div class="line">    <a class="code" href="classdds_1_1sub_1_1DataReader.html" title="&lt;&lt;reference-type&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">dds::sub::DataReader&lt;Foo&gt;</a> reader3(</div>
<div class="line">       subscriber, </div>
<div class="line">       topic, </div>
<div class="line">       qos, </div>
<div class="line">       listener);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Creating a DataReader with modified QoS, a listener, and a liveliness_changed() </span></div>
<div class="line">    <span class="comment">// status mask</span></div>
<div class="line">    <a class="code" href="classdds_1_1sub_1_1DataReader.html" title="&lt;&lt;reference-type&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">dds::sub::DataReader&lt;Foo&gt;</a> reader4(</div>
<div class="line">       subscriber, </div>
<div class="line">       topic, </div>
<div class="line">       qos, </div>
<div class="line">       listener, </div>
<div class="line">       <a class="code" href="classdds_1_1core_1_1status_1_1StatusMask.html#a493eee23d95003104e802ef5a1ea4b61" title="The liveliness of one or more dds::pub::DataWriter that were writing instances read through the dds::...">dds::core::status::StatusMask::liveliness_changed</a>());</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Creating an entity with a listener automatically retains the entity, so </span></div>
<div class="line">    <span class="comment">// we must either explicitly close the DataReader...</span></div>
<div class="line">    reader3.close();</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// ... or set the listener to null</span></div>
<div class="line">    reader4.listener(NULL, <a class="code" href="classdds_1_1core_1_1status_1_1StatusMask.html#a95ea77cba1230de1b4349c888a0e0ff6" title="No bits are set.">dds::core::status::StatusMask::none</a>());</div>
</div><!-- fragment --> </li>
</ul>
<h1><a class="anchor" id="DDSReaderExampleModule_reader_instances"></a>
Managing instances</h1>
<ul>
<li>Getting an instance key value of user data type <a class="el" href="classFoo.html" title="A hypothetical topic-type.">Foo</a> <div class="fragment"><div class="line">    <span class="comment">// Instead of a sample of type Foo, key_value() could also take a </span></div>
<div class="line">    <span class="comment">// TopicInstance&lt;Foo&gt; object. key_value only populates the key field in the </span></div>
<div class="line">    <span class="comment">// sample</span></div>
<div class="line">    <a class="code" href="classFoo.html" title="A hypothetical topic-type.">Foo</a> retrieved_sample_key;</div>
<div class="line">    reader.key_value(retrieved_sample_key, handle);</div>
</div><!-- fragment --> </li>
</ul>
<h1><a class="anchor" id="DDSReaderExampleModule_receive_setup"></a>
Set up a DataReader to access received data</h1>
<ul>
<li><a class="el" href="group__DDSReaderExampleModule.html#DDSReaderExampleModule_reader_setup">Set up a DataReader</a></li>
</ul>
<ul>
<li>Set up the DataReader to handle the DDS_DATA_AVAILABLE_STATUS status, in one or both of the following two ways.</li>
</ul>
<ul>
<li><a class="el" href="group__DDSEntityExampleModuleForCpp2.html#DDSEntityExampleModule_listener">Enable DDS_DATA_AVAILABLE_STATUS for the DDSDataReaderListener associated with the data reader</a><ul>
<li>The processing to handle the status change is done in the DataReaderListener on_data_available() method of the attached listener.</li>
<li>Typical processing will <a class="el" href="group__DDSReaderExampleModule.html#DDSReaderExampleModule_receive">access the received data</a>.</li>
</ul>
</li>
</ul>
<ul>
<li><a class="el" href="group__DDSEntityExampleModuleForCpp2.html#DDSEntityExampleModule_statuscondition">Enable DDS_DATA_AVAILABLE_STATUS for the DDSStatusCondition associated with the data reader</a><ul>
<li>The processing to handle the status change is done <a class="el" href="group__DDSWaitsetExampleModule.html#DDSWaitsetExampleModule_trigger">when the data reader's attached status condition is triggered</a> and the DDS_DATA_AVAILABLE_STATUS status on the data reader is changed.</li>
<li>Typical processing will <a class="el" href="group__DDSReaderExampleModule.html#DDSReaderExampleModule_receive">access the received data</a>.</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="DDSReaderExampleModule_receive"></a>
Accessing Received Data</h1>
<h2><a class="anchor" id="DDSReaderExampleModule_read_samples"></a>
Reading data samples</h2>
<p>You can read data samples from a DataReader by receiving a loan, inspecting the samples and then returning the loan, or you can directly copy them.</p>
<ul>
<li><p class="startli">To iterate through loaned data samples in your application you will use a LoanedSamples container. The following code shows different ways to use this container</p>
<div class="fragment"><div class="line">    <span class="comment">// Take all the samples in the reader queue (if you don&#39;t want to remove</span></div>
<div class="line">    <span class="comment">// them from the queue and read them later again, use reader.read() instead)</span></div>
<div class="line">    <a class="code" href="classdds_1_1sub_1_1LoanedSamples.html" title="&lt;&lt;move-only-type&gt;&gt; Provides temporary access to a collection of samples from a DataReader.">dds::sub::LoanedSamples&lt;Foo&gt;</a> samples = reader.take();</div>
<div class="line"></div>
<div class="line">    <span class="comment">// LoanedSamples&lt;Foo&gt; is a container of LoanedSample&lt;Foo&gt; elements, which</span></div>
<div class="line">    <span class="comment">// contain the actual data (Foo) and the SampleInfo</span></div>
<div class="line">    <span class="keywordflow">for</span> (<a class="code" href="classdds_1_1sub_1_1LoanedSamples.html#a993a3702ae5993ffeadf1fb6a79cc216" title="The iterator type.">dds::sub::LoanedSamples&lt;Foo&gt;::iterator</a> sample_it = samples.<a class="code" href="classdds_1_1sub_1_1LoanedSamples.html#a417790627e30ca877a6a556014973227" title="Gets an iterator to the first sample.">begin</a>();</div>
<div class="line">         sample_it != samples.<a class="code" href="classdds_1_1sub_1_1LoanedSamples.html#afd989c219c45584247b7715a16927fb6" title="Gets an iterator to one past the last sample.">end</a>();</div>
<div class="line">         ++sample_it) {</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (sample_it-&gt;info().valid()) {</div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;Received: &quot;</span> &lt;&lt; sample_it-&gt;data() &lt;&lt; std::endl;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">// The previous code is simpler with C++11&#39;s range-based for-loop</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; sample : samples) {</div>
<div class="line">        <span class="keywordflow">if</span> (sample.info().valid()) {</div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;Received: &quot;</span> &lt;&lt; sample.data() &lt;&lt; std::endl;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">// You can also access samples using the subscript operator</span></div>
<div class="line">    <span class="keywordflow">if</span> (samples.length() &gt;= 2) {</div>
<div class="line">        <span class="keywordflow">if</span> (samples[1].info().valid()) {</div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;Second sample is &quot;</span> &lt;&lt; samples[1].data() &lt;&lt; std::endl;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;Second sample is invalid\n&quot;</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">// You can copy the samples using std::copy:</span></div>
<div class="line">    std::vector&lt;rti::sub::LoanedSample&lt;Foo&gt; &gt; samples_copy;</div>
<div class="line">    std::copy(samples.begin(), samples.end(), std::back_inserter(samples_copy));</div>
<div class="line"></div>
<div class="line">    <span class="comment">// You can also access the data directly. A sample can be implicitly</span></div>
<div class="line">    <span class="comment">// converted into a reference to its data type as long as it contains</span></div>
<div class="line">    <span class="comment">// valid data.</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">// The iterator adapter valid_samples will skip samples containing</span></div>
<div class="line">    <span class="comment">// invalid data</span></div>
<div class="line">    std::vector&lt;Foo&gt; data_copy;</div>
<div class="line">    std::copy(</div>
<div class="line">        <a class="code" href="namespacerti_1_1sub.html#a0328608017a5af7a16293154805df484" title="&lt;&lt;extension&gt;&gt; Returns an iterator that skips invalid samples">rti::sub::valid_samples</a>(samples.begin()),</div>
<div class="line">        <a class="code" href="namespacerti_1_1sub.html#a0328608017a5af7a16293154805df484" title="&lt;&lt;extension&gt;&gt; Returns an iterator that skips invalid samples">rti::sub::valid_samples</a>(samples.end()),</div>
<div class="line">        std::back_inserter(data_copy));</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Attempting to access invalid data will result in an exception.</span></div>
<div class="line">    <span class="keywordflow">try</span> {</div>
<div class="line">        <span class="comment">// The following will throw if !samples[0].info().valid()</span></div>
<div class="line">        <a class="code" href="classFoo.html" title="A hypothetical topic-type.">Foo</a> data = samples[0].data();</div>
<div class="line">        std::cout &lt;&lt; data &lt;&lt; std::endl;</div>
<div class="line"></div>
<div class="line">        <span class="comment">// The following will throw if any sample contains invalid data</span></div>
<div class="line">        std::copy(samples.begin(), samples.end(), std::back_inserter(data_copy));</div>
<div class="line">    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> <a class="code" href="classdds_1_1core_1_1PreconditionNotMetError.html" title="A PreconditionNotMetError is thrown when a pre-condition for the operation was not met...">dds::core::PreconditionNotMetError</a>&amp; ex) {</div>
<div class="line">        std::cerr &lt;&lt; <span class="stringliteral">&quot;Attempted to access sample containing invalid data: &quot;</span></div>
<div class="line">                  &lt;&lt; ex.<a class="code" href="classdds_1_1core_1_1PreconditionNotMetError.html#ad46edb86d855160b4ec22e157f909f96" title="Access the message contained in this PreconditionNotMetError exception.">what</a>() &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">// You can also apply other iterator-based algorithms,</span></div>
<div class="line">    <span class="comment">// like this example that prints just one field of the data type</span></div>
<div class="line">    <span class="comment">// (assuming that Foo contains an integer field called &#39;x&#39;)</span></div>
<div class="line">    std::transform(</div>
<div class="line">        <a class="code" href="namespacerti_1_1sub.html#a0328608017a5af7a16293154805df484" title="&lt;&lt;extension&gt;&gt; Returns an iterator that skips invalid samples">rti::sub::valid_samples</a>(samples.begin()),</div>
<div class="line">        <a class="code" href="namespacerti_1_1sub.html#a0328608017a5af7a16293154805df484" title="&lt;&lt;extension&gt;&gt; Returns an iterator that skips invalid samples">rti::sub::valid_samples</a>(samples.end()),</div>
<div class="line">        std::ostream_iterator&lt;int&gt;(std::cout, <span class="stringliteral">&quot;, &quot;</span>),</div>
<div class="line">        [](<span class="keyword">const</span> <a class="code" href="classFoo.html" title="A hypothetical topic-type.">Foo</a>&amp; data) { <span class="keywordflow">return</span> data.x(); });</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Once a LoanedSamples object goes out of scope its destructor</span></div>
<div class="line">    <span class="comment">// automatically returns the loan to the middleware. If you need to</span></div>
<div class="line">    <span class="comment">// explicitly return it, call return_loan()</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">// samples.return_loan()</span></div>
<div class="line"></div>
</div><!-- fragment --></li>
<li><p class="startli">Although the LoanedSamples is the most generic way to access data in a DataReader, for convinience other overloaded versions of read/take allow to directly copy the data</p>
<div class="fragment"><div class="line"></div>
<div class="line">    <span class="comment">// The first version of read/take receives a back-insert iterator</span></div>
<div class="line">    std::vector&lt;dds::sub::Sample&lt;Foo&gt; &gt; my_vector1;</div>
<div class="line">    reader.take(std::back_inserter(my_vector1));</div>
<div class="line"></div>
<div class="line">    <span class="comment">// The second version receives a forward iterator and the maximum size</span></div>
<div class="line">    std::vector&lt;dds::sub::Sample&lt;Foo&gt; &gt; my_vector2(10);</div>
<div class="line">    reader.take(my_vector2.begin(), 10);</div>
<div class="line"></div>
</div><!-- fragment --></li>
<li>See also <a class="el" href="group__DDSTypesModule.html">Working with IDL types</a></li>
</ul>
<h2><a class="anchor" id="DDSReaderExampleModule_select_samples"></a>
Selecting what samples to read</h2>
<p>The functions <a class="el" href="classdds_1_1sub_1_1DataReader.html#a98dec1c877cf53e47890cf44b0021274" title="The stream manipulator to indicate that the reader should read samples as opposed to taking the sampl...">read()</a> and <a class="el" href="classdds_1_1sub_1_1DataReader.html#a1d38fa7050790fd33745d6e45dc1b55c" title="The stream manipulator to indicate that the reader should take samples as opposed to reading the samp...">take()</a> select all samples in the DataReader queue. The function select() allows specifying different criteria about the data to read. A equivalent API, using the streaming &gt;&gt; operator is available too.</p>
<ul>
<li><p class="startli">select() example</p>
<div class="fragment"><div class="line"></div>
<div class="line">    <span class="comment">// To select what samples you want to read (or take) from a DataReader</span></div>
<div class="line">    <span class="comment">// queue, you can use a Selector. When you don&#39;t specify a parameter in the</span></div>
<div class="line">    <span class="comment">// Selector, the default applies.</span></div>
<div class="line">    <a class="code" href="classdds_1_1sub_1_1LoanedSamples.html" title="&lt;&lt;move-only-type&gt;&gt; Provides temporary access to a collection of samples from a DataReader.">dds::sub::LoanedSamples&lt;Foo&gt;</a> samples =</div>
<div class="line">        <span class="comment">// Call select() to create a Selector and then specify its parameters</span></div>
<div class="line">        reader.select()</div>
<div class="line">            <span class="comment">// Specifies the maximum number of samples to read/take</span></div>
<div class="line">            <span class="comment">// in this function call. Default: set by Qos.</span></div>
<div class="line">            .max_samples(20)</div>
<div class="line">            <span class="comment">// Specifies the sample, view and instance states - default: all.</span></div>
<div class="line">            .state(<a class="code" href="classdds_1_1sub_1_1status_1_1DataState.html#ad14326c8d3ac460590b8af2dcb1479c7" title="Create a DataState with InstanceState::alive(), ViewState::new_view(), and SampleState::any()">dds::sub::status::DataState::new_instance</a>())</div>
<div class="line">            <span class="comment">// Specifies a query on the data sample - default: all</span></div>
<div class="line">            .content(<a class="code" href="classdds_1_1sub_1_1Query.html" title="&lt;&lt;value-type&gt;&gt; Encapsulates a query for a dds::sub::cond::QueryCondition.">dds::sub::Query</a>(reader, <span class="stringliteral">&quot;x &gt; 10&quot;</span>))</div>
<div class="line">            <span class="comment">// Specifies what instance to read - default: all instances</span></div>
<div class="line">            .instance(my_instance_handle)</div>
<div class="line">            <span class="comment">// And finally call read() or take()</span></div>
<div class="line">            .take();</div>
<div class="line"></div>
<div class="line">    <span class="comment">// You can also specify state and content by using a Condition. Reusing</span></div>
<div class="line">    <span class="comment">// a Condition for multiple reads is more efficient than specifying the</span></div>
<div class="line">    <span class="comment">// content() every time.</span></div>
<div class="line">    dds::sub::cond::QueryCondition query_condition(</div>
<div class="line">        <a class="code" href="classdds_1_1sub_1_1Query.html" title="&lt;&lt;value-type&gt;&gt; Encapsulates a query for a dds::sub::cond::QueryCondition.">dds::sub::Query</a>(reader, <span class="stringliteral">&quot;x &gt; 10&quot;</span>),</div>
<div class="line">        <a class="code" href="classdds_1_1sub_1_1status_1_1DataState.html" title="The DataState class describes the state of a sample and includes the information about the sample&#39;s I...">dds::sub::status::DataState</a>(</div>
<div class="line">            <a class="code" href="classdds_1_1sub_1_1status_1_1SampleState.html#ad84dc3347fda6f76a38278e953f1e52e" title="Creates a not_read SampleState object.">dds::sub::status::SampleState::not_read</a>(),</div>
<div class="line">            <a class="code" href="classdds_1_1sub_1_1status_1_1ViewState.html#a14bf7741004a0b1a6682b6d678ea3103" title="Creates a new_view ViewState object.">dds::sub::status::ViewState::new_view</a>(),</div>
<div class="line">            <a class="code" href="classdds_1_1sub_1_1status_1_1InstanceState.html#aa84c5cb12f5dfe392bb80710cc2ef070" title="Creates an alive InstanceState object.">dds::sub::status::InstanceState::alive</a>()));</div>
<div class="line"></div>
<div class="line">    samples = reader.select()</div>
<div class="line">        .condition(query_condition)</div>
<div class="line">        .take();</div>
<div class="line"></div>
<div class="line">    <span class="comment">// And you can read instance by instance using next_instance().</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">// To read the first instance, use InstanceHandle::nil()</span></div>
<div class="line">    <a class="code" href="classdds_1_1core_1_1InstanceHandle.html" title="&lt;&lt;value-type&gt;&gt; Handle to identiy different instances of the same dds::topic::Topic of a certain type...">dds::core::InstanceHandle</a> previous_handle = <a class="code" href="classdds_1_1core_1_1InstanceHandle.html#a2d36c968b0bd2e802d6adc1917794a74" title="Returns the nil instance handle.">dds::core::InstanceHandle::nil</a>();</div>
<div class="line">    <span class="keywordflow">do</span> {</div>
<div class="line">        samples = reader.select()</div>
<div class="line">            .next_instance(previous_handle)</div>
<div class="line">            .take();</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (samples.<a class="code" href="classdds_1_1sub_1_1LoanedSamples.html#a5b2068d3ff02a2099070acfda874e10c" title="Gets the number of samples in this collection.">length</a>() &gt; 0) {</div>
<div class="line">            <span class="comment">// do something with samples ...</span></div>
<div class="line"></div>
<div class="line">            <span class="comment">// Update previous_handle to read the instance following this one</span></div>
<div class="line">            previous_handle = samples[0].info().instance_handle();</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">while</span> (samples.<a class="code" href="classdds_1_1sub_1_1LoanedSamples.html#a5b2068d3ff02a2099070acfda874e10c" title="Gets the number of samples in this collection.">length</a>() &gt; 0);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// select() returns an object you can reuse</span></div>
<div class="line">    <a class="code" href="classdds_1_1sub_1_1DataReader_1_1Selector.html" title="The Selector class is used by the DataReader to compose read and take operations.">dds::sub::DataReader&lt;Foo&gt;::Selector</a> selector = reader.select().<a class="code" href="classdds_1_1sub_1_1DataReader_1_1Selector.html#a429ad21e9aeefb8378ed51bec597c899" title="Choose to only read/take up to a maximum number of samples.">max_samples</a>(20);</div>
<div class="line">    samples = selector.<a class="code" href="classdds_1_1sub_1_1DataReader_1_1Selector.html#acf328113d3517da39cd46adeb9ed8ad0" title="Read samples based on the state associated with this Selector.">read</a>();</div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line">    selector.<a class="code" href="classdds_1_1sub_1_1DataReader_1_1Selector.html#a8ffef4f2b0f9924fef6d53f2d02b8cd5" title="Select a specific DataState.">state</a>(<a class="code" href="classdds_1_1sub_1_1status_1_1DataState.html#ad14326c8d3ac460590b8af2dcb1479c7" title="Create a DataState with InstanceState::alive(), ViewState::new_view(), and SampleState::any()">dds::sub::status::DataState::new_instance</a>());</div>
<div class="line">    samples = selector.<a class="code" href="classdds_1_1sub_1_1DataReader_1_1Selector.html#a9c1eb84ae2ed9ccfc8ec5f5b04592a4a" title="Take samples based on the state associated with this Selector.">take</a>();</div>
<div class="line"></div>
</div><!-- fragment --></li>
<li><p class="startli">Streaming example</p>
<div class="fragment"><div class="line"></div>
<div class="line">    <span class="keyword">using namespace </span>dds::sub;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// The overloaded shift operator defines a domain-specific language to</span></div>
<div class="line">    <span class="comment">// specify what samples to read. The following code has the same effect as</span></div>
<div class="line">    <span class="comment">// the first select() example from the previous code snippet</span></div>
<div class="line">    <a class="code" href="classdds_1_1sub_1_1LoanedSamples.html" title="&lt;&lt;move-only-type&gt;&gt; Provides temporary access to a collection of samples from a DataReader.">LoanedSamples&lt;Foo&gt;</a> samples;</div>
<div class="line">    reader &gt;&gt; <a class="code" href="namespacedds_1_1sub.html#a1d38fa7050790fd33745d6e45dc1b55c" title="The stream manipulator to indicate that the reader should take samples as opposed to reading the samp...">take</a> <span class="comment">// first indicate if you want to read or take;</span></div>
<div class="line">           &gt;&gt; <a class="code" href="namespacedds_1_1sub.html#a5716896c675131de3607d122c1fc8a9f" title="Stream manipulator to set the maximum number of samples to read or take.">max_samples</a>(20) <span class="comment">// then specify the parameters you want...</span></div>
<div class="line">           &gt;&gt; <a class="code" href="namespacedds_1_1sub.html#abe4fe4b5bbfd95ca2c8b6574aa587704" title="Stream manipulator to specify the DataState of the samples that should be read/taken.">state</a>(<a class="code" href="classdds_1_1sub_1_1status_1_1DataState.html#ad14326c8d3ac460590b8af2dcb1479c7" title="Create a DataState with InstanceState::alive(), ViewState::new_view(), and SampleState::any()">status::DataState::new_instance</a>())</div>
<div class="line">           &gt;&gt; <a class="code" href="namespacedds_1_1sub.html#ac4d145c43ac533759c58c636516b9a6f" title="Stream manipulator to set a Query to use during the subsequent read/take operation.">content</a>(<a class="code" href="classdds_1_1sub_1_1Query.html" title="&lt;&lt;value-type&gt;&gt; Encapsulates a query for a dds::sub::cond::QueryCondition.">Query</a>(reader, <span class="stringliteral">&quot;x &gt; 10&quot;</span>))</div>
<div class="line">           &gt;&gt; <a class="code" href="namespacedds_1_1sub.html#a05cb12111b9dcf0ba24c82909da3e048" title="Stream manipulator to specify the instance whose samples should be read or taken.">instance</a>(my_instance_handle)</div>
<div class="line">           &gt;&gt; samples; <span class="comment">// and finally, the destination LoanedSamples container.</span></div>
<div class="line"></div>
</div><!-- fragment --> </li>
</ul>
<h2><a class="anchor" id="DDSReaderExampleModule_coherent_access"></a>
Reading samples using coherent access</h2>
<p>If a Subscriber's PresentationQosPolicy access_scope is GROUP and ordered_access is true, the application can access the samples in order across DataWriters of the same group (Publisher with access_scope GROUP). The queue is ordered/sorted per topic across all instances belonging to DataWriters (or DataReaders) within the same Publisher (or Subscriber).</p>
<ul>
<li>Read samples using CoherentAccess <div class="fragment"><div class="line"><span class="keywordtype">void</span> howto_read_coherently()</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="classdds_1_1domain_1_1DomainParticipant.html" title="&lt;&lt;reference-type&gt;&gt; Container for all dds::core::Entity objects.">dds::domain::DomainParticipant</a> participant(0);</div>
<div class="line">    <a class="code" href="classdds_1_1topic_1_1Topic.html" title="&lt;&lt;reference-type&gt;&gt; Topic is the most basic description of the data to be published and subscribed...">dds::topic::Topic&lt;Foo&gt;</a> topic1(participant, <span class="stringliteral">&quot;Topic1&quot;</span>);</div>
<div class="line">    <a class="code" href="classdds_1_1topic_1_1Topic.html" title="&lt;&lt;reference-type&gt;&gt; Topic is the most basic description of the data to be published and subscribed...">dds::topic::Topic&lt;Foo&gt;</a> topic2(participant, <span class="stringliteral">&quot;Topic2&quot;</span>);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Create a Subscriber with group presentation. The Publisher must also</span></div>
<div class="line">    <span class="comment">// have group presentation set in its QoS</span></div>
<div class="line">    <a class="code" href="classdds_1_1sub_1_1qos_1_1SubscriberQos.html" title="&lt;&lt;value-type&gt;&gt; Container of the QoS policies that a dds::sub::Subscriber supports">dds::sub::qos::SubscriberQos</a> subscriber_qos;</div>
<div class="line">    subscriber_qos &lt;&lt; <a class="code" href="classdds_1_1core_1_1policy_1_1Presentation.html#ae7b921188ba102d9e59f8d1973a76d62" title="Creates a Presentation instnace with group access scope.">dds::core::policy::Presentation::GroupAccessScope</a>(<span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line">    <a class="code" href="classdds_1_1sub_1_1Subscriber.html" title="&lt;&lt;reference-type&gt;&gt; A subscriber is the object responsible for actually receiving data from a subscrip...">dds::sub::Subscriber</a> subscriber(participant, subscriber_qos);</div>
<div class="line"></div>
<div class="line">    <a class="code" href="classdds_1_1sub_1_1DataReader.html" title="&lt;&lt;reference-type&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">dds::sub::DataReader&lt;Foo&gt;</a> reader1(subscriber, topic1);</div>
<div class="line">    <a class="code" href="classdds_1_1sub_1_1DataReader.html" title="&lt;&lt;reference-type&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">dds::sub::DataReader&lt;Foo&gt;</a> reader2(subscriber, topic2);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Assuming that a writer of &quot;Topic1&quot; wrote before the writer of &quot;Topic2&quot;</span></div>
<div class="line">    <span class="comment">// reader2 will only be able to access it&#39;s samples after reader1 takes </span></div>
<div class="line">    <span class="comment">// its sample as long as CoherentAccess to the samples has been started</span></div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">int</span> sample_count = read_coherently(subscriber, reader2);</div>
<div class="line">    std::cout &lt;&lt; sample_count &lt;&lt; std::endl; <span class="comment">// will be 0</span></div>
<div class="line"></div>
<div class="line">    <span class="comment">// The CoherentAccess destructor called when read_coherently exited </span></div>
<div class="line">    <span class="comment">// will end coherent access to the samples. </span></div>
<div class="line">    <span class="comment">// You can also explicitly call coherent_access.end() to end coherent access</span></div>
<div class="line"></div>
<div class="line">    <span class="comment">// reader2 can now access its sample </span></div>
<div class="line">    <span class="comment">// ordered_samples.size() will = 1 </span></div>
<div class="line">    <a class="code" href="classdds_1_1sub_1_1LoanedSamples.html" title="&lt;&lt;move-only-type&gt;&gt; Provides temporary access to a collection of samples from a DataReader.">dds::sub::LoanedSamples&lt;Foo&gt;</a> ordered_samples = reader2.take();</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><span class="keywordtype">int</span> read_coherently(<a class="code" href="classdds_1_1sub_1_1Subscriber.html" title="&lt;&lt;reference-type&gt;&gt; A subscriber is the object responsible for actually receiving data from a subscrip...">dds::sub::Subscriber</a>&amp; subscriber, <a class="code" href="classdds_1_1sub_1_1DataReader.html" title="&lt;&lt;reference-type&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">dds::sub::DataReader&lt;T&gt;</a>&amp; reader)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="classdds_1_1sub_1_1CoherentAccess.html" title="&lt;&lt;value-type&gt;&gt; Controls whether RTI Connext will preserve the groupings of changes made by the publis...">dds::sub::CoherentAccess</a> coherent_access(subscriber);</div>
<div class="line"></div>
<div class="line">    <a class="code" href="classdds_1_1sub_1_1LoanedSamples.html" title="&lt;&lt;move-only-type&gt;&gt; Provides temporary access to a collection of samples from a DataReader.">dds::sub::LoanedSamples&lt;T&gt;</a> ordered_samples = reader.<a class="code" href="classdds_1_1sub_1_1DataReader.html#aa63c8e102e4abd5446198bcfe71ebfe1" title="Take all samples using the default filter state.">take</a>();</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> ordered_samples.<a class="code" href="classdds_1_1sub_1_1LoanedSamples.html#a5b2068d3ff02a2099070acfda874e10c" title="Gets the number of samples in this collection.">length</a>();</div>
<div class="line">}</div>
</div><!-- fragment --> </li>
</ul>
<h1><a class="anchor" id="DDSReaderExampleModule_listeners"></a>
DataReader Listeners</h1>
<ul>
<li>Implementing a DataReaderListener class <div class="fragment"><div class="line"><span class="comment">// To create a DataReaderListener, inherit from the NoOpDataReaderListener class</span></div>
<div class="line"><span class="comment">// and then override any of the listener callback functions </span></div>
<div class="line"><span class="keyword">class </span>ExampleDataReaderListener : <span class="keyword">public</span> <a class="code" href="classdds_1_1sub_1_1NoOpDataReaderListener.html" title="A convenience implementation of DataReaderListener where all methods are overridden to do nothing...">dds::sub::NoOpDataReaderListener</a>&lt;Foo&gt;</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    ExampleDataReaderListener() {}</div>
<div class="line"></div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="classdds_1_1sub_1_1NoOpDataReaderListener.html#a2fd4f83fbd0251b4beefb9d20c9347c1" title="No-op.">on_sample_lost</a>(</div>
<div class="line">       <a class="code" href="classdds_1_1sub_1_1DataReader.html" title="&lt;&lt;reference-type&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">dds::sub::DataReader&lt;Foo&gt;</a>&amp;,</div>
<div class="line">       <span class="keyword">const</span> <a class="code" href="classdds_1_1core_1_1status_1_1SampleLostStatus.html" title="Information about the status dds::core::status::StatusMask::sample_lost()">dds::core::status::SampleLostStatus</a> &amp;status)</div>
<div class="line">    {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;on_sample_lost callback&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Access information from the status</span></div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;total_count = &quot;</span> &lt;&lt; status.<a class="code" href="classdds_1_1core_1_1status_1_1SampleLostStatus.html#a2603c11deb3eea24305a028343700331" title="Total cumulative count of all samples lost across all instances of data published under the dds::topi...">total_count</a>() &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;total_count_change = &quot;</span> &lt;&lt; status.<a class="code" href="classdds_1_1core_1_1status_1_1SampleLostStatus.html#a08c7e46c64c68664a428934607f325b0" title="The incremental number of samples lost since the last time the listener was called or the status was ...">total_count_change</a>() &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="classdds_1_1sub_1_1NoOpDataReaderListener.html#a1986471b11eeb6231638985aab7a3a55" title="No-op.">on_subscription_matched</a>(</div>
<div class="line">       <a class="code" href="classdds_1_1sub_1_1DataReader.html" title="&lt;&lt;reference-type&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">dds::sub::DataReader&lt;Foo&gt;</a>&amp;,</div>
<div class="line">       <span class="keyword">const</span> <a class="code" href="classdds_1_1core_1_1status_1_1SubscriptionMatchedStatus.html" title="Information about the status dds::core::status::StatusMask::subscription_matched()">dds::core::status::SubscriptionMatchedStatus</a> &amp;status)</div>
<div class="line">    {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;on_subscription_matched callback&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Access information from the status</span></div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;total_count = &quot;</span> &lt;&lt; status.<a class="code" href="classdds_1_1core_1_1status_1_1SubscriptionMatchedStatus.html#a1574114f210159f920d4e01c3d19c7da" title="The total cumulative number of times the concerned dds::sub::DataReader discovered a &quot;match&quot; with a d...">total_count</a>() &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;total_count_change = &quot;</span> &lt;&lt; status.<a class="code" href="classdds_1_1core_1_1status_1_1SubscriptionMatchedStatus.html#a2d5b7d83083f22a9b68d24b3f26b1f62" title="The change in total_count since the last time the listener was called or the status was read...">total_count_change</a>() &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;current_count = &quot;</span> &lt;&lt; status.<a class="code" href="classdds_1_1core_1_1status_1_1SubscriptionMatchedStatus.html#a75118f159404985a8957356b2900c328" title="The current number of writers with which the dds::sub::DataReader is matched.">current_count</a>() &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;current_count_change = &quot;</span> &lt;&lt; status.<a class="code" href="classdds_1_1core_1_1status_1_1SubscriptionMatchedStatus.html#a9f5a5a38046969b7e1a5d18d57b8e785" title="The change in current_count since the last time the listener was called or the status was read...">current_count_change</a>() &lt;&lt; std::endl;</div>
<div class="line"></div>
<div class="line">        <a class="code" href="classdds_1_1core_1_1InstanceHandle.html" title="&lt;&lt;value-type&gt;&gt; Handle to identiy different instances of the same dds::topic::Topic of a certain type...">dds::core::InstanceHandle</a> handle = status.<a class="code" href="classdds_1_1core_1_1status_1_1SubscriptionMatchedStatus.html#aba0d845710edaddb295e647f31f3bb56" title="A handle to the last dds::pub::DataWriter that caused the status to change.">last_publication_handle</a>();</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Extension</span></div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;current_count_peak = &quot;</span> &lt;&lt; status-&gt;<a class="code" href="classdds_1_1core_1_1status_1_1SubscriptionMatchedStatus.html#a7fece4403aabe3ad8917e2e058da8407" title="&lt;&lt;extension&gt;&gt; The highest value that current_count has reached until now.">current_count_peak</a>() &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="classdds_1_1sub_1_1NoOpDataReaderListener.html#aedda24be5eee8b86d4857ea13a96bc57" title="No-op.">on_sample_rejected</a>(</div>
<div class="line">       <a class="code" href="classdds_1_1sub_1_1DataReader.html" title="&lt;&lt;reference-type&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">dds::sub::DataReader&lt;Foo&gt;</a>&amp;,</div>
<div class="line">       <span class="keyword">const</span> <a class="code" href="classdds_1_1core_1_1status_1_1SampleRejectedStatus.html" title="Information about the status dds::core::status::StatusMask::sample_rejected()">dds::core::status::SampleRejectedStatus</a> &amp;status)</div>
<div class="line">    {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;on_sample_rejected callback&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Access information from the status</span></div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;total_count = &quot;</span> &lt;&lt; status.<a class="code" href="classdds_1_1core_1_1status_1_1SampleRejectedStatus.html#a61a23a0eb7085538718ed4c11f302f3b" title="Total cumulative count of samples rejected by the dds::sub::DataReader.">total_count</a>() &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;total_count_change = &quot;</span> &lt;&lt; status.<a class="code" href="classdds_1_1core_1_1status_1_1SampleRejectedStatus.html#a50f5840648a0e9dce564bbe05ca467ef" title="The incremental number of samples rejected since the last time the listener was called or the status ...">total_count_change</a>() &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;last_reason = &quot;</span> &lt;&lt; status.<a class="code" href="classdds_1_1core_1_1status_1_1SampleRejectedStatus.html#a6a1f913a9d15b7f11c796c10c1a9ab93" title="Reason for rejecting the last sample rejected.">last_reason</a>() &lt;&lt; std::endl;</div>
<div class="line"></div>
<div class="line">        <a class="code" href="classdds_1_1core_1_1InstanceHandle.html" title="&lt;&lt;value-type&gt;&gt; Handle to identiy different instances of the same dds::topic::Topic of a certain type...">dds::core::InstanceHandle</a> handle = status.<a class="code" href="classdds_1_1core_1_1status_1_1SampleRejectedStatus.html#a83be2857a7683c950f92655cfdfab069" title="Handle to the instance being updated by the last sample that was rejected.">last_instance_handle</a>();</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="classdds_1_1sub_1_1NoOpDataReaderListener.html#aa2f8a241383dce30dff38d958fb492c2" title="No-op.">on_requested_incompatible_qos</a>(</div>
<div class="line">       <a class="code" href="classdds_1_1sub_1_1DataReader.html" title="&lt;&lt;reference-type&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">dds::sub::DataReader&lt;Foo&gt;</a>&amp;,</div>
<div class="line">       <span class="keyword">const</span> <a class="code" href="classdds_1_1core_1_1status_1_1RequestedIncompatibleQosStatus.html" title="Information about the status dds::core::status::StatusMask::requested_incompatible_qos()">dds::core::status::RequestedIncompatibleQosStatus</a> &amp;status)</div>
<div class="line">    {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;on_requested_incompatible_qos callback&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Access information from the status</span></div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;total_count = &quot;</span> &lt;&lt; status.<a class="code" href="classdds_1_1core_1_1status_1_1RequestedIncompatibleQosStatus.html#af6c99458abb994090feb0a3bc000310c" title="Total cumulative count of how many times the concerned dds::sub::DataReader discovered a dds::pub::Da...">total_count</a>() &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;total_count_change = &quot;</span> &lt;&lt; status.<a class="code" href="classdds_1_1core_1_1status_1_1RequestedIncompatibleQosStatus.html#a9ebda4f4535040f6ba66cc7f2d80860f" title="The change in total_count since the last time the listener was called or the status was read...">total_count_change</a>() &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;last_policy_id = &quot;</span> &lt;&lt; status.<a class="code" href="classdds_1_1core_1_1status_1_1RequestedIncompatibleQosStatus.html#ab757d01e3cbeb0dd91cc310a836b4602" title="The PolicyId_t of one of the policies that was found to be incompatible the last time an incompatibil...">last_policy_id</a>() &lt;&lt; std::endl;</div>
<div class="line"></div>
<div class="line">        <a class="code" href="group__DDSQosTypesModule.html#gad94fd9b6d977e7aabc9f65e16330bd97" title="A vector of QosPolicyCount.">dds::core::policy::QosPolicyCountSeq</a> qos_seq = status.<a class="code" href="classdds_1_1core_1_1status_1_1RequestedIncompatibleQosStatus.html#adaa88b19c8c730bc91ec9455f245eba4" title="A list containing, for each policy, the total number of times that the concerned dds::sub::DataReader...">policies</a>();</div>
<div class="line">        <span class="keywordflow">if</span> (qos_seq.size() &gt; 0) {</div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;policy_id of one first incompatible Qos policy = &quot;</span> </div>
<div class="line">                &lt;&lt; qos_seq[0].policy_id() &lt;&lt; std::endl;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="classdds_1_1sub_1_1NoOpDataReaderListener.html#aeb8599b85565dd388b8eb6eaa0098a8e" title="No-op.">on_requested_deadline_missed</a>(</div>
<div class="line">       <a class="code" href="classdds_1_1sub_1_1DataReader.html" title="&lt;&lt;reference-type&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">dds::sub::DataReader&lt;Foo&gt;</a>&amp;,</div>
<div class="line">       <span class="keyword">const</span> <a class="code" href="classdds_1_1core_1_1status_1_1RequestedDeadlineMissedStatus.html" title="Information about the status dds::core::status::StatusMask::requested_deadline_missed()">dds::core::status::RequestedDeadlineMissedStatus</a> &amp;status)</div>
<div class="line">    {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;on_requested_deadline_missed callback&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Access information from the status</span></div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;total_count = &quot;</span> &lt;&lt; status.<a class="code" href="classdds_1_1core_1_1status_1_1RequestedDeadlineMissedStatus.html#a5286e2c22e80c17f0a34f1c25ece266c" title="Total cumulative count of the deadlines detected for any instance read by the dds::sub::DataReader.">total_count</a>() &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;total_count_change = &quot;</span> &lt;&lt; status.<a class="code" href="classdds_1_1core_1_1status_1_1RequestedDeadlineMissedStatus.html#a24d651887ab32342e3dff66b2fe45076" title="The incremental number of deadlines detected since the last time the listener was called or the statu...">total_count_change</a>() &lt;&lt; std::endl;</div>
<div class="line"></div>
<div class="line">        <a class="code" href="classdds_1_1core_1_1InstanceHandle.html" title="&lt;&lt;value-type&gt;&gt; Handle to identiy different instances of the same dds::topic::Topic of a certain type...">dds::core::InstanceHandle</a> handle = status.<a class="code" href="classdds_1_1core_1_1status_1_1RequestedDeadlineMissedStatus.html#ab45a0f7dbeeef8cfd9dc021fcb816b56" title="Handle to the last instance in the dds::sub::DataReader for which a deadline was detected.">last_instance_handle</a>();</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="classdds_1_1sub_1_1NoOpDataReaderListener.html#a9eb0225f7dfda4cf4a88e6af854d91e1" title="No-op.">on_liveliness_changed</a>(</div>
<div class="line">       <a class="code" href="classdds_1_1sub_1_1DataReader.html" title="&lt;&lt;reference-type&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">dds::sub::DataReader&lt;Foo&gt;</a>&amp;,</div>
<div class="line">       <span class="keyword">const</span> <a class="code" href="classdds_1_1core_1_1status_1_1LivelinessChangedStatus.html" title="Information about the status dds::core::status::StatusMask::liveliness_changed()">dds::core::status::LivelinessChangedStatus</a> &amp;status)</div>
<div class="line">    {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;on_liveliness_changed callback&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Access information from the status</span></div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;alive_count = &quot;</span> &lt;&lt; status.<a class="code" href="classdds_1_1core_1_1status_1_1LivelinessChangedStatus.html#ace536747d0c6d141481376e6da263466" title="The total count of currently alive dds::pub::DataWriter entities that write the dds::topic::Topic the...">alive_count</a>() &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;not_alive_count = &quot;</span> &lt;&lt; status.<a class="code" href="classdds_1_1core_1_1status_1_1LivelinessChangedStatus.html#ad9b2149dbace57283bb07e67296aef8f" title="The total count of currently not_alive dds::pub::DataWriter entities that write the dds::topic::Topic...">not_alive_count</a>() &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;alive_count_change = &quot;</span> &lt;&lt; status.<a class="code" href="classdds_1_1core_1_1status_1_1LivelinessChangedStatus.html#a6304c63fec1627eb885366aac3566587" title="The change in the alive_count since the last time the listener was called or the status was read...">alive_count_change</a>() &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;not_alive_count_change = &quot;</span> &lt;&lt; status.<a class="code" href="classdds_1_1core_1_1status_1_1LivelinessChangedStatus.html#ade076013045018c3ae106790139a56bd" title="The change in the not_alive_count since the last time the listener was called or the status was read...">not_alive_count_change</a>() &lt;&lt; std::endl;</div>
<div class="line"></div>
<div class="line">        <a class="code" href="classdds_1_1core_1_1InstanceHandle.html" title="&lt;&lt;value-type&gt;&gt; Handle to identiy different instances of the same dds::topic::Topic of a certain type...">dds::core::InstanceHandle</a> handle = status.<a class="code" href="classdds_1_1core_1_1status_1_1LivelinessChangedStatus.html#a4935d91f945ab19a3305ed5eda377c28" title="An instance handle to the last remote writer to change its liveliness.">last_publication_handle</a>();</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="classdds_1_1sub_1_1NoOpDataReaderListener.html#a2a09dc567b5c5185a34c56e9f7dd0081" title="No-op.">on_data_available</a>(<a class="code" href="classdds_1_1sub_1_1DataReader.html" title="&lt;&lt;reference-type&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">dds::sub::DataReader&lt;Foo&gt;</a> &amp;reader)</div>
<div class="line">    {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;on_data_available callback&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Read the available data</span></div>
<div class="line">        <a class="code" href="classdds_1_1sub_1_1LoanedSamples.html" title="&lt;&lt;move-only-type&gt;&gt; Provides temporary access to a collection of samples from a DataReader.">dds::sub::LoanedSamples&lt;Foo&gt;</a> samples = reader.<a class="code" href="classdds_1_1sub_1_1DataReader.html#a864f65d2246d2f854cf0b892ff6b8631" title="Read all samples using the default filter state.">read</a>();</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Print samples by copying to std::cout</span></div>
<div class="line">        std::copy(</div>
<div class="line">            samples.<a class="code" href="classdds_1_1sub_1_1LoanedSamples.html#a417790627e30ca877a6a556014973227" title="Gets an iterator to the first sample.">begin</a>(),</div>
<div class="line">            samples.<a class="code" href="classdds_1_1sub_1_1LoanedSamples.html#afd989c219c45584247b7715a16927fb6" title="Gets an iterator to one past the last sample.">end</a>(),</div>
<div class="line">            dds::sub::LoanedSamples&lt;Foo&gt;::ostream_iterator(std::cout, <span class="stringliteral">&quot;\n&quot;</span>));</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">};</div>
</div><!-- fragment --><br/>
</li>
<li>Setting a listener on a DataReader <div class="fragment"><div class="line">    <a class="code" href="classdds_1_1domain_1_1DomainParticipant.html" title="&lt;&lt;reference-type&gt;&gt; Container for all dds::core::Entity objects.">dds::domain::DomainParticipant</a> participant(0);</div>
<div class="line">    <a class="code" href="classdds_1_1topic_1_1Topic.html" title="&lt;&lt;reference-type&gt;&gt; Topic is the most basic description of the data to be published and subscribed...">dds::topic::Topic&lt;Foo&gt;</a> topic(participant, <span class="stringliteral">&quot;Topic1&quot;</span>);</div>
<div class="line"></div>
<div class="line">    ExampleDataReaderListener *listener = <span class="keyword">new</span> ExampleDataReaderListener;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Create a DataReader with a listener and default </span></div>
<div class="line">    <span class="comment">// dds::core::status::StatusMask::all()</span></div>
<div class="line">    <a class="code" href="classdds_1_1sub_1_1DataReader.html" title="&lt;&lt;reference-type&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">dds::sub::DataReader&lt;Foo&gt;</a> reader1(</div>
<div class="line">       <a class="code" href="classdds_1_1sub_1_1Subscriber.html" title="&lt;&lt;reference-type&gt;&gt; A subscriber is the object responsible for actually receiving data from a subscrip...">dds::sub::Subscriber</a>(participant), </div>
<div class="line">       topic,</div>
<div class="line">       <a class="code" href="classdds_1_1sub_1_1qos_1_1DataReaderQos.html" title="&lt;&lt;value-type&gt;&gt; Container of the QoS policies that a dds::sub::DataReader supports">dds::sub::qos::DataReaderQos</a>(), </div>
<div class="line">       listener);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Create a DataReader with a null listener</span></div>
<div class="line">    <a class="code" href="classdds_1_1sub_1_1DataReader.html" title="&lt;&lt;reference-type&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">dds::sub::DataReader&lt;Foo&gt;</a> reader2(</div>
<div class="line">       <a class="code" href="classdds_1_1sub_1_1Subscriber.html" title="&lt;&lt;reference-type&gt;&gt; A subscriber is the object responsible for actually receiving data from a subscrip...">dds::sub::Subscriber</a>(participant), topic);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Set the listener for the DataReader after creation</span></div>
<div class="line">    reader2.listener(</div>
<div class="line">       listener, </div>
<div class="line">       <a class="code" href="classdds_1_1core_1_1status_1_1StatusMask.html#aa7251d1ddcd3b612887ed7ed8d038bdd" title="A (received) sample has been rejected.">dds::core::status::StatusMask::sample_rejected</a>());</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Setting a listener on an entity automatically retains the entity so </span></div>
<div class="line">    <span class="comment">// we must explicitly call close() in order for the DataReader to be</span></div>
<div class="line">    <span class="comment">// destroyed </span></div>
<div class="line">    reader1.close();</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Instead of calling close, you can set the DataReader&#39;s listener to null </span></div>
<div class="line">    <span class="comment">// and this will implicitly unretain the DataReader so that it will be </span></div>
<div class="line">    <span class="comment">// destructed once all references to it go out of scope</span></div>
<div class="line">    reader2.listener(NULL, <a class="code" href="classdds_1_1core_1_1status_1_1StatusMask.html#a95ea77cba1230de1b4349c888a0e0ff6" title="No bits are set.">dds::core::status::StatusMask::none</a>());</div>
</div><!-- fragment --><br/>
</li>
<li>The ListenerBinder class will take care of setting the listener and mask for an entity during creation and detaching the listener from the entity when the ListenerBinder is destructed. This is helpful because you will not have to explcitly close the entity or detach the listener yourself in order to teardown the entity <div class="fragment"><div class="line">    <a class="code" href="classdds_1_1domain_1_1DomainParticipant.html" title="&lt;&lt;reference-type&gt;&gt; Container for all dds::core::Entity objects.">dds::domain::DomainParticipant</a> participant(0);</div>
<div class="line">    <a class="code" href="classdds_1_1topic_1_1Topic.html" title="&lt;&lt;reference-type&gt;&gt; Topic is the most basic description of the data to be published and subscribed...">dds::topic::Topic&lt;Foo&gt;</a> topic(participant, <span class="stringliteral">&quot;Topic1&quot;</span>);</div>
<div class="line"></div>
<div class="line">    ExampleDataReaderListener *listener = <span class="keyword">new</span> ExampleDataReaderListener;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Create a DataReader with a null listener</span></div>
<div class="line">    <a class="code" href="classdds_1_1sub_1_1DataReader.html" title="&lt;&lt;reference-type&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">dds::sub::DataReader&lt;Foo&gt;</a> reader(</div>
<div class="line">       <a class="code" href="classdds_1_1sub_1_1Subscriber.html" title="&lt;&lt;reference-type&gt;&gt; A subscriber is the object responsible for actually receiving data from a subscrip...">dds::sub::Subscriber</a>(participant), topic);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Attach the listener to the DataReader after creation using a </span></div>
<div class="line">    <span class="comment">// ListenerBinder (Note: rti/core/ListenerBinder.hpp needs to be included)</span></div>
<div class="line">    <a class="code" href="classrti_1_1core_1_1ListenerBinder.html" title="&lt;&lt;reference-type&gt;&gt; Automatically manages the association of an Entity and a Listener">rti::core::ListenerBinder&lt;dds::sub::DataReader&lt;Foo&gt;</a> &gt; scoped_listener =</div>
<div class="line">        <a class="code" href="namespacerti_1_1core.html#a836945e1beb8629a0724d5a98576f372" title="Creates a ListenerBinder that automatically resets the listener when all references go out of scope...">rti::core::bind_listener</a>(</div>
<div class="line">           reader,</div>
<div class="line">           listener,</div>
<div class="line">           <a class="code" href="classdds_1_1core_1_1status_1_1StatusMask.html#a364150c79c3d9a3d1a602ad4467a246d" title="A sample has been lost (i.e. was never received).">dds::core::status::StatusMask::sample_lost</a>());</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Now there is no need to explicitly call close on the DataReader or set</span></div>
<div class="line">    <span class="comment">// the listener to null</span></div>
</div><!-- fragment --> </li>
</ul>
<h1><a class="anchor" id="DDSReaderExampleModule_lookup"></a>
Looking up DataReaders</h1>
<ul>
<li>Lookup DataReaders by topic name <div class="fragment"><div class="line">    <a class="code" href="classdds_1_1domain_1_1DomainParticipant.html" title="&lt;&lt;reference-type&gt;&gt; Container for all dds::core::Entity objects.">dds::domain::DomainParticipant</a> participant(0);</div>
<div class="line">    <a class="code" href="classdds_1_1sub_1_1Subscriber.html" title="&lt;&lt;reference-type&gt;&gt; A subscriber is the object responsible for actually receiving data from a subscrip...">dds::sub::Subscriber</a> subscriber(participant);</div>
<div class="line"></div>
<div class="line">    <a class="code" href="classdds_1_1topic_1_1Topic.html" title="&lt;&lt;reference-type&gt;&gt; Topic is the most basic description of the data to be published and subscribed...">dds::topic::Topic&lt;Foo&gt;</a> topic1(participant, <span class="stringliteral">&quot;Topic1&quot;</span>);</div>
<div class="line">    <a class="code" href="classdds_1_1topic_1_1Topic.html" title="&lt;&lt;reference-type&gt;&gt; Topic is the most basic description of the data to be published and subscribed...">dds::topic::Topic&lt;Foo&gt;</a> topic2(participant, <span class="stringliteral">&quot;Topic2&quot;</span>);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Create three DataReaders for topic1 and one for topic2 and retain them</span></div>
<div class="line">    create_and_retain_reader(subscriber, topic1);</div>
<div class="line">    create_and_retain_reader(subscriber, topic1);</div>
<div class="line">    create_and_retain_reader(subscriber, topic2);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// We don&#39;t have any references to the created DataReaders but we can look </span></div>
<div class="line">    <span class="comment">// them up using the subscriber and topic name that they were created with</span></div>
<div class="line">    std::vector&lt;dds::sub::DataReader&lt;Foo&gt; &gt; readers;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// reader_count will equal 1. If more than one DataReader belongs to a </span></div>
<div class="line">    <span class="comment">// subscriber with the same topic name then find may return any one of them</span></div>
<div class="line">    <span class="keywordtype">int</span> reader_count = </div>
<div class="line">        dds::sub::find&lt;dds::sub::DataReader&lt;Foo&gt; &gt;(</div>
<div class="line">           subscriber, </div>
<div class="line">           <span class="stringliteral">&quot;Topic1&quot;</span>, </div>
<div class="line">           std::back_inserter(readers));</div>
<div class="line"></div>
<div class="line">    reader_count = </div>
<div class="line">        dds::sub::find&lt;dds::sub::DataReader&lt;Foo&gt; &gt;(</div>
<div class="line">           subscriber, </div>
<div class="line">           <span class="stringliteral">&quot;Topic2&quot;</span>, </div>
<div class="line">           std::back_inserter(readers));</div>
<div class="line"></div>
</div><!-- fragment --> </li>
</ul>
<h1><a class="anchor" id="DDSReaderExampleModule_matched_publications"></a>
Getting Matched Publications</h1>
<ul>
<li>Lookup a DataReader's matched publications <div class="fragment"><div class="line">    <a class="code" href="classdds_1_1domain_1_1DomainParticipant.html" title="&lt;&lt;reference-type&gt;&gt; Container for all dds::core::Entity objects.">dds::domain::DomainParticipant</a> participant(0);</div>
<div class="line">    <a class="code" href="classdds_1_1topic_1_1Topic.html" title="&lt;&lt;reference-type&gt;&gt; Topic is the most basic description of the data to be published and subscribed...">dds::topic::Topic&lt;Foo&gt;</a> topic(participant, <span class="stringliteral">&quot;Topic1&quot;</span>);</div>
<div class="line">    <a class="code" href="classdds_1_1sub_1_1DataReader.html" title="&lt;&lt;reference-type&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">dds::sub::DataReader&lt;Foo&gt;</a> reader(<a class="code" href="classdds_1_1sub_1_1Subscriber.html" title="&lt;&lt;reference-type&gt;&gt; A subscriber is the object responsible for actually receiving data from a subscrip...">dds::sub::Subscriber</a>(participant), topic);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Create two writers that will match with the above reader</span></div>
<div class="line">    <a class="code" href="classdds_1_1pub_1_1DataWriter.html" title="&lt;&lt;reference-type&gt;&gt; Allows an application to publish data for a dds::topic::Topic">dds::pub::DataWriter&lt;Foo&gt;</a> writer1(<a class="code" href="classdds_1_1pub_1_1Publisher.html" title="&lt;&lt;reference-type&gt;&gt; A publisher is the object responsible for the actual dissemination of publications...">dds::pub::Publisher</a>(participant), topic);</div>
<div class="line">    <a class="code" href="classdds_1_1pub_1_1DataWriter.html" title="&lt;&lt;reference-type&gt;&gt; Allows an application to publish data for a dds::topic::Topic">dds::pub::DataWriter&lt;Foo&gt;</a> writer2(<a class="code" href="classdds_1_1pub_1_1Publisher.html" title="&lt;&lt;reference-type&gt;&gt; A publisher is the object responsible for the actual dissemination of publications...">dds::pub::Publisher</a>(participant), topic);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Get a list of the InstanceHandles corresponding to the DataReader&#39;s </span></div>
<div class="line">    <span class="comment">// matched publications.</span></div>
<div class="line">    <a class="code" href="namespacedds_1_1core.html#a9091ea7961b3e0629207fde8f4737341" title="A sequence of dds::core::InstanceHandle.">dds::core::InstanceHandleSeq</a> publication_handles1 = </div>
<div class="line">        <a class="code" href="namespacedds_1_1sub.html#a7c4dc52d235b3a6be17de6627919297e" title="Retrieve the list of publications currently &quot;associated&quot; with a DataReader.">dds::sub::matched_publications</a>(reader);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// matched_publications also takes in an iterator range and will return</span></div>
<div class="line">    <span class="comment">// an InstanceHandle iterator to the end of the InstanceHandleSeq</span></div>
<div class="line">    <a class="code" href="namespacedds_1_1core.html#a9091ea7961b3e0629207fde8f4737341" title="A sequence of dds::core::InstanceHandle.">dds::core::InstanceHandleSeq</a> publication_handles2(2, <a class="code" href="group__DDSCPP2SupportingTypes.html#ga22c3217bb51dfe3db2887417da74d917" title="Indicates an empty reference.">dds::core::null</a>);</div>
<div class="line"></div>
<div class="line">    dds::core::InstanceHandleSeq::iterator last = </div>
<div class="line">        <a class="code" href="namespacedds_1_1sub.html#a7c4dc52d235b3a6be17de6627919297e" title="Retrieve the list of publications currently &quot;associated&quot; with a DataReader.">dds::sub::matched_publications</a>(</div>
<div class="line">           reader, </div>
<div class="line">           publication_handles2.begin(), </div>
<div class="line">           publication_handles2.end());</div>
<div class="line"></div>
<div class="line">    <span class="comment">// now last == publication_handles2.end()</span></div>
</div><!-- fragment --><br/>
</li>
<li>Use the InstanceHandles obtained from <a class="el" href="classdds_1_1sub_1_1DataReader.html#a7c4dc52d235b3a6be17de6627919297e" title="Retrieve the list of publications currently &quot;associated&quot; with a DataReader.">matched_publications()</a> to get the PublicationBuiltinTopicData for the publications <div class="fragment"><div class="line">    <a class="code" href="classdds_1_1topic_1_1PublicationBuiltinTopicData.html" title="Entry created when a dds::pub::DataWriter is discovered in association with its dds::pub::Publisher.">dds::topic::PublicationBuiltinTopicData</a> publication_data =</div>
<div class="line">        <a class="code" href="namespacedds_1_1sub.html#a62195eaf0aa94ab4ada984966c3ac7eb" title="This operation retrieves the information on a publication that is currently &quot;associated&quot; with the Dat...">dds::sub::matched_publication_data</a>(reader, publication_handles1[0]);</div>
</div><!-- fragment --> </li>
</ul>
<h1><a class="anchor" id="DDSReaderExampleModule_builtin_readers"></a>
Accessing the Built-in Subscriber and DataReaders</h1>
<ul>
<li>The next two examples assume the following setup <div class="fragment"><div class="line">    <span class="comment">// It is common to create entities disbaled when accessing and setting </span></div>
<div class="line">    <span class="comment">// listeners on the built-in DataReaders so that information about</span></div>
<div class="line">    <span class="comment">// discovery traffic is missed</span></div>
<div class="line">    <a class="code" href="classdds_1_1domain_1_1qos_1_1DomainParticipantFactoryQos.html" title="&lt;&lt;value-type&gt;&gt; Container of the QoS policies that do not apply to a specific entity">dds::domain::qos::DomainParticipantFactoryQos</a> qos;</div>
<div class="line">    qos &lt;&lt; <a class="code" href="classdds_1_1core_1_1policy_1_1EntityFactory.html" title="Configures an dds::core::Entity that acts as factory of other entities.">dds::core::policy::EntityFactory</a>(<span class="keyword">false</span>);</div>
<div class="line">    <a class="code" href="classdds_1_1domain_1_1DomainParticipant.html#a9182f1aeded8c3d9070ed3c2a1a17bfc" title="Get the current dds::domain::qos::DomainParticipantFactoryQos.">dds::domain::DomainParticipant::participant_factory_qos</a>(qos);</div>
<div class="line"></div>
<div class="line">    <a class="code" href="classdds_1_1domain_1_1DomainParticipant.html" title="&lt;&lt;reference-type&gt;&gt; Container for all dds::core::Entity objects.">dds::domain::DomainParticipant</a> participant(0);</div>
</div><!-- fragment --><br/>
</li>
<li>Access the built-in Subscriber <div class="fragment"><div class="line">    <a class="code" href="classdds_1_1sub_1_1Subscriber.html" title="&lt;&lt;reference-type&gt;&gt; A subscriber is the object responsible for actually receiving data from a subscrip...">dds::sub::Subscriber</a> <a class="code" href="classdds_1_1sub_1_1Subscriber.html#aec280a7aabcebc868a80b4fadbda86ba" title="Access the built-in Subscriber.">builtin_subscriber</a> = <a class="code" href="namespacedds_1_1sub.html#aec280a7aabcebc868a80b4fadbda86ba" title="Access the built-in Subscriber.">dds::sub::builtin_subscriber</a>(participant);</div>
</div><!-- fragment --><br/>
</li>
<li>Access the built-in DataReaders <div class="fragment"><div class="line">    <span class="comment">// There are constants for each of the built-in topics accessible through</span></div>
<div class="line">    <span class="comment">// the dds::topic namespace--see below for their use</span></div>
<div class="line"></div>
<div class="line">    <span class="comment">// Access the built-in DataReader for ParticipantBuiltinTopicData </span></div>
<div class="line">    std::vector&lt;dds::sub::DataReader&lt;dds::topic::ParticipantBuiltinTopicData&gt; &gt; participant_reader;</div>
<div class="line">    <span class="keywordtype">int</span> reader_count = </div>
<div class="line">        dds::sub::find&lt;dds::sub::DataReader&lt;dds::topic::ParticipantBuiltinTopicData&gt; &gt;(</div>
<div class="line">           <a class="code" href="classdds_1_1sub_1_1Subscriber.html#aec280a7aabcebc868a80b4fadbda86ba" title="Access the built-in Subscriber.">builtin_subscriber</a>, </div>
<div class="line">           <a class="code" href="group__DDSParticipantBuiltInTopicModule.html#ga7fec452b46f2dad47e00d10b53c9bc32" title="Participant builtin topic name.">dds::topic::participant_topic_name</a>(),</div>
<div class="line">           std::back_inserter(participant_reader));</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Access the built-in DataReader for PublicationBuiltinTopicData </span></div>
<div class="line">    std::vector&lt;dds::sub::DataReader&lt;dds::topic::PublicationBuiltinTopicData&gt; &gt; publication_reader;</div>
<div class="line">    reader_count = </div>
<div class="line">        dds::sub::find&lt;dds::sub::DataReader&lt;dds::topic::PublicationBuiltinTopicData&gt; &gt;(</div>
<div class="line">           <a class="code" href="classdds_1_1sub_1_1Subscriber.html#aec280a7aabcebc868a80b4fadbda86ba" title="Access the built-in Subscriber.">builtin_subscriber</a>, </div>
<div class="line">           <a class="code" href="group__DDSPublicationBuiltInTopicModule.html#ga361f4a40ddaaba2f1b5f963f92ca9121" title="Publication topic name.">dds::topic::publication_topic_name</a>(),</div>
<div class="line">           std::back_inserter(publication_reader));</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Access the built-in DataReader for SubscriptionBuiltinTopicData </span></div>
<div class="line">    std::vector&lt;dds::sub::DataReader&lt;dds::topic::SubscriptionBuiltinTopicData&gt; &gt; subscription_reader;</div>
<div class="line">    reader_count = </div>
<div class="line">        dds::sub::find&lt;dds::sub::DataReader&lt;dds::topic::SubscriptionBuiltinTopicData&gt; &gt;(</div>
<div class="line">           <a class="code" href="classdds_1_1sub_1_1Subscriber.html#aec280a7aabcebc868a80b4fadbda86ba" title="Access the built-in Subscriber.">builtin_subscriber</a>, </div>
<div class="line">           <a class="code" href="group__DDSSubscriptionBuiltInTopicModule.html#ga0421bff6abf9f32307fd02dc6b4ef2e5" title="Subscription topic name.">dds::topic::subscription_topic_name</a>(),</div>
<div class="line">           std::back_inserter(subscription_reader));</div>
<div class="line"></div>
<div class="line">    <span class="comment">// participant_reader[0], publication_reader[0] and subscription_reader[0]</span></div>
<div class="line">    <span class="comment">// will now hold reference to the built-in DataReaders. </span></div>
</div><!-- fragment --> </li>
</ul>
<h1><a class="anchor" id="DDSReaderExampleModule_any_reader"></a>
Using untyped DataReaders</h1>
<p>When you want to hold a reference to a DataReader and the type T doesn't matter, you can use the class <code><a class="el" href="classdds_1_1sub_1_1AnyDataReader.html" title="&lt;&lt;reference-type&gt;&gt; This class provides an non-template holder for representing a DataReader of any ty...">dds::sub::AnyDataReader</a></code>, which provides type-independent methods. <br/>
 <br/>
</p>
<ul>
<li>For example, this function receives any DataReader <div class="fragment"><div class="line"><span class="comment">// This function can receive any DataReader, independently of the template types</span></div>
<div class="line"><span class="keywordtype">void</span> example_untyped(<span class="keyword">const</span> <a class="code" href="classdds_1_1sub_1_1AnyDataReader.html" title="&lt;&lt;reference-type&gt;&gt; This class provides an non-template holder for representing a DataReader of any ty...">dds::sub::AnyDataReader</a>&amp; untyped_reader)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Use type-independent operations</span></div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;The topic name is: &quot;</span> &lt;&lt; untyped_reader.<a class="code" href="classdds_1_1sub_1_1AnyDataReader.html#ac512edf4410a021788e3062daa76c601" title="Get the topic name for this AnyDataReader.">topic_name</a>() &lt;&lt; std::endl;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (untyped_reader.<a class="code" href="classdds_1_1sub_1_1AnyDataReader.html#aa718d49901ad417588c114a86e9a92b7" title="Get the type name for this AnyDataReader.">type_name</a>() == <span class="stringliteral">&quot;Foo&quot;</span>) {</div>
<div class="line">        <span class="comment">// Get back the typed DataReader.</span></div>
<div class="line">        <span class="comment">//</span></div>
<div class="line">        <span class="comment">// If the reader&#39;s type is not Foo, this operation throws</span></div>
<div class="line">        <span class="comment">// dds::core::InvalidDowncastError.</span></div>
<div class="line">        <span class="comment">//</span></div>
<div class="line">        <span class="comment">// typed_reader and untyped_reader share references to the same object.</span></div>
<div class="line">        <a class="code" href="classdds_1_1sub_1_1DataReader.html" title="&lt;&lt;reference-type&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">dds::sub::DataReader&lt;Foo&gt;</a> typed_reader = untyped_reader.<a class="code" href="classdds_1_1sub_1_1AnyDataReader.html#a500f1daa69b12d6165a24d4c3d99cc97" title="Gets the typed DataReader from this AnyDataReader.">get</a>&lt;<a class="code" href="classFoo.html" title="A hypothetical topic-type.">Foo</a>&gt;();</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><br/>
</li>
<li>And this is how you can call it <div class="fragment"><div class="line">    <a class="code" href="classdds_1_1sub_1_1DataReader.html" title="&lt;&lt;reference-type&gt;&gt; Allows the application to: (1) declare the data it wishes to receive (i...">dds::sub::DataReader&lt;Foo&gt;</a> reader(subscriber, topic);</div>
<div class="line">    example_untyped(reader); <span class="comment">// automatic conversion to AnyDataReader</span></div>
</div><!-- fragment --> </li>
</ul>
<h1><a class="anchor" id="DDSReaderExampleModule_reader_teardown"></a>
Tearing down a DataReader</h1>
<ul>
<li>See <a class="el" href="group__DDSEntityExampleModuleForCpp2.html#DDSEntityExampleModule_teardown">Tearing Down An Entity</a> for examples of the various ways to teardown a DataReader </li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<HR>
<IMG SRC="rti_logo.gif" height="16">
<A HREF="main.html">RTI Connext Modern C++ API Version 5.2.3</A>
Copyright &copy; Wed Apr 27 2016 
<A HREF="http://www.rti.com">Real-Time Innovations, Inc</A>
</BODY>
</HTML>
