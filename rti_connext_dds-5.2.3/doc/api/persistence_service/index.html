<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>RTI Persistence Service: RTI Persistence Service for RTI Connext Messaging</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">RTI Persistence Service
   &#160;<span id="projectnumber">Version 5.2.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2-20120808 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">RTI Persistence Service for RTI Connext Messaging </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="image">
<img src="rti_logo.gif" alt="rti_logo.gif"/>
</div>
 <center><a href="http://www.rti.com">Real-Time Innovations, Inc.</a></center><h1><a class="anchor" id="document"></a>
Available Documentation</h1>
<p>This document contains: </p>
<ul>
<li><a class="el" href="index.html#overview">Overview</a> </li>
<li><a class="el" href="index.html#usage">Using RTI Persistence Service</a> </li>
<li><a class="el" href="index.html#running">Running RTI Persistence Service</a> </li>
<li><a class="el" href="index.html#persistence_library">Using the RTI Persistence Service library</a></li>
</ul>
<p>For additional information, please see the following PDF documents:</p>
<ul>
<li><b><a href="../../manuals/persistence_service/RTI_Persistence_Service_ReleaseNotes.pdf" target="_blank">RTI Persistence Service Release Notes</a>.</b></li>
<li><b><a href="../../manuals/connext_dds/RTI_ConnextDDS_CoreLibraries_UsersManual.pdf" target="_blank">Core Libraries and Utilities User's Manual</a></b></li>
</ul>
<p>Please do not hesitate to contact RTI with questions or comments about this release. We welcome any input on how to improve RTI Persistence Service to suit your needs.</p>
<p><br/>
</p>
<h1><a class="anchor" id="overview"></a>
Overview</h1>
<p>RTI Persistence Service is an optional package that saves data samples so that they can be delivered to subscribing applications that join the system at a later time &ndash; even if the publishing application has already terminated.</p>
<p>RTI Persistence Service runs as a separate application; you can run it on the same node as the publishing application, the subscribing application, or some other node in the network.</p>
<p>When configured to run in PERSISTENT mode, RTI Persistence Service can use the filesystem or a relational database that provides an ODBC driver. For each persistent topic, it collects all the data written by the corresponding persistent DataWriters and stores them into persistent storage.</p>
<p>Refer to the <b><a href="../../manuals/persistence_service/RTI_Persistence_Service_ReleaseNotes.pdf" target="_blank">RTI Persistence Service Release Notes</a></b> for the list of supported relational databases.</p>
<p>When configured to run in TRANSIENT mode, RTI Persistence Service stores the data in memory.</p>
<p><br/>
</p>
<h1><a class="anchor" id="usage"></a>
Using RTI Persistence Service</h1>
<p>To use RTI Persistence Service in your RTI Connext Messaging application, you need to modify the <b>DURABILITY QosPolicy</b> of the DataReader and/or DataWriter. You may optionally modify the <b>DURABILITY_SERVICE QosPolicy</b>, which can be used to configure RTI Persistence Service.</p>
<p>For more information, please see the <b><a href="../../manuals/connext_dds/RTI_ConnextDDS_CoreLibraries_UsersManual.pdf" target="_blank">Core Libraries and Utilities User's Manual</a></b>.</p>
<p><br/>
</p>
<h1><a class="anchor" id="running"></a>
Running RTI Persistence Service</h1>
<p>You can run RTI Persistence Service on any node in the network; it does not have to be run on the same node as the publishing or subscribing applications for which it is saving/delivering data. If you run RTI Persistence Service on a separate node, however, make sure that the other applications can find it during the discovery process &ndash; that is, it must be in one of the <b>NDDS_DISCOVERY_PEERS</b> lists.</p>
<p>A script to run the RTI Persistence Service executable is located in <b>&lt;NDDSHOME&gt;/resource/xml/NDDS_QOS_PROFILES.xml</b> File specified in NDDS_QOS_PROFILES Environment Variable &lt;working directory&gt;/USER_QOS_PROFILES.xml </p>
<p>The next locations are specific to RTI Persistence Service:</p>
<ul>
<li>
&lt;NDDSHOME&gt;/resource/xml/RTI_PERSISTENCE_SERVICE.xml </li>
<li>
&lt;working directory&gt;/USER_PERSISTENCE_SERVICE.xml </li>
<li>
File specified using the command line option, -cfgFile </li>
</ul>
<p><br/>
</p>
<h2><a class="anchor" id="xml_file"></a>
XML Configuration File</h2>
<p>The configuration file uses XML format. Let's look at a very basic configuration file, just to get an idea of its contents. You will learn the meaning of each line as you read the rest of this section:</p>
<p><b>Example Configuration File</b></p>
<pre class="fragment">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
&lt;!-- A Configuration file may be used by several 
     persistence services specifying multiple 
         &lt;persistence_service&gt; entries 
--&gt;

&lt;dds&gt;
    &lt;!-- QoS LIBRARY SECTION --&gt;
    &lt;qos_library name="QosLib1"&gt;
        &lt;qos_profile name="QosProfile1"&gt;
            &lt;datawriter_qos name="WriterQos1"&gt;
                &lt;history&gt;
                    &lt;kind&gt;DDS_KEEP_ALL_HISTORY_QOS&lt;/kind&gt;
                &lt;/history&gt;
            &lt;/datawriter_qos&gt;
            &lt;datareader_qos name="ReaderQos1"&gt;
                &lt;reliability&gt;
                    &lt;kind&gt;DDS_RELIABLE_RELIABILITY_QOS&lt;/kind&gt;
                &lt;/reliability&gt;
                &lt;history&gt;
                    &lt;kind&gt;DDS_KEEP_ALL_HISTORY_QOS&lt;/kind&gt;
                &lt;/history&gt;
            &lt;/datareader_qos&gt;
        &lt;/qos_profile&gt;
    &lt;/qos_library&gt;

    &lt;!-- PERSISTENCE SERVICE SECTION --&gt;
    &lt;persistence_service name="Srv1"&gt;
        &lt;!-- REMOTE ADMINISTRATION --&gt;
        &lt;administration&gt;
            &lt;domain_id&gt;72&lt;/domain_id&gt;
        &lt;/administration&gt;
        
        &lt;!-- PERSISTENT STORAGE SECTION --&gt;
        &lt;persistent_storage&gt;
            &lt;filesystem&gt;
                &lt;directory&gt;/tmp&lt;/directory&gt;
                &lt;file_prefix&gt;PS&lt;/file_prefix&gt;
            &lt;/filesystem&gt;
        &lt;/persistent_storage&gt;

        &lt;!-- DOMAIN PARTICIPANT SECTION --&gt;
        &lt;participant name="Part1"&gt;
            &lt;domain_id&gt;71&lt;/domain_id&gt;

            &lt;!-- PERSISTENCE GROUP SECTION --&gt;
            &lt;persistence_group name="PerGroup1" filter="*"&gt;
                &lt;single_publisher&gt;true&lt;/single_publisher&gt;
                &lt;single_subscriber&gt;true&lt;/single_subscriber&gt;
                &lt;datawriter_qos base_name="QosLib1::QosProfile1"/&gt;
                &lt;datareader_qos base_name="QosLib1::QosProfile1"/&gt;
           &lt;/persistence_group&gt;
        &lt;/participant&gt;
    &lt;/persistence_service&gt;
&lt;/dds&gt;</pre><p><br/>
</p>
<h2><a class="anchor" id="file_syntax"></a>
Configuration File Syntax</h2>
<p>The configuration file must follow these syntax rules: </p>
<ul>
<li>The syntax is XML and the character encoding is UTF-8. </li>
<li>Opening tags are enclosed in &lt;&gt;; closing tags are enclosed in &lt;/&gt;. </li>
<li>A value is a UTF-8 encoded string. Legal values are alphanumeric characters. All leading and trailing spaces are removed from the string before it is processed. For example, <pre class="fragment">" &lt;tag&gt; value &lt;/tag&gt;" </pre> is the same as <pre class="fragment">"&lt;tag&gt;value&lt;/tag&gt;" </pre> </li>
<li>All values are case-sensitive unless otherwise stated. </li>
<li>Comments are enclosed as follows: <pre class="fragment">&lt;!-- comment --&gt;. </pre> </li>
<li>The root tag of the configuration file must be <pre class="fragment">&lt;dds&gt; </pre> and end with <pre class="fragment">&lt;/dds&gt; </pre> </li>
<li>The primitive types support for tag values are specified in the following table.</li>
</ul>
<center> <table class="doxtable">
<caption align="bottom"><em>Supported Tag Values </em></caption>
<tr>
<th><b> Type </b>  </th><th><b> Format </b>  </th><th><b> Notes </b>   </th></tr>
<tr>
<td>DDS_Boolean  </td><td>yes, 1, true, BOOLEAN_TRUE, or DDS_BOOLEAN_TRUE: true;<br/>
 no, 0, false, BOOLEAN_FALSE, or DDS_BOOLEAN_FALSE: false  </td><td><p class="starttd">Not case-sensitive </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>DDS_Enum </td><td>A string </td><td><p class="starttd">Legal values are those listed in the online (HTML) documentation for the C or Java API </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>DDS_Long </td><td>-2147483648 to 2147483647<br/>
 or 0x80000000 to 0x7fffffff<br/>
 or LENGTH_UNLIMITED<br/>
 or DDS_LENGTH_UNLIMITED<br/>
  </td><td><p class="starttd">A 32-bit signed integer </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>DDS_UnsignedLong </td><td>0 - 4294967296; <br/>
 0 - 0xffffffff </td><td><p class="starttd">A 32-bit unsigned integer </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>String </td><td>UTF-8 character string </td><td>All leading and trailing spaces are ignored between two tags  </td></tr>
</table>
</center><p><b> XML Validation </b> <br/>
</p>
<p><b> Validation at Run-Time </b> <br/>
</p>
<p>RTI Persistence Service validates the input XML files using a builtin Document Type Definition (DTD). You can find a copy of the builtin DTD in &lt;NDDSHOME&gt;/resource/schema/rti_persistence_service.dtd. (This is only a copy of what the RTI Persistence Service core uses. Changing this file has no effect unless you specify its path with the DOCTYPE tag, described below.)</p>
<p>You can overwrite the builtin DTD by using the XML tag, &lt;!DOCTYPE&gt;. For example, the following indicates that RTI Persistence Service must use a different DTD file to perform validation: </p>
<pre class="fragment">   &lt;!DOCTYPE dds SYSTEM "/local/usr/rti/dds/modified_rtipersistenceservice.dtd"&gt;
</pre><p>If you do not specify the DOCTYPE tag in the XML file, the builtin DTD is used.</p>
<p>The DTD path can be absolute or relative to the current working directory of the application.</p>
<p><b> Validation During Editing </b> <br/>
</p>
<p>RTI Persistence Service provides DTD and XSD files that describe the format of the XML content. We recommend including a reference to one of these documents in the XML file that contains the persistence service configuration; this provides helpful features in code editors such as Visual Studio and Eclipse, including validation and auto-completion while you are editing the XML file. Including a reference to the XSD file in the XML documents provides stricter validation and better auto-completion than the corresponding DTD file.</p>
<p>The DTD and XSD definitions of the XML elements are in &lt;NDDSHOME&gt;/resource/schema/rti_persistence_service.dtd and &lt;NDDSHOME&gt;/resource/schema/rti_persistence_service.xsd, respectively.</p>
<p>To include a reference to the XSD document in your XML file, use the attribute xsi:noNamespaceSchemaLocation in the &lt;dds&gt; tag. For example (in the following, replace NDDSHOME with the RTI Connext installation directory):</p>
<pre class="fragment">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;dds xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:noNamespaceSchemaLocation= 
$(NDDSHOME)/resource/schema/rti_persistence_service.xsd"&gt;
   ...
&lt;/dds&gt;
</pre><p>The following sections provide details on the XML file syntax: </p>
<ul>
<li><a class="el" href="index.html#qos_configuration">QoS Configuration</a> </li>
<li><a class="el" href="index.html#configuration_application">Configuring the RTI Persistence Service Application</a> </li>
<li><a class="el" href="index.html#configuring_administration">Configuring Remote Administration</a> </li>
<li><a class="el" href="index.html#configuring_persistent_storage">Configuring the Persistent Storage</a> </li>
<li><a class="el" href="index.html#configuring_synchronization">Configuring Persistence Service Synchronization</a> </li>
<li><a class="el" href="index.html#configuring_participants">Configuring Participants</a> </li>
<li><a class="el" href="index.html#configuring_persistence_groups">Configuring Persistence Groups</a> </li>
<li><a class="el" href="index.html#durability_service_qos">DurabilityService QosPolicy</a></li>
</ul>
<h2><a class="anchor" id="qos_configuration"></a>
QoS Configuration</h2>
<p>Each persistence group and DomainParticipant will have a set of DDS QoSs. There are six tags: </p>
<ul>
<li>&lt;participant_qos&gt; </li>
<li>&lt;publisher_qos&gt; </li>
<li>&lt;subscriber_qos&gt; </li>
<li>&lt;topic_qos&gt; </li>
<li>&lt;datawriter_qos&gt; </li>
<li>&lt;datareader_qos&gt;</li>
</ul>
<p>Each QoS is identified by a name. The QoS can inherit its values from other QoSs or QoS Profiles described in the XML file. For example:</p>
<pre class="fragment">&lt;datawriter_qos name="DerivedWriterQos" base_name="QosLib::BaseWriterQos"&gt;
    &lt;history&gt;
        &lt;kind&gt;DDS_KEEP_ALL_HISTORY_QOS&lt;/kind&gt;
    &lt;/history&gt;
&lt;/datawriter_qos&gt;</pre><p>In the above example, the writer QoS named 'DerivedWriterQos' inherits the values from the writer QoS 'BaseWriterQos' contained in the library 'Lib'. The HistoryQosPolicy kind is set to DDS_KEEP_ALL_HISTORY_QOS.</p>
<p>Each XML tag with an associated name can be uniquely identified by its fully qualified name in C++ style.</p>
<p>See the chapter on Configuring QoS with XML in <b><a href="../../manuals/connext_dds/RTI_ConnextDDS_CoreLibraries_UsersManual.pdf" target="_blank">Core Libraries and Utilities User's Manual</a></b> for further information on XML QoS configuration.</p>
<p><br/>
</p>
<h2><a class="anchor" id="configuration_application"></a>
Configuring the RTI Persistence Service Application</h2>
<p>Each execution of the RTI Persistence Service application is configured using the content of a persistence service application tag (&lt;persistence_service&gt;). When RTI Persistence Service is started, you must specify which &lt;persistence_service&gt; tag to use for configuring the service.</p>
<p>For example:</p>
<pre class="fragment">&lt;dds&gt;
    &lt;persistence_service name="Srv1"&gt;
        ...
    &lt;/persistence_service&gt;
&lt;/dds&gt;</pre><p>Because a configuration file may contain multiple &lt;persistence_service&gt; tags, one file can be used to configure multiple RTI Persistence Service executions.</p>
<p>The following table lists the tags you can specify for a persistence service.</p>
<center> <table class="doxtable">
<caption align="bottom"><em>Persistence Service Application Tags</em></caption>
<tr>
<th><b>Tag</b> </th><th><b>Description</b> </th><th><p class="starttd"><b>Number of Tags Allowed</b> </p>
<p class="endtd"></p>
</th></tr>
<tr>
<td>&lt;annotation&gt; </td><td><p class="starttd">Provides a description for the persistence service configuration. Example:</p>
<pre class="fragment">&lt;annotation&gt;
    &lt;documentation&gt;
        Persists in the file system all topics published with PERSISTENT durability
    &lt;/documentation&gt;
&lt;/annotation&gt;
</pre>  </td><td><p class="starttd">0 or 1 </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;administration&gt; </td><td><p class="starttd">Enables and configure remote administration. See <a class="el" href="index.html#configuring_administration">Configuring Remote Administration</a>.</p>
<p class="endtd">Default: Administration is disabled.  </p>
</td><td><p class="starttd">0 or 1 </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;purge_samples_after_acknowledgment&gt; </td><td><p class="starttd">Indicates if persistence service must purge samples after they are acknowledged.</p>
<p>When RTI Persistence Service runs with this flag set to true, samples are removed from the PRSTDataWriters' queues as soon as they are acknowledged by all of the active/matching DataReaders and all the Durable Subscriptions.</p>
<p>When persistence service runs with this flag set to false, the persistence service will keep the samples in the PRSTDataWriters' queues even after being acknoweledged. Acknowledged samples will be purged from the PRSTDataWriters' queues only when the PRSTDataWriters needs these resources for new samples.</p>
<p class="endtd">Default: false  </p>
</td><td><p class="starttd">0 or 1 </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;persistent_storage&gt; </td><td><p class="starttd">When this tag is present, the topic data will be persisted to disk. You can select between file storage and relational database storage. See <a class="el" href="index.html#configuring_persistent_storage">Configuring the Persistent Storage</a>.</p>
<p class="endtd">Default: No persistent storage.  </p>
</td><td><p class="starttd">0 or 1 </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;participant&gt; </td><td>The participant tag describes a DomainParticipant created by the persistence service to monitor a domain ID.  </td><td><p class="starttd">1 or more </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;synchronization&gt; </td><td><p class="starttd">Enables synchronization in redundant persistence service instances. See <a class="el" href="index.html#configuring_synchronization">Configuring Persistence Service Synchronization</a>.</p>
<p class="endtd">Default: Synchronization is disabled.  </p>
</td><td><p class="starttd">1 or more </p>
<p class="endtd"></p>
</td></tr>
</table>
</center><h2><a class="anchor" id="configuring_administration"></a>
Configuring Remote Administration</h2>
<p>RTI Persistence Service can be controlled remotely by sending commands through a special DDS topic. Any DDS application can be implemented to send these commands and receive the corresponding responses. A shell application called rtipssh that sends/receives this command is provided with RTI Persistence Service.</p>
<p>The following remote commands are supported: </p>
<ul>
<li>
START </li>
<li>
STOP </li>
<li>
SHUTDOWN </li>
<li>
STATUS </li>
</ul>
<p>The &lt;administration&gt; tag is used to enable remote administration and configure its behavior.</p>
<p>The following table further describes the &lt;administration&gt; tags.</p>
<center> <table class="doxtable">
<caption align="bottom"><em>Administration Tags</em></caption>
<tr>
<th><b>Tag </b>  </th><th><b>Description</b>  </th><th><p class="starttd"><b>Number of Tags Allowed</b>  </p>
<p class="endtd"></p>
</th></tr>
<tr>
<td>&lt;domain_id&gt; </td><td>Specifies which domain ID RTI Persistence Service will use to enable remote administration  </td><td><p class="starttd">1 </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;participant_qos&gt; </td><td><p class="starttd">Configures the DomainParticipant QoS for remote administration.</p>
<p class="endtd">If the tag is not defined, RTI Persistence Service will use the RTI Connext defaults.  </p>
</td><td><p class="starttd">0 or 1 </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;publisher_qos&gt; </td><td><p class="starttd">Configures the Publisher QoS for remote administration.</p>
<p class="endtd">If the tag is not defined, RTI Persistence Service will use the RTI Connext defaults.  </p>
</td><td><p class="starttd">0 or 1 </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;subscriber_qos&gt; </td><td><p class="starttd">Configures the Subscriber QoS for remote administration.</p>
<p class="endtd">If the tag is not defined, RTI Persistence Service will use the RTI Connext defaults.  </p>
</td><td><p class="starttd">0 or 1 </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;datareader_qos&gt; </td><td><p class="starttd">Configures the DataReader QoS for remote administration.</p>
<p>If the tag is not defined, RTI Persistence Service will use the RTI Connext defaults with the following changes:</p>
<p class="endtd">reliability.kind = DDS_RELIABLE_RELIABILITY_QOS (this value cannot be changed)<br/>
 history.kind = DDS_KEEP_ALL_HISTORY_QOS<br/>
 resource_limits.max_samples = 32  </p>
</td><td><p class="starttd">0 or 1 </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;datawriter_qos&gt; </td><td><p class="starttd">Configures the DataWriter QoS for remote administration.</p>
<p>If the tag is not defined, RTI Persistence Service will use the RTI Connext defaults with the following changes:</p>
<p class="endtd">history.kind = DDS_KEEP_ALL_HISTORY_QOS<br/>
 resource_limits.max_samples = 32  </p>
</td><td><p class="starttd">0 or 1 </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;distributed_logger&gt; </td><td><p class="starttd">Configures RTI Distributed Logger.</p>
<p>For additional information on distributed logger see the <a href="../../manuals/connext_dds/RTI_ConnextDDS_CoreLibraries_UsersManual.pdf" target="_blank">Core Libraries and Utilities User's Manual</a>.</p>
<p class="endtd">Default: Without this tag distributed logger is disabled.  </p>
</td><td>0 or 1  </td></tr>
</table>
</center><p>For additional details on remote administration of RTI Persistence Service see please see the <b><a href="../../manuals/connext_dds/RTI_ConnextDDS_CoreLibraries_UsersManual.pdf" target="_blank">Core Libraries and Utilities User's Manual</a></b>.</p>
<h2><a class="anchor" id="configuring_persistent_storage"></a>
Configuring the Persistent Storage</h2>
<p>The &lt;persistent_storage&gt; tag is used to persist samples into permanent storage. If the &lt;persistence_storage&gt; tag is not specified, the service will operate in TRANSIENT mode and all the data will be kept in memory. Otherwise, the persistence service will operate in PERSISTENT mode and all the topic data will be stored in the file-system or in a relational database that provides an ODBC driver.</p>
<p>The following table further describes the &lt;persistent_storage&gt; tags.</p>
<center> <table class="doxtable">
<caption align="bottom"><em>Persistent Storage Tags</em></caption>
<tr>
<th><b>Tag </b>  </th><th><b>Description</b>  </th><th><p class="starttd"><b>Number of Tags Allowed</b>  </p>
<p class="endtd"></p>
</th></tr>
<tr>
<td>&lt;filesystem&gt; </td><td>When this tag is present, the topic data will be persisted into files. This tag is required if &lt;external_database&gt; is not specified  </td><td><p class="starttd">0 or 1  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;external_database&gt; </td><td>When this tag is present, the topic data will be persisted in a relational database. This tag is required if &lt;filesystem&gt; is not specified.  </td><td><p class="starttd">0 or 1  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;restore&gt; </td><td>Indicates if the topic data associated with a previous execution of the persistence service must be restored or not. If the topic data is not restored, it will be deleted from the database. <br/>
 Default: 1  </td><td>0 or 1   </td></tr>
<tr>
<td>&lt;type_object_max_ serialized_length&gt; </td><td><p class="starttd">Defines the length in bytes of the database column used to store the TypeObjects associated with PRSTDataWriters and PRSTDataReader.</p>
<p>For additional information on TypeObjects, see the .</p>
<p class="endtd">Default: 10488576  </p>
</td><td>0 or 1   </td></tr>
</table>
</center><p>The following table describes the &lt;filesystem&gt; tags.</p>
<center> <table class="doxtable">
<caption align="bottom"><em>Filesystem Tags</em></caption>
<tr>
<th><b>Tag </b>  </th><th><b>Description</b>  </th><th><p class="starttd"><b>Number of Tags Allowed</b>  </p>
<p class="endtd"></p>
</th></tr>
<tr>
<td>&lt;directory&gt; </td><td>Specifies the directory of the files in which topic data will be persisted. There will be one file per PRSTDataWriter/PRSTDataReader pair. <br/>
 Default: current working directory  </td><td><p class="starttd">0 or 1  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;file_prefix&gt; </td><td>A name prefix associated with all the files created by RTI Persistence Service. <br/>
 Default: PS  </td><td><p class="starttd">0 or 1  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;journal_mode&gt; </td><td>Sets the journal mode. This tag can take these values:<br/>
 <ul>
<li>
DELETE: Deletes the rollback journal at the conclusion of each transaction. </li>
<li>
TRUNCATE: Commits transactions by truncating the rollback journal to zero-length instead of deleting it. </li>
<li>
PERSIST: Prevents the rollback journal from being deleted at the end of each transaction. Instead, the header of the journal is overwritten with zeros. </li>
<li>
MEMORY: Stores the rollback journal in volatile RAM. This saves disk I/O, but at the expense of database safety and integrity. </li>
<li>
WAL: Uses a write-ahead log instead of a rollback journal to implement transactions. </li>
<li>
OFF: Disables the rollback journal completely. If the persistence service crashes in the middle of a transaction when the OFF journaling mode is set, then the files containing the samples will very likely be corrupted. </li>
</ul>
Default: DELETE  </td><td><p class="starttd">0 or 1  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;vacuum&gt; </td><td><p class="starttd">Sets the auto-vacuum status of the storage. This tag can take these values: </p>
<ul>
<li>
NONE: When data is deleted from the storage files, the files remain the same size. </li>
<li>
FULL: The storage files are compacted after every transaction. </li>
</ul>
<p class="endtd">Default: FULL  </p>
</td><td><p class="starttd">0 or 1  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;synchronization&gt; </td><td>Determines the level of synchronization with the physical disk. This tag can take three values:<br/>
 <ul>
<li>
FULL: Every sample is written into physical disk as RTI Persistence Service receives it. </li>
<li>
NORMAL: Samples are written into disk at critical moments. </li>
<li>
OFF: No synchronization is enforced. Data will be written to physical disk when the OS flushes its buffers. </li>
</ul>
Default: OFF  </td><td><p class="starttd">0 or 1  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;trace_file&gt; </td><td><p class="starttd">Specifies the name of a trace file for debugging purposes. The trace file contains information about all SQL statements executed by the persistence service</p>
<p class="endtd">Default: No trace file is generated  </p>
</td><td>0 or 1   </td></tr>
</table>
</center><p>The following table describes the &lt;external_database&gt; tags.</p>
<center> <table class="doxtable">
<caption align="bottom"><em>External Database Tags</em></caption>
<tr>
<th><b>Tag </b>  </th><th><b>Description</b>  </th><th><p class="starttd"><b>Number of Tags Allowed</b>  </p>
<p class="endtd"></p>
</th></tr>
<tr>
<td>&lt;dsn&gt; </td><td>DSN used to connect to the database using ODBC. You should create this DSN through the ODBC settings on Windows systems, or in your .odbc.ini file on UNIX/Linux systems. <br/>
 This tag is REQUIRED.  </td><td><p class="starttd">1  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;username&gt; </td><td>Username to connect to the database. <br/>
 Default: No username is used.  </td><td><p class="starttd">0 or 1  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;password&gt; </td><td>Password to connect to the database. <br/>
 Default: No password is used.  </td><td><p class="starttd">0 or 1  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;restore&gt; </td><td>Indicates if the topic data associated with a previous execution of the persistence service must be restored or not. If the topic data is not restored, it will be deleted from the database. <br/>
 Default: 1  </td><td><p class="starttd">0 or 1  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;odbc_library&gt;  </td><td>Specifies the ODBC driver to load. By default, RTI Connext will try to use the standard ODBC driver manager library (UnixOdbc on UNIX/Linux systems, the Windows ODBC driver manager on Windows systems).  </td><td><p class="starttd">0 or 1 </p>
<p class="endtd"></p>
</td></tr>
</table>
</center><h2><a class="anchor" id="configuring_synchronization"></a>
Configuring Persistence Service Synchronization</h2>
<p>By default, different Persistence Service instances do not synchronize with each other. For example, in a scenario with two Persistence Service instances, the first persistence service could receive a sample 'S1' from the original DataWriter that is not received by the second persistence service. If the disk where the first persistence service stores its samples fails, 'S1' will be lost. To enable synchronization between Persistence Servic instances, use the tag &lt;synchronization&gt; under &lt;persistence_service&gt;. When it comes to synchronization, there are two different kinds of information that can be synchronized independently:</p>
<ul>
<li>
Information about Durable Subscriptions and their states </li>
<li>
Data samples </li>
</ul>
<p>The following table describes the &lt;synchronization&gt; tags.</p>
<center> <table class="doxtable">
<caption align="bottom"><em>Synchronization Tags</em></caption>
<tr>
<th><b>Tag</b> </th><th><b>Description</b> </th><th><b>Number of Tags Allowed</b>  </th></tr>
<tr>
<td>&lt;synchronize_data&gt; </td><td><p class="starttd">Enables synchronization of data samples in redundant Persistence Service instances.</p>
<p>When set to 1, samples lost on the way to one service instance can be repaired by another without impacting the original publisher of that message.</p>
<p>To synchronize the instances, the tag &lt;synchronize_data&gt; must be set to 1 in every instance involved in the synchronization.</p>
<p>Note: This sample synchronization mechanism is not equivalent to database replication. The extent to which database instances have identical contents depends on the destination ordering and other QoS settings for the Persistence Service instances.</p>
<p class="endtd">Default: 0  </p>
</td><td><p class="starttd">0 or 1 </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;synchronize_durable_subscriptions&gt; </td><td><p class="starttd">Enables synchronization of Durable Subscriptions in redundant Persistence Service instances.</p>
<p>When set to 1, the different Persistence Service instances will synchronize their Durable Subscription information. This information includes the set of Durable Subscriptions as well as information about the Durable Subscription's state, such as the samples that have already been received by the Durable Subscriptions.</p>
<p class="endtd">Default: 0  </p>
</td><td><p class="starttd">0 or 1 </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;durable_ subscription_ synchronization_ period&gt; </td><td><p class="starttd">The period (in milliseconds) at which the information about Durable Subscriptions is synchronized.</p>
<p class="endtd">Default: 5000 milliseconds  </p>
</td><td>0 or 1  </td></tr>
</table>
</center><h2><a class="anchor" id="configuring_participants"></a>
Configuring Participants</h2>
<p>An XML &lt;persistence_service&gt; tag will contain a set of DomainParticipants. The persistence service will persist topics published in the domainIDs associated with these participants.</p>
<p>For example:</p>
<pre class="fragment">&lt;persistence_service name="Srv1"&gt;
    &lt;participant name="Part1"&gt;
        &lt;domain_id&gt;71&lt;/domain_id&gt;
       ...
    &lt;/participant&gt;
    &lt;participant name="Part2"&gt;
        &lt;domain_id&gt;72&lt;/domain_id&gt;
        ...
    &lt;/participant&gt;
&lt;/persistence_service&gt;</pre><p>In the previous example, the persistence service will create two domain participants on domains 71 and 72. After the domain participants are created, the persistence service will monitor the discovery traffic looking for topics to persist.</p>
<p>The &lt;domain_id&gt; tag can also be specified as an attribute of &lt;participant&gt;. For example:</p>
<pre class="fragment">&lt;persistence_service name="Srv1"&gt;
    &lt;participant name="Part1" domain_id="71"&gt;
        ...
    &lt;/participant&gt;
&lt;/persistence_service&gt;</pre><p>The following table describes the participant tags.</p>
<center> <table class="doxtable">
<caption align="bottom"><em>Participant Tags</em></caption>
<tr>
<th><b>Tag </b>  </th><th><b>Description</b>  </th><th><p class="starttd"><b>Number of Tags Allowed</b>  </p>
<p class="endtd"></p>
</th></tr>
<tr>
<td>&lt;domain_id&gt; </td><td>Domain ID associated with the Participant. The domain ID can be specified as an attribute of the participant tag. Default: 0 </td><td><p class="starttd">0 or 1 </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;participant_qos&gt; </td><td>Participant QoS. Default: DDS defaults. </td><td><p class="starttd">0 or 1 </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;persistence_group&gt; </td><td>A persistence group describes a set of topics whose data that must be persisted by the persistence service. </td><td><p class="starttd">1 or more </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;durable_subscriptions&gt; </td><td><p class="starttd">Configures a set of durable subscriptions for a given topic. This is a sequence of &lt;element&gt; tags, each of which has a &lt;name&gt;, a &lt;topic_name&gt;, and a &lt;quorum&gt;.</p>
<p>For additional information on durable subscriptions see the Persistence Service chapters in the <a href="../../manuals/connext_dds/RTI_ConnextDDS_CoreLibraries_UsersManual.pdf" target="_blank">Core Libraries and Utilities User's Manual</a>.</p>
<p>For example:</p>
<pre class="fragment">&lt;durable_subscriptions&gt; 
    &lt;element&gt;
        &lt;name&gt;DurSub1&lt;/name&gt; 
        &lt;topic_name&gt;Example MyType&lt;/topic_name&gt; 
        &lt;quorum&gt;2&lt;/quorum&gt;
    &lt;/element&gt; 
    &lt;element&gt;
        &lt;name&gt;DurSub2&lt;/name&gt;
        &lt;topic_name&gt;Example MyType&lt;/topic_name&gt; 
    &lt;/element&gt;
&lt;/durable_subscriptions&gt;
</pre>  </td><td><p class="starttd">0 or 1 </p>
<p class="endtd"></p>
</td></tr>
</table>
</center><h2><a class="anchor" id="configuring_persistence_groups"></a>
Configuring Persistence Groups</h2>
<p>The topics that must be persisted in a specific domain id are specified using &lt;persistence_group&gt; tags. A &lt;persistence_group&gt; tag defines a set of topics identified by a POSIX expression.</p>
<p>For example:</p>
<pre class="fragment">&lt;participant name="Part1"&gt;
    &lt;domain_id&gt;71&lt;/domain_id&gt;
    &lt;persistence_group name="PerGroup1" filter="H*"&gt;
       ...
    &lt;/persistence_group&gt;
&lt;/participant&gt;</pre><p>In the previous example, the persistence group 'PerGroup1' has associated all the topics published in the domain 71 whose name starts with 'H'.</p>
<p>When a persistence service discovers a topic 'A' that matches a specific persistence group, it creates a PRSTDataReader and PRSTDataWriter to persist that topic. The QoSs associated with these DataReaders and DataWriters, as well as the corresponding Publishers and Subscribers, can be configured inside the persistence group using QoS tags.</p>
<p>For example:</p>
<pre class="fragment">&lt;participant name="Part1"&gt;
    &lt;domain_id&gt;71&lt;/domain_id&gt;
    &lt;persistence_group name="PerGroup1" filter="*"&gt;
        ...
        &lt;publisher_qos base_qos_name="QosLib1::PubQos1"/&gt;
        &lt;subscriber_qos base_qos_name="QosLib1::SubQos1"/&gt;
        &lt;datawriter_qos base_qos_name="QosLib1::WriterQos1"/&gt;
        &lt;datareader_qos base_qos_name="QosLib1::ReaderQos1"/&gt;
       ...
    &lt;/persistence_group&gt;
&lt;/participant&gt;</pre><p>For instance, the number of samples saved by RTI Persistence Service is configurable through the HISTORY QosPolicy of the PRSTDataWriters. If a QoS tag is not specified the persistence service will use the corresponding RTI Connext default values.</p>
<p>A &lt;participant&gt; tag can contain multiple persistence groups; the set of topics that each one represents can intersect.</p>
<p>The following table further describes the persistence group tags.</p>
<center> <table class="doxtable">
<caption align="bottom"><em>Persistence Group Tags</em></caption>
<tr>
<th><b>Tag </b>  </th><th><b>Description</b>  </th><th><p class="starttd"><b>Number of Tags Allowed</b>  </p>
<p class="endtd"></p>
</th></tr>
<tr>
<td>&lt;allow_durable_ subscriptions&gt; </td><td><p class="starttd">Enables support for durable subscriptions in the PRSTDataWriters created in a persistence group.</p>
<p>When Durable Subscriptions are not required, setting this property to 0 will increase performance.</p>
<p class="endtd">Default: 1  </p>
</td><td><p class="starttd">0 or 1 </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;filter&gt; </td><td>A list of POSIX expressions separated by commas that describe the set of topics allowed in the persistence group. The filter can be specified as an attribute of persistence_group as well. Default: * </td><td><p class="starttd">0 or 1 </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;deny_filter&gt; </td><td>A list of POSIX expressions separated by commas that describe the set of topics denied in the persistence group. This "black" list is applied after 'filter'. Default: empty </td><td><p class="starttd">0 or 1 </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;content_filter&gt; </td><td>Content filter topic expression. A persistence group can subscribe to a specific set of data based on the value of this expression. A filter expression is similar to the WHERE clause in SQL. For more information on the syntax, please see the online documentation (From the Modules page, select DDS API Reference, Queries and Filters Syntax.) Default: no expression  </td><td><p class="starttd">0 or 1 </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;single_publisher&gt; </td><td>Indicates if the persistence service should create one Publisher per persistence group or one Publisher per PRSTDataWriter inside the persistence group. <br/>
 Default: 1 </td><td><p class="starttd">0 or 1 </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;single_subscriber&gt; </td><td>Indicates if the persistence service should create one Subscriber per persistence group or one Subscriber per PRSTDataReader in the persistence group. <br/>
 Default: 1  </td><td><p class="starttd">0 or 1 </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;use_durability_service&gt; </td><td>Indicates if the HISTORY and RESOURCE_LIMITS QosPolicies of the PRSTDataWriters and PRSTDataReaders should be configured based on the DURABILITY_SERVICE value of the discovered DataWriters. <br/>
 Default: 0  </td><td><p class="starttd">0 or 1 </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;share_database_connection&gt; </td><td><p class="starttd">A boolean that indicates if the persistence service will create an independent database connection per PRSTDataWriter in the group (0) or per Publisher (1) in the group. <br/>
</p>
<p>When &lt;single_publisher&gt; is 0 and &lt;share_database_connection&gt; is 1, there is a single database connection per group. All the PRSTDataWriters will share the same connection.</p>
<p>When &lt;single_publisher&gt; is 1 or &lt;share_database_connection&gt; is 0, there is a database connection per PRSTDataWriter.</p>
<p>This parameter is only applicable to configurations persisting the data into a relational database using the tag &lt;external_database&gt; in &lt;persistent_storage&gt;.</p>
<p class="endtd">Default: 0  </p>
</td><td><p class="starttd">0 or 1  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;reader_checkpoint_frequency&gt; </td><td><p class="starttd">This property controls how often (expressed in number of samples) the PRSTDataReader state is stored in the database. The PRSTDataReaders are the DDS DataReaders created by the persistence service.</p>
<p>A high frequency will provide better performance. However, if the persistence service is restarted, it may receive some duplicate samples. The persistence service will send these duplicates samples on the wire but they will be filtered by the DDS DataReaders and they will not be propagated to the application.</p>
<p>This property is only applicable when the persistence service operates in persistent mode (the &lt;database_connection&gt; tag is present).</p>
<p class="endtd">Default: 1  </p>
</td><td><p class="starttd">0 or 1 </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;writer_in_memory_state&gt; </td><td><p class="starttd">This property determines how much state will be kept in memory by the PRSTDataWriters in order to avoid accessing the database.</p>
<p>The property is only applicable when the persistence service operates in persistent mode (the &lt;database_connection&gt; tag is present).</p>
<p>When writer_in_memory_state is true, the PRSTDataWriters will keep a copy of the meta-data about all the instances in memory. They will also keep a fixed state overhead of 24 bytes per sample. However, user data samples will always be stored in the database, not in memory. This mode provides the best performance. However, the restore operation will be slower and the maximum number of samples that a PRSTDataWriter can manage will be limited by the available physical memory.</p>
<p>If in_memory_state is false, all the state will be kept in the underlying database. In this mode, the maximum number of samples that a PRSTDataWriter can manage will not be limited by the available physical memory unless the underlying database is an in-memory database (TimesTen).</p>
<p class="endtd">Default: For KEEP_LAST or ResourceLimitsQosPolicy.max_samples != DS_UNLIMITED_LENGTH, the default is true. Otherwise, the default is false.  </p>
</td><td><p class="starttd">0 or 1 </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;memory_management&gt; </td><td><p class="starttd">This tag configures the memory allocation policy for samples in the PRSTDataReaders and PRSTDataWriters.</p>
<p class="endtd">See <a class="el" href="index.html#memory_management">Memory Management</a>  </p>
</td><td><p class="starttd">0 or 1 </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;propagate_dispose&gt; </td><td>Specifies whether or not the persistence service should propagate the dispose messages it receives from data writers to the data readers.<br/>
 Default: 1  </td><td><p class="starttd">0 or 1  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;propagate_source_timestamp&gt; </td><td>Controls whether or not the persistence service propagates the source timestamp of the received samples. Default: false  </td><td><p class="starttd">0 or 1  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;propagate_unregister&gt; </td><td>Specifies whether or not the persistence service should propagate the unregister messages it receives from data writers to the data readers.<br/>
 Default: 0  </td><td><p class="starttd">0 or 1  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;topic_qos&gt; </td><td>Topic QoS. Default: DDS defaults </td><td><p class="starttd">0 or 1  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;publisher_qos&gt; </td><td>Publisher QoS. Default: DDS defaults </td><td><p class="starttd">0 or 1  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;subscriber_qos&gt; </td><td>Subscriber QoS. Default: DDS defaults </td><td><p class="starttd">0 or 1  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;datawriter_qos&gt; </td><td>PRSTDataWriter QoS. Default: DDS defaults. Note: These fields cannot be set and are assigned automatically: protocol.virtual_guid, protocol.rtps_object_id, durability.kind. </td><td><p class="starttd">0 or 1  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;datareader_qos&gt; </td><td>PRSTDataReader QoS. Default: DDS defaults. Note: These fields cannot be set and are assigned automatically: protocol.virtual_guid, protocol.rtps_object_id, durability.kind. </td><td><p class="starttd">0 or 1  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;writer_checkpoint_period&gt; </td><td><p class="starttd">Controls how often (expressed in milliseconds) transactions are committed for a PRSTDataWriter.</p>
<p>A value of 0 indicates that transactions will be committed immediately. This is the recommended setting to avoid losing data in the case of an unex- pected error in Persistence Service and/or the underlying hardware/software infrastructure.</p>
<p>For applications that can tolerate some data losses, setting this tag to a value greater than 0 will increase performance.</p>
<p class="endtd">Default: 0  </p>
</td><td><p class="starttd">0 or 1  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;writer_checkpoint_volume&gt; </td><td><p class="starttd">Controls how often (expressed as a number of samples) transactions are committed for a PRSTDataWriter.</p>
<p>A value of 1 indicates that samples will be persisted by the PRSTDataWrit- ers immediately. This is the recommended setting to avoid losing data in the case of an unexpected error in persistence service and/or the underlying hardware/software infrastructure.</p>
<p>For application that can tolerate some data losses, setting this tag to a value greater than 1 will increase performance.</p>
<p class="endtd">Default: 1  </p>
</td><td><p class="starttd">0 or 1  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;writer_ack_period&gt; </td><td>Controls how often (expressed in milliseconds) samples are marked as ACK'd in the database by the PRSTDataWriter. Default: 0  </td><td><p class="starttd">0 or 1  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;late_joiner_read_batch&gt; </td><td><p class="starttd">Defines how many samples will be pre-fetched by a PRSTDataWriter to satisfy requests from late-joiners.</p>
<p>When a DataReader requests samples from a PRSTDataWriter by sending a NACK message, the PRSTDataWriter may retrieve additional samples from the database to minimize disk access. This paramater determines that amount of samples that will be retrieved preemptively from the database by the PRSTDataWriter.</p>
<p class="endtd">Default: 20000  </p>
</td><td><p class="starttd">0 or 1  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;sample_logging&gt; </td><td><p class="starttd">This tag can be used to enable and configure a sample log for the PRSTDataWriters in a persistence group. A sample log is a buffer of samples on disk that, when used in combination with delegate reliability, allow decoupling the original DataWriters from slow DataReaders.</p>
<p>See <a class="el" href="index.html#configuring_sample_logging">Sample Logging</a></p>
<p class="endtd">Default: Sample log is disabled.  </p>
</td><td><p class="starttd">0 or 1 </p>
<p class="endtd"></p>
</td></tr>
</table>
</center><h2><a class="anchor" id="configuring_sample_logging"></a>
Sample Logging</h2>
<p>Persistence Service can be configured to enable sample logging per persistence group using the &lt;sample_logging&gt; XML tag to specify the log's configuration parameters.</p>
<p>For additional information on sample logging see the persistence service chapters in the <a href="../../manuals/connext_dds/RTI_ConnextDDS_CoreLibraries_UsersManual.pdf" target="_blank">Core Libraries and Utilities User's Manual</a>.</p>
<center> <table class="doxtable">
<caption align="bottom"><em>Sample Logging Tags</em></caption>
<tr>
<th><b>Tag</b> </th><th><b>Description</b> </th><th><p class="starttd"><b>Number of Tags Allowed</b> </p>
<p class="endtd"></p>
</th></tr>
<tr>
<td>&lt;enable&gt; </td><td><p class="starttd">Indicates whether or not sample logging is enabled in the container persistence group.</p>
<p class="endtd">Default: 0  </p>
</td><td><p class="starttd">0 or 1 </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;log_file_size&gt; </td><td><p class="starttd">Specifies the maximum size of a sample log file in Mbytes. When a log file becomes full, Persistence Service creates a new log file.</p>
<p class="endtd">Default: 60 MB  </p>
</td><td><p class="starttd">0 or 1 </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;log_flush_period&gt; </td><td><p class="starttd">The period (in milliseconds) at which Persistence Service removes sample log files whose full content have been written into the PRSTDataWriter by the sample log write thread.</p>
<p class="endtd">Default: 10000 milliseconds  </p>
</td><td><p class="starttd">0 or 1 </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;log_read_batch&gt; </td><td><p class="starttd">Determines how many samples should be read and processed at once by the sample log write thread.</p>
<p class="endtd">Default: 100 samples  </p>
</td><td><p class="starttd">0 or 1 </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;log_bookmark_period&gt; </td><td><p class="starttd">Samples in the sample log are identified by two attributes:</p>
<ul>
<li>
The file ID </li>
<li>
The row ID (position within the file) The read bookmark indicates the most recently processed sample. </li>
</ul>
<p>This tag indicates how often (in milliseconds) the read bookmark is persisted into disk.</p>
<p class="endtd">Default: 1000 milliseconds  </p>
</td><td><p class="starttd">0 or 1 </p>
<p class="endtd"></p>
</td></tr>
</table>
</center><h2><a class="anchor" id="durability_service_qos"></a>
DurabilityService QosPolicy</h2>
<p>The DURABILITY_SERVICE QosPolicy associated with a DataWriter is used to configure the HISTORY and the RESOURCE_LIMITS associated with the PRSTDataReaders and PRSTDataWriters.</p>
<p>By default, the HISTORY and RESOURCE_LIMITS of a PRSTDataReader and PRSTDataWriter with topic 'A' will be configured using the values specified in the XML file used to configure RTI Persistence Service. To overwrite those values and use the DURABILITY_SERVICE value of the first discovered DataWriter publishing 'A', you can use the tag &lt;use_durability_service&gt; in the persistence group definition:</p>
<pre class="fragment">&lt;participant name="Part1"&gt;
    &lt;domain_id&gt;71&lt;/domain_id&gt;
    &lt;persistence_group name="PerGroup1" filter="*"&gt;
        ...
        &lt;use_durability_service/&gt;1&lt;/ use_durability_service&gt;
        ...
    &lt;/persistence_group&gt;
&lt;/participant&gt;</pre><h2><a class="anchor" id="memory_management"></a>
Memory Management</h2>
<p>The samples received and stored by the PRSTDataReaders and PRSTDataWriters are in serialized form.</p>
<p>The serialized size of a sample is the number of bytes that requires on the wire. The maximum serialized size of a sample is the number of bytes that the largest sample for a given type requires on the wire.</p>
<p>By default, The PRSTDataReaders and PRSTDataWriters created by the persistence service try to allocate multiple samples to their maximum serialized size. This may cause memory allocation issues when the maximum serialized size is significantly large.</p>
<p>For PRSTDataReaders, the number of samples in the DataReaders queues can be controlled using the QoS values resource_qos.resource_limits.max_samples and resource_qos.resource_limits.initial_samples.</p>
<p>The PRSTDataWriters keep a cache of samples so that they do not have to access the database every time. The minimum size of this cache is 32 samples.</p>
<p>In addition, each PRSTDataWriter keeps an additional sample called DB sample that is used to move information from the DataWriter cache to the database and viceversa.</p>
<p>The &lt;memory_management&gt; tag in a persistence group can be used to control the memory allocation policy for the samples created by PRStDataReaders and PRSTDataWriters in the persistence group.</p>
<p>The following table further describes the memory management tags:</p>
<center> <table class="doxtable">
<caption align="bottom"><em>Memory Management Tags</em></caption>
<tr>
<th><b>Tag </b>  </th><th><b>Description</b>  </th><th><p class="starttd"><b>Number of Tags Allowed</b>  </p>
<p class="endtd"></p>
</th></tr>
<tr>
<td>&lt;pool_sample_buffer_max_size&gt; </td><td><p class="starttd">This tag applies to both, PRSTDataReader and PRSTDataWriters. Its value determines the maximum size (in bytes) of the buffers that will be preallocated to store the samples. If the space required for a new sample is greater than this size, persistence service will allocate the memory dynamically to the exact size required by the sample.</p>
<p>This parameter is used to control the memory allocated for the samples in the PRSTDataReader queues and the PRSTDataWriter caches.</p>
<p>The size of the DB sample in the PRSTDataWriters is controlled by the value of the tag &lt;persistent_sample_buffer_max_size&gt;.</p>
<p class="endtd">Default: LENGTH_UNLIMITED (samples are allocated to the maximum size)  </p>
</td><td><p class="starttd">0 or 1 </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>&lt;persistent_sample_buffer_max_size&gt; </td><td><p class="starttd">This tag is used to control the memory associated with the DB sample in a PRSTDataWriter. The persistence service will not be able to store a sample into persistent storage if the serialized size is greater than this value. Therefore, this parameter must be used carefully.</p>
<p class="endtd">Default: LENGTH_UNLIMITED (DB sample is allocated to the maximum size)  </p>
</td><td>0 or 1  </td></tr>
</table>
</center><h1><a class="anchor" id="persistence_library"></a>
Using the RTI Persistence Service library</h1>
<p>Persistence can be deployed as a C library linked into your application in selected architectures.</p>
<p>Refer to the <b><a href="../../manuals/persistence_service/RTI_Persistence_Service_ReleaseNotes.pdf" target="_blank">RTI Persistence Service Release Notes</a></b> for the list of supported architectures.</p>
<p>You can configure, start and stop the service using the API described here:</p>
<ul>
<li><a class="el" href="group__RTI__PersistenceServiceLibModule.html">RTI Persistence Service API</a> </li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<HR>
<IMG SRC="rti_logo.gif" height="16">
<A HREF="main.html">RTI Persistence Service Version 5.2.3</A>
Copyright &copy; Wed Apr 27 2016 
<A HREF="http://www.rti.com">Real-Time Innovations, Inc</A>
</BODY>
</HTML>
